## [550.æ¸¸æˆç©æ³•åˆ†æ IV ä¸­æ–‡çƒ­é—¨é¢˜è§£2](https://leetcode.cn/problems/game-play-analysis-iv/solutions/100000/by-zg104-uqvw)

ä½œè€…ï¼š[zg104](https://leetcode.cn/u/zg104)

##### æ€è·¯

>  è®¡ç®—ä»é¦–æ¬¡ç™»å½•æ—¥æœŸå¼€å§‹è‡³å°‘è¿ç»­ä¸¤å¤©ç™»å½•çš„ç©å®¶çš„æ•°é‡ï¼Œç„¶åé™¤ä»¥ç©å®¶æ€»æ•°ã€‚

è¿™æ˜æ˜¾æ˜¯ä¸€ä¸ªæŒ‡æ ‡è®¡ç®—çš„é¢˜ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦æ³¨æ„ ifnull å’Œ distinctï¼Œå…¶æ¬¡ï¼Œæˆ‘ä»¬è¦å¤„ç†ä»**é¦–æ¬¡ç™»å½•æ—¥æœŸå¼€å§‹è‡³å°‘è¿ç»­ä¸¤å¤©**ï¼Œé‚£ä¹ˆç­‰ä»·äº`event_date`å¿…é¡»å«æœ‰`é¦–æ¬¡ç™»é™†æ—¥æœŸ+1`ï¼Œè‡³äºå…¶ä»–çš„æˆ‘ä»¬ä¸åœ¨ä¹ï¼Œå› ä¸ºæ»¡è¶³è¿™ä¸€æ¡ä»¶å³å¯è¯´æ˜è‡ªé¦–æ¬¡ç™»é™†è¿ç»­ä¸¤å¤©ç™»é™†äº†ï¼ˆå¦‚æœä¸‰å¤©åŠä»¥ä¸Šè¿ç»­ï¼Œé‚£ä¹ˆä¹Ÿå¿…é¡»æ»¡è¶³ç¬¬äºŒæ—¥åœ¨event_dateä¸­ï¼‰ã€‚

##### ç®—æ³•

1. æ‰¾åˆ°æ¯ä¸ªäººçš„é¦–æ¬¡ç™»é™†çš„ç¬¬äºŒå¤©

```sql
select player_id, date(min(event_date) + 1)
from activity
group by player_id

# è¾“å‡º
{"headers": ["player_id", "date(min(event_date) + 1)"], 
"values": [[1, "2016-03-02"], 
           [2, "2017-06-26"], 
           [3, "2016-03-03"]]}
```

2. åœ¨`Activity`è¡¨ä¸­æŠŠevent_dateå’Œä¸Šé¢çš„è¿›è¡ŒåŒ¹é…ï¼Œå¯ä»¥æ‰¾å‡ºå“ªäº›player_idçš„event_dateé‡Œé¢å«æœ‰ã€ç¬¬äºŒå¤©ç™»å½•çš„æ—¶é—´ã€‘

```sql
select 
	distinct player_id
from activity 
where (player_id, event_date) in
(
    select player_id, date(min(event_date) + 1)
    from activity
    group by player_id

)
```

3. è®¡ç®—æŒ‡æ ‡

ä¸»è¦ ifnullã€roundã€countçš„ä½¿ç”¨

##### ç­”æ¡ˆ

```sql
select 
	ifnull(
	round(
        count(distinct player_id)/ 
    	(select count(distinct player_id) from activity)
    ,2)
    ,0) as fraction
from activity 
where (player_id, event_date) in
(
    select player_id, date(min(event_date) + 1)
    from activity
    group by player_id

)
```


ğŸ¥°è§‰å¾—è¿˜ä¸é”™çš„è¯ï¼Œç‚¹ä¸ªèµï¼ŒåŠ ä¸ªå…³æ³¨å§~ğŸ¥°
