## [1802.æœ‰ç•Œæ•°ç»„ä¸­æŒ‡å®šä¸‹æ ‡å¤„çš„æœ€å¤§å€¼ ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/maximum-value-at-a-given-index-in-a-bounded-array/solutions/100000/by-lcbin-4vp4)

ä½œè€…ï¼š[lcbin](https://leetcode.cn/u/lcbin)



**æ–¹æ³•ä¸€ï¼šäºŒåˆ†æŸ¥æ‰¾**

æ ¹æ®é¢˜ç›®æè¿°ï¼Œå¦‚æœæˆ‘ä»¬ç¡®å®šäº† $nums[index]$ çš„å€¼ä¸º $x$ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„æ•°ç»„æ€»å’Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ $index$ å·¦ä¾§çš„æ•°ç»„å…ƒç´ ä» $x-1$ æ¯æ¬¡é€’å‡ $1$ï¼Œå¦‚æœå‡åˆ° $1$ åè¿˜æœ‰å‰©ä½™å…ƒç´ ï¼Œé‚£ä¹ˆå‰©ä½™çš„å…ƒç´ éƒ½ä¸º $1$ï¼›åŒæ ·çš„ï¼Œåœ¨ $index$ åŠå³ä¾§çš„æ•°ç»„å…ƒç´ ä» $x$ ä¹Ÿæ˜¯æ¯æ¬¡é€’å‡ $1$ï¼Œå¦‚æœå‡åˆ° $1$ åè¿˜æœ‰å‰©ä½™å…ƒç´ ï¼Œé‚£ä¹ˆå‰©ä½™çš„å…ƒç´ ä¹Ÿéƒ½ä¸º $1$ã€‚

è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºæ•°ç»„çš„æ€»å’Œï¼Œå¦‚æœæ€»å’Œå°äºç­‰äº $maxSum$ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„ $x$ æ˜¯åˆæ³•çš„ã€‚éšç€ $x$ çš„å¢å¤§ï¼Œæ•°ç»„çš„æ€»å’Œä¹Ÿä¼šå¢å¤§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å¤§çš„ä¸”ç¬¦åˆæ¡ä»¶çš„ $x$ã€‚

ä¸ºäº†æ–¹ä¾¿è®¡ç®—æ•°ç»„å·¦ä¾§ã€å³ä¾§çš„å…ƒç´ ä¹‹å’Œï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•° $sum(x, cnt)$ï¼Œè¡¨ç¤ºä¸€å…±æœ‰ $cnt$ ä¸ªå…ƒç´ ï¼Œä¸”æœ€å¤§å€¼ä¸º $x$ çš„æ•°ç»„çš„æ€»å’Œã€‚å‡½æ•° $sum(x, cnt)$ å¯ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š

-   å¦‚æœ $x \geq cnt$ï¼Œé‚£ä¹ˆæ•°ç»„çš„æ€»å’Œä¸º $\frac{(x + x - cnt + 1) \times cnt}{2}$
-   å¦‚æœ $x \lt cnt$ï¼Œé‚£ä¹ˆæ•°ç»„çš„æ€»å’Œä¸º $\frac{(x + 1) \times x}{2} + cnt - x$

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äºŒåˆ†çš„å·¦è¾¹ç•Œ $left = 1$ï¼Œå³è¾¹ç•Œ $right = maxSum$ï¼Œç„¶åäºŒåˆ†æŸ¥æ‰¾ $nums[index]$ çš„å€¼ $mid$ï¼Œå¦‚æœ $sum(mid - 1, index) + sum(mid, n - index) \leq maxSum$ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„ $mid$ æ˜¯åˆæ³•çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°† $left$ æ›´æ–°ä¸º $mid$ï¼Œå¦åˆ™æˆ‘ä»¬å°† $right$ æ›´æ–°ä¸º $mid - 1$ã€‚

æœ€åå°† $left$ ä½œä¸ºç­”æ¡ˆè¿”å›å³å¯ã€‚

```python [sol1-Python3]
class Solution:
    def maxValue(self, n: int, index: int, maxSum: int) -> int:
        def sum(x, cnt):
            return (x + x - cnt + 1) * cnt // 2 if x >= cnt else (x + 1) * x // 2 + cnt - x

        left, right = 1, maxSum
        while left < right:
            mid = (left + right + 1) >> 1
            if sum(mid - 1, index) + sum(mid, n - index) <= maxSum:
                left = mid
            else:
                right = mid - 1
        return left
```



```java [sol1-Java]
class Solution {
    public int maxValue(int n, int index, int maxSum) {
        int left = 1, right = maxSum;
        while (left < right) {
            int mid = (left + right + 1) >>> 1;
            if (sum(mid - 1, index) + sum(mid, n - index) <= maxSum) {
                left = mid;
            } else {
                right = mid - 1;
            }
        }
        return left;
    }

    private long sum(long x, int cnt) {
        return x >= cnt ? (x + x - cnt + 1) * cnt / 2 : (x + 1) * x / 2 + cnt - x;
    }
}
```



```cpp [sol1-C++]
class Solution {
public:
    int maxValue(int n, int index, int maxSum) {
        auto sum = [](long x, int cnt) {
            return x >= cnt ? (x + x - cnt + 1) * cnt / 2 : (x + 1) * x / 2 + cnt - x;
        };
        int left = 1, right = maxSum;
        while (left < right) {
            int mid = (left + right + 1) >> 1;
            if (sum(mid - 1, index) + sum(mid, n - index) <= maxSum) {
                left = mid;
            } else {
                right = mid - 1;
            }
        }
        return left;
    }
};
```


```go [sol1-Go]
func maxValue(n int, index int, maxSum int) int {
	sum := func(x, cnt int) int {
		if x >= cnt {
			return (x + x - cnt + 1) * cnt / 2
		}
		return (x+1)*x/2 + cnt - x
	}
	return sort.Search(maxSum, func(x int) bool {
		x++
		return sum(x-1, index)+sum(x, n-index) > maxSum
	})
}
```

æ—¶é—´å¤æ‚åº¦ $O(\log M)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(1)$ã€‚å…¶ä¸­ $M=maxSum$ã€‚

---

æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµï¼Œæ¬¢è¿è¯„è®ºåŒºæä¾›å…¶å®ƒè§£é¢˜æ€è·¯ï¼ˆä»£ç ï¼‰ï¼Œä¹Ÿå¯ä»¥ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ä½œè€…å“ˆğŸ˜„~