## [466.ç»Ÿè®¡é‡å¤ä¸ªæ•° ä¸­æ–‡å®˜æ–¹é¢˜è§£](https://leetcode.cn/problems/count-the-repetitions/solutions/100000/tong-ji-zhong-fu-ge-shu-by-leetcode-solution)
### ğŸ“º è§†é¢‘é¢˜è§£

![...66.ç»Ÿè®¡é‡å¤ä¸ªæ•°.mp4](9aa26c7b-c83a-4a44-826e-f1d2d002e35f)

### ğŸ“– æ–‡å­—é¢˜è§£
#### æ–¹æ³•ä¸€ï¼šæ‰¾å‡ºå¾ªç¯èŠ‚

**æ€è·¯**

ç”±äºé¢˜ç›®ä¸­çš„ `n1` å’Œ `n2` éƒ½å¾ˆå¤§ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•çœŸæ­£æŠŠ `S1 = [s1, n1]` å’Œ `S2 = [s2, n2]` éƒ½æ˜¾å¼åœ°è¡¨ç¤ºå‡ºæ¥ã€‚ç”±äºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä¸æ–­å¾ªç¯çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‰¾å‡º `S2` åœ¨ `S1` ä¸­å‡ºç°çš„å¾ªç¯èŠ‚ï¼Œå¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº†å¾ªç¯èŠ‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾ˆå¿«ç®—å‡º `S2` åœ¨ `S1` ä¸­å‡ºç°äº†å¤šå°‘æ¬¡äº†ã€‚

æœ‰äº›è¯»è€…å¯èƒ½å¯¹å¾ªç¯èŠ‚è¿™ä¸ªæ¦‚å¿µä¼šæœ‰äº›é™Œç”Ÿï¼Œè¿™ä¸ªæ¦‚å¿µæˆ‘ä»¬å¯ä»¥ç±»æ¯”æ— é™å¾ªç¯å°æ•°ï¼Œå¦‚æœä»å°æ•°éƒ¨åˆ†çš„æŸä¸€ä½èµ·å‘å³è¿›è¡Œåˆ°æŸä¸€ä½æ­¢çš„ä¸€èŠ‚æ•°å­—ã€Œå¾ªç¯ã€å‡ºç°ï¼Œé¦–å°¾è¡”æ¥ï¼Œç§°è¿™ç§å°æ•°ä¸ºã€Œæ— é™å¾ªç¯å°æ•°ã€ï¼Œè¿™ä¸€èŠ‚æ•°å­—ç§°ä¸ºã€Œæ— é™å¾ªç¯å°æ•°ã€ã€‚æ¯”å¦‚å¯¹äº `3.56789789789...` è¿™ä¸ªæ— é™å¾ªç¯å°æ•°ï¼Œå®ƒçš„å°æ•°éƒ¨åˆ†å°±æ˜¯ä»¥ `789` ä¸ºä¸€ä¸ªã€Œå¾ªç¯èŠ‚ã€åœ¨æ— é™å¾ªç¯ï¼Œä¸”å¼€å¤´å¯èƒ½ä¼šæœ‰éƒ¨åˆ†ä¸å¾ªç¯çš„éƒ¨åˆ†ï¼Œè¿™ä¸ªæ•°å­—ä¸­å³ä¸º `56`ã€‚

é‚£ä¹ˆå›åˆ°è¿™é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸æ–­å¾ªç¯çš„ `s2` ç»„æˆçš„å­—ç¬¦ä¸²ç±»æ¯”ä½œä¸Šé¢å°æ•°éƒ¨åˆ†ï¼Œå»æ‰¾æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå­ä¸²ï¼Œå³ã€Œå¾ªç¯èŠ‚ã€ï¼Œæ»¡è¶³ä¸æ–­åœ¨ `S2` ä¸­å¾ªç¯ï¼Œä¸”è¿™ä¸ªå¾ªç¯èŠ‚èƒ½å¯¹åº”å›ºå®šæ•°é‡çš„ `s1` ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ç¬¬ä¸€æ¬¡å‡ºç°åï¼Œ`S2` çš„å­ä¸² `bdadc` æ„æˆä¸€ä¸ªå¾ªç¯èŠ‚ï¼šä¹‹å `bdadc` çš„æ¯æ¬¡å‡ºç°éƒ½éœ€è¦æœ‰ç›¸åº”çš„ä¸¤æ®µ `s1`ã€‚

![fig1](https://assets.leetcode-cn.com/solution-static/466_fig1.png)


å½“æˆ‘ä»¬æ‰¾å‡ºå¾ªç¯èŠ‚åï¼Œæˆ‘ä»¬å³å¯çŸ¥é“ä¸€ä¸ªå¾ªç¯èŠ‚å†…åŒ…å« `s1` çš„æ•°é‡ï¼Œä»¥åŠåœ¨å¾ªç¯èŠ‚å‡ºç°å‰çš„ `s1` çš„æ•°é‡ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ $O(1)$ çš„æ—¶é—´å†…ï¼Œé€šè¿‡ç®€å•çš„è¿ç®—æ±‚å‡º `s2` åœ¨ `S1` ä¸­å‡ºç°çš„æ¬¡æ•°äº†ã€‚å½“ç„¶ï¼Œç”±äº `S1` ä¸­ `s1` çš„æ•°é‡ `n1` æ˜¯æœ‰é™çš„ï¼Œå› æ­¤å¯èƒ½ä¼šå­˜åœ¨å¾ªç¯èŠ‚æœ€åä¸€ä¸ªéƒ¨åˆ†æ²¡æœ‰å®Œå…¨åŒ¹é…ï¼Œå¦‚ä¸Šå›¾æœ€åä¼šå•ç‹¬å‰©ä¸€ä¸ª `s1` å‡ºæ¥æ— æ³•å®Œå…¨åŒ¹é…å®Œå¾ªç¯èŠ‚ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬éœ€è¦å•ç‹¬æ‹¿å‡ºæ¥éå†å¤„ç†ç»Ÿè®¡ã€‚

æœ‰äº›è¯»è€…å¯èƒ½ä¼šæ€€ç–‘å¾ªç¯èŠ‚æ˜¯å¦ä¸€å®šå­˜åœ¨ï¼Œè¿™é‡Œæˆ‘ä»¬ç»™å‡ºçš„ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ ¹æ®[é¸½ç¬¼åŸç†](https://baike.baidu.com/item/é¸½ç¬¼)ï¼Œæˆ‘ä»¬æœ€å¤šåªè¦æ‰¾è¿‡ `|s2| + 1` ä¸ª `s1`ï¼Œå°±ä¸€å®šä¼šå‡ºç°å¾ªç¯èŠ‚ã€‚

**ç®—æ³•**

æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå“ˆå¸Œè¡¨ `recall` ï¼šå“ˆå¸Œè¡¨ `recall` ä»¥ `s2` å­—ç¬¦ä¸²çš„ä¸‹æ ‡ `index` ä¸ºç´¢å¼•ï¼Œå­˜å‚¨åŒ¹é…è‡³ç¬¬ `s1cnt` ä¸ª `s1` çš„æœ«å°¾ï¼Œå½“å‰åŒ¹é…åˆ°ç¬¬ `s2cnt` ä¸ª `s2` ä¸­çš„ç¬¬ `index` ä¸ªå­—ç¬¦æ—¶ï¼Œ å·²ç»åŒ¹é…è¿‡çš„`s1` çš„ä¸ªæ•° `s1cnt` å’Œ `s2` çš„ä¸ªæ•° `s2cnt` ã€‚

æˆ‘ä»¬åœ¨æ¯æ¬¡éå†è‡³ `s1` çš„æœ«å°¾æ—¶æ ¹æ®å½“å‰åŒ¹é…åˆ°çš„ `s2` ä¸­çš„ä½ç½® `index` æŸ¥çœ‹å“ˆå¸Œè¡¨ä¸­çš„å¯¹åº”ä½ç½®ï¼Œå¦‚æœå“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„ä½ç½® `index` å·²ç»å­˜å‚¨å…ƒç´ ï¼Œåˆ™è¯´æ˜æˆ‘ä»¬æ‰¾åˆ°äº†å¾ªç¯èŠ‚ã€‚å¾ªç¯èŠ‚çš„é•¿åº¦å¯ä»¥ç”¨å½“å‰å·²ç»åŒ¹é…çš„ `s1` ä¸ `s2` çš„æ•°é‡å‡å»ä¸Šæ¬¡å‡ºç°æ—¶ç»è¿‡çš„æ•°é‡ï¼ˆå³å“ˆå¸Œè¡¨ä¸­å­˜å‚¨çš„å€¼ï¼‰æ¥å¾—åˆ°ã€‚

ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç®€å•çš„è¿ç®—æ±‚å‡ºæ‰€æœ‰æ„æˆå¾ªç¯èŠ‚çš„ `s2` çš„æ•°é‡ï¼Œå¯¹äºä¸å‚ä¸å¾ªç¯èŠ‚éƒ¨åˆ†çš„ `s1`ï¼Œç›´æ¥éå†è®¡ç®—å³å¯ï¼Œå…·ä½“å®ç°ä»¥åŠä¸€äº›ç»†èŠ‚è¾¹ç•Œçš„å¤„ç†è¯·çœ‹ä¸‹æ–‡çš„ä»£ç ã€‚

```Python [sol1-Python3]
class Solution:
    def getMaxRepetitions(self, s1: str, n1: int, s2: str, n2: int) -> int:
        if n1 == 0:
            return 0
        s1cnt, index, s2cnt = 0, 0, 0
        # recall æ˜¯æˆ‘ä»¬ç”¨æ¥æ‰¾å¾ªç¯èŠ‚çš„å˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå“ˆå¸Œæ˜ å°„
        # æˆ‘ä»¬å¦‚ä½•æ‰¾å¾ªç¯èŠ‚ï¼Ÿå‡è®¾æˆ‘ä»¬éå†äº† s1cnt ä¸ª s1ï¼Œæ­¤æ—¶åŒ¹é…åˆ°äº†ç¬¬ s2cnt ä¸ª s2 ä¸­çš„ç¬¬ index ä¸ªå­—ç¬¦
        # å¦‚æœæˆ‘ä»¬ä¹‹å‰éå†äº† s1cnt' ä¸ª s1 æ—¶ï¼ŒåŒ¹é…åˆ°çš„æ˜¯ç¬¬ s2cnt' ä¸ª s2 ä¸­åŒæ ·çš„ç¬¬ index ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±æœ‰å¾ªç¯èŠ‚äº†
        # æˆ‘ä»¬ç”¨ (s1cnt', s2cnt', index) å’Œ (s1cnt, s2cnt, index) è¡¨ç¤ºä¸¤æ¬¡åŒ…å«ç›¸åŒ index çš„åŒ¹é…ç»“æœ
        # é‚£ä¹ˆå“ˆå¸Œæ˜ å°„ä¸­çš„é”®å°±æ˜¯ indexï¼Œå€¼å°±æ˜¯ (s1cnt', s2cnt') è¿™ä¸ªäºŒå…ƒç»„
        # å¾ªç¯èŠ‚å°±æ˜¯ï¼›
        #    - å‰ s1cnt' ä¸ª s1 åŒ…å«äº† s2cnt' ä¸ª s2
        #    - ä»¥åçš„æ¯ (s1cnt - s1cnt') ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt') ä¸ª s2
        # é‚£ä¹ˆè¿˜ä¼šå‰©ä¸‹ (n1 - s1cnt') % (s1cnt - s1cnt') ä¸ª s1, æˆ‘ä»¬å¯¹è¿™äº›ä¸ s2 è¿›è¡Œæš´åŠ›åŒ¹é…
        # æ³¨æ„ s2 è¦ä»ç¬¬ index ä¸ªå­—ç¬¦å¼€å§‹åŒ¹é…
        recall = dict()
        while True:
            # æˆ‘ä»¬å¤šéå†ä¸€ä¸ª s1ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å¾ªç¯èŠ‚
            s1cnt += 1
            for ch in s1:
                if ch == s2[index]:
                    index += 1
                    if index == len(s2):
                        s2cnt, index = s2cnt + 1, 0
            # è¿˜æ²¡æœ‰æ‰¾åˆ°å¾ªç¯èŠ‚ï¼Œæ‰€æœ‰çš„ s1 å°±ç”¨å®Œäº†
            if s1cnt == n1:
                return s2cnt // n2
            # å‡ºç°äº†ä¹‹å‰çš„ indexï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†å¾ªç¯èŠ‚
            if index in recall:
                s1cnt_prime, s2cnt_prime = recall[index]
                # å‰ s1cnt' ä¸ª s1 åŒ…å«äº† s2cnt' ä¸ª s2
                pre_loop = (s1cnt_prime, s2cnt_prime)
                # ä»¥åçš„æ¯ (s1cnt - s1cnt') ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt') ä¸ª s2
                in_loop = (s1cnt - s1cnt_prime, s2cnt - s2cnt_prime)
                break
            else:
                recall[index] = (s1cnt, s2cnt)

        # ans å­˜å‚¨çš„æ˜¯ S1 åŒ…å«çš„ s2 çš„æ•°é‡ï¼Œè€ƒè™‘çš„ä¹‹å‰çš„ pre_loop å’Œ in_loop
        ans = pre_loop[1] + (n1 - pre_loop[0]) // in_loop[0] * in_loop[1]
        # S1 çš„æœ«å°¾è¿˜å‰©ä¸‹ä¸€äº› s1ï¼Œæˆ‘ä»¬æš´åŠ›è¿›è¡ŒåŒ¹é…
        rest = (n1 - pre_loop[0]) % in_loop[0]
        for i in range(rest):
            for ch in s1:
                if ch == s2[index]:
                    index += 1
                    if index == len(s2):
                        ans, index = ans + 1, 0
        # S1 åŒ…å« ans ä¸ª s2ï¼Œé‚£ä¹ˆå°±åŒ…å« ans / n2 ä¸ª S2
        return ans // n2
```

```C++ [sol1-C++]
class Solution {
public:
    int getMaxRepetitions(string s1, int n1, string s2, int n2) {
        if (n1 == 0) {
            return 0;
        }
        int s1cnt = 0, index = 0, s2cnt = 0;
        // recall æ˜¯æˆ‘ä»¬ç”¨æ¥æ‰¾å¾ªç¯èŠ‚çš„å˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå“ˆå¸Œæ˜ å°„
        // æˆ‘ä»¬å¦‚ä½•æ‰¾å¾ªç¯èŠ‚ï¼Ÿå‡è®¾æˆ‘ä»¬éå†äº† s1cnt ä¸ª s1ï¼Œæ­¤æ—¶åŒ¹é…åˆ°äº†ç¬¬ s2cnt ä¸ª s2 ä¸­çš„ç¬¬ index ä¸ªå­—ç¬¦
        // å¦‚æœæˆ‘ä»¬ä¹‹å‰éå†äº† s1cnt' ä¸ª s1 æ—¶ï¼ŒåŒ¹é…åˆ°çš„æ˜¯ç¬¬ s2cnt' ä¸ª s2 ä¸­åŒæ ·çš„ç¬¬ index ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±æœ‰å¾ªç¯èŠ‚äº†
        // æˆ‘ä»¬ç”¨ (s1cnt', s2cnt', index) å’Œ (s1cnt, s2cnt, index) è¡¨ç¤ºä¸¤æ¬¡åŒ…å«ç›¸åŒ index çš„åŒ¹é…ç»“æœ
        // é‚£ä¹ˆå“ˆå¸Œæ˜ å°„ä¸­çš„é”®å°±æ˜¯ indexï¼Œå€¼å°±æ˜¯ (s1cnt', s2cnt') è¿™ä¸ªäºŒå…ƒç»„
        // å¾ªç¯èŠ‚å°±æ˜¯ï¼›
        //    - å‰ s1cnt' ä¸ª s1 åŒ…å«äº† s2cnt' ä¸ª s2
        //    - ä»¥åçš„æ¯ (s1cnt - s1cnt') ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt') ä¸ª s2
        // é‚£ä¹ˆè¿˜ä¼šå‰©ä¸‹ (n1 - s1cnt') % (s1cnt - s1cnt') ä¸ª s1, æˆ‘ä»¬å¯¹è¿™äº›ä¸ s2 è¿›è¡Œæš´åŠ›åŒ¹é…
        // æ³¨æ„ s2 è¦ä»ç¬¬ index ä¸ªå­—ç¬¦å¼€å§‹åŒ¹é…
        unordered_map<int, pair<int, int>> recall;
        pair<int, int> pre_loop, in_loop;
        while (true) {
            // æˆ‘ä»¬å¤šéå†ä¸€ä¸ª s1ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å¾ªç¯èŠ‚
            ++s1cnt;
            for (char ch: s1) {
                if (ch == s2[index]) {
                    index += 1;
                    if (index == s2.size()) {
                        ++s2cnt;
                        index = 0;
                    }
                }
            }
            // è¿˜æ²¡æœ‰æ‰¾åˆ°å¾ªç¯èŠ‚ï¼Œæ‰€æœ‰çš„ s1 å°±ç”¨å®Œäº†
            if (s1cnt == n1) {
                return s2cnt / n2;
            }
            // å‡ºç°äº†ä¹‹å‰çš„ indexï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†å¾ªç¯èŠ‚
            if (recall.count(index)) {
                auto [s1cnt_prime, s2cnt_prime] = recall[index];
                // å‰ s1cnt' ä¸ª s1 åŒ…å«äº† s2cnt' ä¸ª s2
                pre_loop = {s1cnt_prime, s2cnt_prime};
                // ä»¥åçš„æ¯ (s1cnt - s1cnt') ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt') ä¸ª s2
                in_loop = {s1cnt - s1cnt_prime, s2cnt - s2cnt_prime};
                break;
            } else {
                recall[index] = {s1cnt, s2cnt};
            }
        }
        // ans å­˜å‚¨çš„æ˜¯ S1 åŒ…å«çš„ s2 çš„æ•°é‡ï¼Œè€ƒè™‘çš„ä¹‹å‰çš„ pre_loop å’Œ in_loop
        int ans = pre_loop.second + (n1 - pre_loop.first) / in_loop.first * in_loop.second;
        // S1 çš„æœ«å°¾è¿˜å‰©ä¸‹ä¸€äº› s1ï¼Œæˆ‘ä»¬æš´åŠ›è¿›è¡ŒåŒ¹é…
        int rest = (n1 - pre_loop.first) % in_loop.first;
        for (int i = 0; i < rest; ++i) {
            for (char ch: s1) {
                if (ch == s2[index]) {
                    ++index;
                    if (index == s2.size()) {
                        ++ans;
                        index = 0;
                    }
                }
            }
        }
        // S1 åŒ…å« ans ä¸ª s2ï¼Œé‚£ä¹ˆå°±åŒ…å« ans / n2 ä¸ª S2
        return ans / n2;
    }
};
```

```Java [sol1-Java]
class Solution {
    public int getMaxRepetitions(String s1, int n1, String s2, int n2) {
        if (n1 == 0) {
            return 0;
        }
        int s1cnt = 0, index = 0, s2cnt = 0;
        // recall æ˜¯æˆ‘ä»¬ç”¨æ¥æ‰¾å¾ªç¯èŠ‚çš„å˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå“ˆå¸Œæ˜ å°„
        // æˆ‘ä»¬å¦‚ä½•æ‰¾å¾ªç¯èŠ‚ï¼Ÿå‡è®¾æˆ‘ä»¬éå†äº† s1cnt ä¸ª s1ï¼Œæ­¤æ—¶åŒ¹é…åˆ°äº†ç¬¬ s2cnt ä¸ª s2 ä¸­çš„ç¬¬ index ä¸ªå­—ç¬¦
        // å¦‚æœæˆ‘ä»¬ä¹‹å‰éå†äº† s1cnt' ä¸ª s1 æ—¶ï¼ŒåŒ¹é…åˆ°çš„æ˜¯ç¬¬ s2cnt' ä¸ª s2 ä¸­åŒæ ·çš„ç¬¬ index ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±æœ‰å¾ªç¯èŠ‚äº†
        // æˆ‘ä»¬ç”¨ (s1cnt', s2cnt', index) å’Œ (s1cnt, s2cnt, index) è¡¨ç¤ºä¸¤æ¬¡åŒ…å«ç›¸åŒ index çš„åŒ¹é…ç»“æœ
        // é‚£ä¹ˆå“ˆå¸Œæ˜ å°„ä¸­çš„é”®å°±æ˜¯ indexï¼Œå€¼å°±æ˜¯ (s1cnt', s2cnt') è¿™ä¸ªäºŒå…ƒç»„
        // å¾ªç¯èŠ‚å°±æ˜¯ï¼›
        //    - å‰ s1cnt' ä¸ª s1 åŒ…å«äº† s2cnt' ä¸ª s2
        //    - ä»¥åçš„æ¯ (s1cnt - s1cnt') ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt') ä¸ª s2
        // é‚£ä¹ˆè¿˜ä¼šå‰©ä¸‹ (n1 - s1cnt') % (s1cnt - s1cnt') ä¸ª s1, æˆ‘ä»¬å¯¹è¿™äº›ä¸ s2 è¿›è¡Œæš´åŠ›åŒ¹é…
        // æ³¨æ„ s2 è¦ä»ç¬¬ index ä¸ªå­—ç¬¦å¼€å§‹åŒ¹é…
        Map<Integer, int[]> recall = new HashMap<Integer, int[]>();
        int[] preLoop = new int[2];
        int[] inLoop = new int[2];
        while (true) {
            // æˆ‘ä»¬å¤šéå†ä¸€ä¸ª s1ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å¾ªç¯èŠ‚
            ++s1cnt;
            for (int i = 0; i < s1.length(); ++i) {
                char ch = s1.charAt(i);
                if (ch == s2.charAt(index)) {
                    index += 1;
                    if (index == s2.length()) {
                        ++s2cnt;
                        index = 0;
                    }
                }
            }
            // è¿˜æ²¡æœ‰æ‰¾åˆ°å¾ªç¯èŠ‚ï¼Œæ‰€æœ‰çš„ s1 å°±ç”¨å®Œäº†
            if (s1cnt == n1) {
                return s2cnt / n2;
            }
            // å‡ºç°äº†ä¹‹å‰çš„ indexï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†å¾ªç¯èŠ‚
            if (recall.containsKey(index)) {
                int[] value = recall.get(index);
                int s1cntPrime = value[0];
                int s2cntPrime = value[1];
                // å‰ s1cnt' ä¸ª s1 åŒ…å«äº† s2cnt' ä¸ª s2
                preLoop = new int[]{s1cntPrime, s2cntPrime};
                // ä»¥åçš„æ¯ (s1cnt - s1cnt') ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt') ä¸ª s2
                inLoop = new int[]{s1cnt - s1cntPrime, s2cnt - s2cntPrime};
                break;
            } else {
                recall.put(index, new int[]{s1cnt, s2cnt});
            }
        }
        // ans å­˜å‚¨çš„æ˜¯ S1 åŒ…å«çš„ s2 çš„æ•°é‡ï¼Œè€ƒè™‘çš„ä¹‹å‰çš„ preLoop å’Œ inLoop
        int ans = preLoop[1] + (n1 - preLoop[0]) / inLoop[0] * inLoop[1];
        // S1 çš„æœ«å°¾è¿˜å‰©ä¸‹ä¸€äº› s1ï¼Œæˆ‘ä»¬æš´åŠ›è¿›è¡ŒåŒ¹é…
        int rest = (n1 - preLoop[0]) % inLoop[0];
        for (int i = 0; i < rest; ++i) {
            for (int j = 0; j < s1.length(); ++j) {
                char ch = s1.charAt(j);
                if (ch == s2.charAt(index)) {
                    ++index;
                    if (index == s2.length()) {
                        ++ans;
                        index = 0;
                    }
                }
            }
        }
        // S1 åŒ…å« ans ä¸ª s2ï¼Œé‚£ä¹ˆå°±åŒ…å« ans / n2 ä¸ª S2
        return ans / n2;
    }
}
```

**å¤æ‚åº¦åˆ†æ**

* æ—¶é—´å¤æ‚åº¦ï¼š$O(|s1| \times |s2|)$ã€‚æˆ‘ä»¬æœ€å¤šæ‰¾è¿‡ $|s2| + 1$ ä¸ª $s1$ï¼Œå°±å¯ä»¥æ‰¾åˆ°å¾ªç¯èŠ‚ï¼Œæœ€åæƒ…å†µä¸‹éœ€è¦éå†çš„å­—ç¬¦æ•°é‡çº§ä¸º $O(|s1| \times |s2|)$ã€‚

* ç©ºé—´å¤æ‚åº¦ï¼š$O(|s2|)$ã€‚æˆ‘ä»¬å»ºç«‹çš„å“ˆå¸Œè¡¨å¤§å°ç­‰äº $s2$ çš„é•¿åº¦ã€‚