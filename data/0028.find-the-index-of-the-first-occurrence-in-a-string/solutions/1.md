## [28.æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡ ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/solutions/100000/shua-chuan-lc-shuang-bai-po-su-jie-fa-km-tb86)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)

## æœ´ç´ è§£æ³•

ç›´è§‚çš„è§£æ³•çš„æ˜¯ï¼šæšä¸¾åŸä¸² `ss` ä¸­çš„æ¯ä¸ªå­—ç¬¦ä½œä¸ºã€Œå‘èµ·ç‚¹ã€ï¼Œæ¯æ¬¡ä»åŸä¸²çš„ã€Œå‘èµ·ç‚¹ã€å’ŒåŒ¹é…ä¸²çš„ã€Œé¦–ä½ã€å¼€å§‹å°è¯•åŒ¹é…ï¼š

* åŒ¹é…æˆåŠŸï¼šè¿”å›æœ¬æ¬¡åŒ¹é…çš„åŸä¸²ã€Œå‘èµ·ç‚¹ã€ã€‚
* åŒ¹é…å¤±è´¥ï¼šæšä¸¾åŸä¸²çš„ä¸‹ä¸€ä¸ªã€Œå‘èµ·ç‚¹ã€ï¼Œé‡æ–°å°è¯•åŒ¹é…ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    public int strStr(String ss, String pp) {
        int n = ss.length(), m = pp.length();
        char[] s = ss.toCharArray(), p = pp.toCharArray();
        // æšä¸¾åŸä¸²çš„ã€Œå‘èµ·ç‚¹ã€
        for (int i = 0; i <= n - m; i++) {
            // ä»åŸä¸²çš„ã€Œå‘èµ·ç‚¹ã€å’ŒåŒ¹é…ä¸²çš„ã€Œé¦–ä½ã€å¼€å§‹ï¼Œå°è¯•åŒ¹é…
            int a = i, b = 0;
            while (b < m && s[a] == p[b]) {
                a++;
                b++;
            }
            // å¦‚æœèƒ½å¤Ÿå®Œå…¨åŒ¹é…ï¼Œè¿”å›åŸä¸²çš„ã€Œå‘èµ·ç‚¹ã€ä¸‹æ ‡
            if (b == m) return i;
        }
        return -1;
    }
}
```
```C++ []
class Solution {
public:
    int strStr(string s, string p) {
        int n = s.size(), m = p.size();
        for(int i = 0; i <= n - m; i++){
            int j = i, k = 0; 
            while(k < m and s[j] == p[k]){
                j++;
                k++;
            }
            if(k == m) return i;
        }
        return -1;
    }
};
```
* æ—¶é—´å¤æ‚åº¦ï¼š`n` ä¸ºåŸä¸²çš„é•¿åº¦ï¼Œ`m` ä¸ºåŒ¹é…ä¸²çš„é•¿åº¦ã€‚å…¶ä¸­æšä¸¾çš„å¤æ‚åº¦ä¸º $O(n - m)$ï¼Œæ„é€ å’Œæ¯”è¾ƒå­—ç¬¦ä¸²çš„å¤æ‚åº¦ä¸º $O(m)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O((n - m) * m)$ã€‚

* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚

***

## KMP è§£æ³•

KMP ç®—æ³•æ˜¯ä¸€ä¸ªå¿«é€ŸæŸ¥æ‰¾åŒ¹é…ä¸²çš„ç®—æ³•ï¼Œå®ƒçš„ä½œç”¨å…¶å®å°±æ˜¯æœ¬é¢˜é—®é¢˜ï¼š**å¦‚ä½•å¿«é€Ÿåœ¨ã€ŒåŸå­—ç¬¦ä¸²ã€ä¸­æ‰¾åˆ°ã€ŒåŒ¹é…å­—ç¬¦ä¸²ã€ã€‚**

ä¸Šè¿°çš„æœ´ç´ è§£æ³•ï¼Œä¸è€ƒè™‘å‰ªæçš„è¯å¤æ‚åº¦æ˜¯ $O(m * n)$ çš„ï¼Œè€Œ KMP ç®—æ³•çš„å¤æ‚åº¦ä¸º $O(m + n)$ã€‚

**KMP ä¹‹æ‰€ä»¥èƒ½å¤Ÿåœ¨ $O(m + n)$ å¤æ‚åº¦å†…å®ŒæˆæŸ¥æ‰¾ï¼Œæ˜¯å› ä¸ºå…¶èƒ½åœ¨ã€Œéå®Œå…¨åŒ¹é…ã€çš„è¿‡ç¨‹ä¸­æå–åˆ°æœ‰æ•ˆä¿¡æ¯è¿›è¡Œå¤ç”¨ï¼Œä»¥å‡å°‘ã€Œé‡å¤åŒ¹é…ã€çš„æ¶ˆè€—ã€‚**

ä½ å¯èƒ½ä¸å¤ªç†è§£ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¾ ğŸŒ° æ¥ç†è§£ KMPã€‚


### 1. åŒ¹é…è¿‡ç¨‹

åœ¨æ¨¡æ‹Ÿ KMP åŒ¹é…è¿‡ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå»ºç«‹ä¸¤ä¸ªæ¦‚å¿µï¼š

* å‰ç¼€ï¼šå¯¹äºå­—ç¬¦ä¸² `abcxxxxefg`ï¼Œæˆ‘ä»¬ç§° `abc` å±äº `abcxxxxefg` çš„æŸä¸ªå‰ç¼€ã€‚
* åç¼€ï¼šå¯¹äºå­—ç¬¦ä¸² `abcxxxxefg`ï¼Œæˆ‘ä»¬ç§° `efg` å±äº `abcxxxxefg` çš„æŸä¸ªåç¼€ã€‚

ç„¶åæˆ‘ä»¬å‡è®¾åŸä¸²ä¸º `abeababeabf`ï¼ŒåŒ¹é…ä¸²ä¸º `abeabf`ï¼š

![image.png](https://pic.leetcode-cn.com/1618739635-lrhElP-image.png)

æˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹å¦‚æœä¸ä½¿ç”¨ KMPï¼Œä¼šå¦‚ä½•è¿›è¡ŒåŒ¹é…ï¼ˆä¸ä½¿ç”¨ `substring` å‡½æ•°çš„æƒ…å†µä¸‹ï¼‰ã€‚

é¦–å…ˆåœ¨ã€ŒåŸä¸²ã€å’Œã€ŒåŒ¹é…ä¸²ã€åˆ†åˆ«å„è‡ªæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å½“å‰åŒ¹é…çš„ä½ç½®ã€‚

é¦–æ¬¡åŒ¹é…çš„ã€Œå‘èµ·ç‚¹ã€æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ `a`ã€‚æ˜¾ç„¶ï¼Œåé¢çš„ `abeab` éƒ½æ˜¯åŒ¹é…çš„ï¼Œä¸¤ä¸ªæŒ‡é’ˆä¼šåŒæ—¶å¾€å³ç§»åŠ¨ï¼ˆé»‘æ ‡ï¼‰ã€‚

åœ¨éƒ½èƒ½åŒ¹é…ä¸Š `abeab` çš„éƒ¨åˆ†ï¼Œã€Œæœ´ç´ åŒ¹é…ã€å’Œã€ŒKMPã€å¹¶æ— ä¸åŒã€‚

ç›´åˆ°å‡ºç°ç¬¬ä¸€ä¸ªä¸åŒçš„ä½ç½®ï¼ˆçº¢æ ‡ï¼‰ï¼š

![image.png](https://pic.leetcode-cn.com/1618741727-pqXsfg-image.png)

**æ¥ä¸‹æ¥ï¼Œæ­£æ˜¯ã€Œæœ´ç´ åŒ¹é…ã€å’Œã€ŒKMPã€å‡ºç°ä¸åŒçš„åœ°æ–¹ï¼š**

* **å…ˆçœ‹ä¸‹ã€Œæœ´ç´ åŒ¹é…ã€é€»è¾‘ï¼š**

**1. å°†åŸä¸²çš„æŒ‡é’ˆç§»åŠ¨è‡³æœ¬æ¬¡ã€Œå‘èµ·ç‚¹ã€çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼ˆ`b` å­—ç¬¦å¤„ï¼‰ï¼›åŒ¹é…ä¸²çš„æŒ‡é’ˆç§»åŠ¨è‡³èµ·å§‹ä½ç½®ã€‚**

**2. å°è¯•åŒ¹é…ï¼Œå‘ç°å¯¹ä¸ä¸Šï¼ŒåŸä¸²çš„æŒ‡é’ˆä¼šä¸€ç›´å¾€åç§»åŠ¨ï¼Œç›´åˆ°èƒ½å¤Ÿä¸åŒ¹é…ä¸²å¯¹ä¸Šä½ç½®ã€‚**

å¦‚å›¾ï¼š

![image.png](https://pic.leetcode-cn.com/1618742678-lTXSgV-image.png)

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºã€Œæœ´ç´ åŒ¹é…ã€è€Œè¨€ï¼Œä¸€æ—¦åŒ¹é…å¤±è´¥ï¼Œå°†ä¼šå°†åŸä¸²æŒ‡é’ˆè°ƒæ•´è‡³ä¸‹ä¸€ä¸ªã€Œå‘èµ·ç‚¹ã€ï¼ŒåŒ¹é…ä¸²çš„æŒ‡é’ˆè°ƒæ•´è‡³èµ·å§‹ä½ç½®ï¼Œç„¶åé‡æ–°å°è¯•åŒ¹é…ã€‚

è¿™ä¹Ÿå°±ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆã€Œæœ´ç´ åŒ¹é…ã€çš„å¤æ‚åº¦æ˜¯ $O(m * n)$ äº†ã€‚

* **ç„¶åæˆ‘ä»¬å†çœ‹çœ‹ã€ŒKMP åŒ¹é…ã€è¿‡ç¨‹ï¼š**

**é¦–å…ˆåŒ¹é…ä¸²ä¼šæ£€æŸ¥ä¹‹å‰å·²ç»åŒ¹é…æˆåŠŸçš„éƒ¨åˆ†ä¸­é‡Œæ˜¯å¦å­˜åœ¨ç›¸åŒçš„ã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™è·³è½¬åˆ°ã€Œå‰ç¼€ã€çš„ä¸‹ä¸€ä¸ªä½ç½®ç»§ç»­å¾€ä¸‹åŒ¹é…ï¼š**

![9364346F937803F03CD1A0AE645EA0F1.jpg](https://pic.leetcode-cn.com/1618845342-ydYJRp-9364346F937803F03CD1A0AE645EA0F1.jpg)

**è·³è½¬åˆ°ä¸‹ä¸€åŒ¹é…ä½ç½®åï¼Œå°è¯•åŒ¹é…ï¼Œå‘ç°ä¸¤ä¸ªæŒ‡é’ˆçš„å­—ç¬¦å¯¹ä¸ä¸Šï¼Œå¹¶ä¸”æ­¤æ—¶åŒ¹é…ä¸²æŒ‡é’ˆå‰é¢ä¸å­˜åœ¨ç›¸åŒçš„ã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€ï¼Œè¿™æ—¶å€™åªèƒ½å›åˆ°åŒ¹é…ä¸²çš„èµ·å§‹ä½ç½®é‡æ–°å¼€å§‹ï¼š**

![image.png](https://pic.leetcode-cn.com/1618755191-ddejks-image.png)

**åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥æ¸…æ¥š KMP ä¸ºä»€ä¹ˆç›¸æ¯”äºæœ´ç´ è§£æ³•æ›´å¿«ï¼š**

* **å› ä¸º KMP åˆ©ç”¨å·²åŒ¹é…éƒ¨åˆ†ä¸­ç›¸åŒçš„ã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€æ¥åŠ é€Ÿä¸‹ä¸€æ¬¡çš„åŒ¹é…ã€‚**

* **å› ä¸º KMP çš„åŸä¸²æŒ‡é’ˆä¸ä¼šè¿›è¡Œå›æº¯ï¼ˆæ²¡æœ‰æœ´ç´ åŒ¹é…ä¸­å›åˆ°ä¸‹ä¸€ä¸ªã€Œå‘èµ·ç‚¹ã€çš„è¿‡ç¨‹ï¼‰ã€‚**

ç¬¬ä¸€ç‚¹å¾ˆç›´è§‚ï¼Œä¹Ÿå¾ˆå¥½ç†è§£ã€‚

æˆ‘ä»¬å¯ä»¥æŠŠé‡ç‚¹æ”¾åœ¨ç¬¬äºŒç‚¹ä¸Šï¼ŒåŸä¸²ä¸å›æº¯è‡³ã€Œå‘èµ·ç‚¹ã€æ„å‘³ç€ä»€ä¹ˆï¼Ÿ

**å…¶å®æ˜¯æ„å‘³ç€ï¼šéšç€åŒ¹é…è¿‡ç¨‹çš„è¿›è¡Œï¼ŒåŸä¸²æŒ‡é’ˆçš„ä¸æ–­å³ç§»ï¼Œæˆ‘ä»¬æœ¬è´¨ä¸Šæ˜¯åœ¨ä¸æ–­åœ°åœ¨å¦å†³ä¸€äº›ã€Œä¸å¯èƒ½ã€çš„æ–¹æ¡ˆã€‚**

**å½“æˆ‘ä»¬çš„åŸä¸²æŒ‡é’ˆä» `i` ä½ç½®åç§»åˆ° `j` ä½ç½®ï¼Œä¸ä»…ä»…ä»£è¡¨ç€ã€ŒåŸä¸²ã€ä¸‹æ ‡èŒƒå›´ä¸º $[i,j)$ çš„å­—ç¬¦ä¸ã€ŒåŒ¹é…ä¸²ã€åŒ¹é…æˆ–è€…ä¸åŒ¹é…ï¼Œæ›´æ˜¯åœ¨å¦å†³é‚£äº›ä»¥ã€ŒåŸä¸²ã€ä¸‹æ ‡èŒƒå›´ä¸º $[i,j)$ ä¸ºã€ŒåŒ¹é…å‘èµ·ç‚¹ã€çš„å­é›†ã€‚**


### 2. åˆ†æå®ç°

åˆ°è¿™é‡Œï¼Œå°±ç»“æŸäº†å—ï¼Ÿè¦å¼€å§‹åŠ¨æ‰‹å®ç°ä¸Šè¿°åŒ¹é…è¿‡ç¨‹äº†å—ï¼Ÿ

æˆ‘ä»¬å¯ä»¥å…ˆåˆ†æä¸€ä¸‹å¤æ‚åº¦ã€‚å¦‚æœä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°è§£æ³•çš„è¯ï¼Œæœ€åæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦æ‰«ææ•´ä¸ªåŸä¸²ï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚åŒæ—¶åœ¨æ¯ä¸€æ¬¡åŒ¹é…å¤±è´¥æ—¶ï¼Œå»æ£€æŸ¥å·²åŒ¹é…éƒ¨åˆ†çš„ç›¸åŒã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€ï¼Œè·³è½¬åˆ°ç›¸åº”çš„ä½ç½®ï¼Œå¦‚æœä¸åŒ¹é…åˆ™å†æ£€æŸ¥å‰é¢éƒ¨åˆ†æ˜¯å¦æœ‰ç›¸åŒã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€ï¼Œå†è·³è½¬åˆ°ç›¸åº”çš„ä½ç½® ... è¿™éƒ¨åˆ†çš„å¤æ‚åº¦æ˜¯ $O(m^2)$ ï¼Œå› æ­¤æ•´ä½“çš„å¤æ‚åº¦æ˜¯ $O(n * m^2)$ï¼Œè€Œæˆ‘ä»¬çš„æœ´ç´ è§£æ³•æ˜¯ $O(m * n)$ çš„ã€‚

è¯´æ˜è¿˜æœ‰ä¸€äº›æ€§è´¨æˆ‘ä»¬æ²¡æœ‰åˆ©ç”¨åˆ°ã€‚

æ˜¾ç„¶ï¼Œæ‰«æå®Œæ•´åŸä¸²æ“ä½œè¿™ä¸€æ“ä½œæ˜¯ä¸å¯é¿å…çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–çš„åªèƒ½æ˜¯ã€Œ**æ£€æŸ¥å·²åŒ¹é…éƒ¨åˆ†çš„ç›¸åŒå‰ç¼€å’Œåç¼€**ã€è¿™ä¸€è¿‡ç¨‹ã€‚

å†è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬æ£€æŸ¥ã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€çš„ç›®çš„å…¶å®æ˜¯ã€Œä¸ºäº†ç¡®å®šåŒ¹é…ä¸²ä¸­çš„ä¸‹ä¸€æ®µå¼€å§‹åŒ¹é…çš„ä½ç½®ã€ã€‚

**åŒæ—¶æˆ‘ä»¬å‘ç°ï¼Œå¯¹äºåŒ¹é…ä¸²çš„ä»»æ„ä¸€ä¸ªä½ç½®è€Œè¨€ï¼Œç”±è¯¥ä½ç½®å‘èµ·çš„ä¸‹ä¸€ä¸ªåŒ¹é…ç‚¹ä½ç½®å…¶å®ä¸åŸä¸²æ— å…³ã€‚**

ä¸¾ä¸ª ğŸŒ°ï¼Œå¯¹äºåŒ¹é…ä¸² `abcabd` çš„å­—ç¬¦ `d` è€Œè¨€ï¼Œç”±å®ƒå‘èµ·çš„ä¸‹ä¸€ä¸ªåŒ¹é…ç‚¹è·³è½¬å¿…ç„¶æ˜¯å­—ç¬¦ `c` çš„ä½ç½®ã€‚å› ä¸ºå­—ç¬¦ `d` ä½ç½®çš„ç›¸åŒã€Œå‰ç¼€ã€å’Œã€Œåç¼€ã€å­—ç¬¦ `ab` çš„ä¸‹ä¸€ä½ç½®å°±æ˜¯å­—ç¬¦ `c`ã€‚

**å¯è§ä»åŒ¹é…ä¸²æŸä¸ªä½ç½®è·³è½¬ä¸‹ä¸€ä¸ªåŒ¹é…ä½ç½®è¿™ä¸€è¿‡ç¨‹æ˜¯ä¸åŸä¸²æ— å…³çš„ï¼Œæˆ‘ä»¬å°†è¿™ä¸€è¿‡ç¨‹ç§°ä¸ºæ‰¾ `next` ç‚¹ã€‚**

**æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†å‡º `next` æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªä½ç½®çš„å€¼å°±æ˜¯è¯¥ä¸‹æ ‡åº”è¯¥è·³è½¬çš„ç›®æ ‡ä½ç½®ï¼ˆ `next` ç‚¹ï¼‰ã€‚**

å½“æˆ‘ä»¬è¿›è¡Œäº†è¿™ä¸€æ­¥ä¼˜åŒ–ä¹‹åï¼Œå¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ

é¢„å¤„ç† `next` æ•°ç»„çš„å¤æ‚åº¦æœªçŸ¥ï¼ŒåŒ¹é…è¿‡ç¨‹æœ€å¤šæ‰«æå®Œæ•´ä¸ªåŸä¸²ï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚

å› æ­¤å¦‚æœæˆ‘ä»¬å¸Œæœ›æ•´ä¸ª KMP è¿‡ç¨‹æ˜¯ $O(m + n)$ çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ $O(m)$ çš„å¤æ‚åº¦å†…é¢„å¤„ç†å‡º `next`æ•°ç»„ã€‚

**æ‰€ä»¥æˆ‘ä»¬çš„é‡ç‚¹åœ¨äºå¦‚ä½•åœ¨ $O(m)$ å¤æ‚åº¦å†…å¤„ç†å¤„ `next` æ•°ç»„ã€‚**

### 3. `next` æ•°ç»„çš„æ„å»º

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ `next` æ•°ç»„æ˜¯å¦‚ä½•åœ¨ $O(m)$ çš„å¤æ‚åº¦å†…è¢«é¢„å¤„ç†å‡ºæ¥çš„ã€‚

å‡è®¾æœ‰åŒ¹é…ä¸² `aaabbab`ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¯¹åº”çš„ `next` æ˜¯å¦‚ä½•è¢«æ„å»ºå‡ºæ¥çš„ã€‚

![010FD8AE2B79FFE03DC3735ACD224A6A.png](https://pic.leetcode-cn.com/1618846927-xFAEXE-010FD8AE2B79FFE03DC3735ACD224A6A.png)

![B9497542844478144BED83E9ADA0C12F.png](https://pic.leetcode-cn.com/1618847960-lkVIDM-B9497542844478144BED83E9ADA0C12F.png)

![161584A2D930A7B91092A2C3872D9DE5.png](https://pic.leetcode-cn.com/1618847981-wncoqJ-161584A2D930A7B91092A2C3872D9DE5.png)

![6127EBA37435560C20BB8B15D5B790B6.png](https://pic.leetcode-cn.com/1618847995-vRWimV-6127EBA37435560C20BB8B15D5B790B6.png)

è¿™å°±æ˜¯æ•´ä¸ª `next` æ•°ç»„çš„æ„å»ºè¿‡ç¨‹ï¼Œæ—¶ç©ºå¤æ‚åº¦å‡ä¸º $O(m)$ã€‚

è‡³æ­¤æ•´ä¸ª KMP åŒ¹é…è¿‡ç¨‹å¤æ‚åº¦æ˜¯ $O(m + n)$ çš„ã€‚

### 4. ä»£ç å®ç°

åœ¨å®é™…ç¼–ç æ—¶ï¼Œé€šå¸¸æˆ‘ä¼šå¾€åŸä¸²å’ŒåŒ¹é…ä¸²å¤´éƒ¨è¿½åŠ ä¸€ä¸ªç©ºæ ¼ï¼ˆå“¨å…µï¼‰ã€‚

ç›®çš„æ˜¯è®© `j` ä¸‹æ ‡ä» `0` å¼€å§‹ï¼Œçœå» `j` ä» `-1` å¼€å§‹çš„éº»çƒ¦ã€‚

æ•´ä¸ªè¿‡ç¨‹ä¸ä¸Šè¿°åˆ†æå®Œå…¨ä¸€è‡´ï¼Œä¸€äº›ç›¸å…³çš„æ³¨é‡Šæˆ‘å·²ç»å†™åˆ°ä»£ç é‡Œã€‚

ä»£ç ï¼š
```Java []
class Solution {
    // KMP ç®—æ³•
    // ss: åŸä¸²(string)  pp: åŒ¹é…ä¸²(pattern)
    public int strStr(String ss, String pp) {
        if (pp.isEmpty()) return 0;
        
        // åˆ†åˆ«è¯»å–åŸä¸²å’ŒåŒ¹é…ä¸²çš„é•¿åº¦
        int n = ss.length(), m = pp.length();
        // åŸä¸²å’ŒåŒ¹é…ä¸²å‰é¢éƒ½åŠ ç©ºæ ¼ï¼Œä½¿å…¶ä¸‹æ ‡ä» 1 å¼€å§‹
        ss = " " + ss;
        pp = " " + pp;

        char[] s = ss.toCharArray();
        char[] p = pp.toCharArray();

        // æ„å»º next æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦ä¸ºåŒ¹é…ä¸²çš„é•¿åº¦ï¼ˆnext æ•°ç»„æ˜¯å’ŒåŒ¹é…ä¸²ç›¸å…³çš„ï¼‰
        int[] next = new int[m + 1];
        // æ„é€ è¿‡ç¨‹ i = 2ï¼Œj = 0 å¼€å§‹ï¼Œi å°äºç­‰äºåŒ¹é…ä¸²é•¿åº¦ ã€æ„é€  i ä» 2 å¼€å§‹ã€‘
        for (int i = 2, j = 0; i <= m; i++) {
            // åŒ¹é…ä¸æˆåŠŸçš„è¯ï¼Œj = next(j)
            while (j > 0 && p[i] != p[j + 1]) j = next[j];
            // åŒ¹é…æˆåŠŸçš„è¯ï¼Œå…ˆè®© j++
            if (p[i] == p[j + 1]) j++;
            // æ›´æ–° next[i]ï¼Œç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œi++
            next[i] = j;
        }

        // åŒ¹é…è¿‡ç¨‹ï¼Œi = 1ï¼Œj = 0 å¼€å§‹ï¼Œi å°äºç­‰äºåŸä¸²é•¿åº¦ ã€åŒ¹é… i ä» 1 å¼€å§‹ã€‘
        for (int i = 1, j = 0; i <= n; i++) {
            // åŒ¹é…ä¸æˆåŠŸ j = next(j)
            while (j > 0 && s[i] != p[j + 1]) j = next[j];
            // åŒ¹é…æˆåŠŸçš„è¯ï¼Œå…ˆè®© j++ï¼Œç»“æŸæœ¬æ¬¡å¾ªç¯å i++
            if (s[i] == p[j + 1]) j++;
            // æ•´ä¸€æ®µåŒ¹é…æˆåŠŸï¼Œç›´æ¥è¿”å›ä¸‹æ ‡
            if (j == m) return i - m;
        }

        return -1;
    }
}
```
```C++ []
class Solution {
public:
    int strStr(string s, string p) {
        int n = s.size(), m = p.size();
        if(m == 0) return 0;
        //è®¾ç½®å“¨å…µ
        s.insert(s.begin(),' ');
        p.insert(p.begin(),' ');
        vector<int> next(m + 1);
        //é¢„å¤„ç†nextæ•°ç»„
        for(int i = 2, j = 0; i <= m; i++){
            while(j and p[i] != p[j + 1]) j = next[j];
            if(p[i] == p[j + 1]) j++;
            next[i] = j;
        }
        //åŒ¹é…è¿‡ç¨‹
        for(int i = 1, j = 0; i <= n; i++){
            while(j and s[i] != p[j + 1]) j = next[j];
            if(s[i] == p[j + 1]) j++;
            if(j == m) return i - m;
        }
        return -1;
    }
};
```
* æ—¶é—´å¤æ‚åº¦ï¼š`n` ä¸ºåŸä¸²çš„é•¿åº¦ï¼Œ`m` ä¸ºåŒ¹é…ä¸²çš„é•¿åº¦ã€‚å¤æ‚åº¦ä¸º $O(m + n)$ã€‚
* ç©ºé—´å¤æ‚åº¦ï¼šæ„å»ºäº† `next` æ•°ç»„ã€‚å¤æ‚åº¦ä¸º $O(m)$ã€‚

***

## æ€»ç»“

**KMP ç®—æ³•çš„åº”ç”¨èŒƒå›´è¦æ¯” Manacher ç®—æ³•å¹¿ï¼ŒManacher ç®—æ³•åªèƒ½åº”ç”¨äºã€Œå›æ–‡ä¸²ã€é—®é¢˜ï¼Œç›¸å¯¹æ¯”è¾ƒå±€é™ï¼Œè€Œã€Œå­ä¸²åŒ¹é…ã€é—®é¢˜è¿˜æ˜¯ååˆ†å¸¸è§çš„ã€‚**

**èƒŒè¿‡è¿™æ ·çš„ç®—æ³•çš„æ„ä¹‰åœ¨äºï¼šç›¸å½“äºå¤§è„‘é‡Œæœ‰äº†ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ çš„ api å¯ä»¥ä½¿ç”¨ï¼Œè¿™ä¸ª api ä¼ å…¥ä¸€ä¸ªåŸä¸²å’ŒåŒ¹é…ä¸²ï¼Œè¿”å›åŒ¹é…ä¸²åœ¨åŸä¸²çš„ä½ç½®ã€‚**

å› æ­¤ï¼Œä¸‰å¶ååˆ†å»ºè®®å¤§å®¶åœ¨ã€Œç†è§£ KMPã€çš„åŸºç¡€ä¸Šï¼Œå¯¹æ¨¡æ¿è¿›è¡ŒèƒŒè¿‡ ~ 


