## [1137.ç¬¬ N ä¸ªæ³°æ³¢é‚£å¥‘æ•° ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/n-th-tribonacci-number/solutions/100000/gong-shui-san-xie-yi-ti-si-jie-die-dai-d-m1ie)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)
> æ¬¢è¿å…³æ³¨æˆ‘ â¤ï¸ æä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡ä¸“é¡¹é¢˜è§£
æ›´æœ‰ã€Œé•¿æœŸé€å®ä½“ä¹¦ã€æ´»åŠ¨ç­‰ä½ æ¥ ğŸ‰ ğŸ‰ 

## è¿­ä»£å®ç°åŠ¨æ€è§„åˆ’

éƒ½ç›´æ¥ç»™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹äº†ï¼Œå…¶å®å°±æ˜¯é“æ¨¡æ‹Ÿé¢˜ã€‚

ä½¿ç”¨ä¸‰ä¸ªå˜é‡ï¼Œä»å‰å¾€åç®—ä¸€éå³å¯ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    public int tribonacci(int n) {
        if (n == 0) return 0;
        if (n == 1 || n == 2) return 1;
        int a = 0, b = 1, c = 1;
        for (int i = 3; i <= n; i++) {
            int d = a + b + c;
            a = b;
            b = c;
            c = d;
        }
        return c;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

---

## é€’å½’å®ç°åŠ¨æ€è§„åˆ’

ä¹Ÿå°±æ˜¯è®°å¿†åŒ–æœç´¢ï¼Œåˆ›å»ºä¸€ä¸ª `cache` æ•°ç»„ç”¨äºé˜²æ­¢é‡å¤è®¡ç®—ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    int[] cache = new int[40];
    public int tribonacci(int n) {
        if (n == 0) return 0;
        if (n == 1 || n == 2) return 1;
        if (cache[n] != 0) return cache[n];
        cache[n] = tribonacci(n - 1) + tribonacci(n - 2) + tribonacci(n - 3); 
        return cache[n];
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## çŸ©é˜µå¿«é€Ÿå¹‚

è¿™è¿˜æ˜¯ä¸€é“ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€çš„æ¿å­é¢˜ã€‚

é¦–å…ˆä½ è¦å¯¹ã€Œå¿«é€Ÿå¹‚ã€å’Œã€ŒçŸ©é˜µä¹˜æ³•ã€æ¦‚å¿µæœ‰æ‰€äº†è§£ã€‚

çŸ©é˜µå¿«é€Ÿå¹‚ç”¨äºæ±‚è§£ä¸€èˆ¬æ€§é—®é¢˜ï¼šç»™å®šå¤§å°ä¸º $n * n$ çš„çŸ©é˜µ $M$ï¼Œæ±‚ç­”æ¡ˆçŸ©é˜µ $M^k$ï¼Œå¹¶å¯¹ç­”æ¡ˆçŸ©é˜µä¸­çš„æ¯ä½å…ƒç´ å¯¹ $P$ å–æ¨¡ã€‚

åœ¨ä¸Šè¿°ä¸¤ç§è§£æ³•ä¸­ï¼Œå½“æˆ‘ä»¬è¦æ±‚è§£ $f[i]$ æ—¶ï¼Œéœ€è¦å°† $f[0]$ åˆ° $f[n - 1]$ éƒ½ç®—ä¸€éï¼Œå› æ­¤éœ€è¦çº¿æ€§çš„å¤æ‚åº¦ã€‚

å¯¹äºæ­¤ç±»çš„ã€Œæ•°åˆ—é€’æ¨ã€é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€æ¥è¿›è¡ŒåŠ é€Ÿï¼ˆæ¯”å¦‚è¦é€’å½’ä¸€ä¸ªé•¿åº¦ä¸º $1e9$ çš„æ•°åˆ—ï¼Œçº¿æ€§å¤æ‚åº¦ä¼šè¢«å¡ï¼‰ã€‚

ä½¿ç”¨çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œæˆ‘ä»¬åªéœ€è¦ $O(\log{n})$ çš„å¤æ‚åº¦ã€‚

æ ¹æ®é¢˜ç›®çš„é€’æ¨å…³ç³»ï¼ˆ$i >= 3$ï¼‰ï¼š

$$
f(i) = f(i - 1) + f(i - 2) + f(i - 3)
$$

æˆ‘ä»¬å‘ç°è¦æ±‚è§£ $f(i)$ï¼Œå…¶ä¾èµ–çš„æ˜¯ $f(i - 1)$ã€$f(i - 2)$ å’Œ $f(i - 3)$ã€‚

æˆ‘ä»¬å¯ä»¥å°†å…¶å­˜æˆä¸€ä¸ªåˆ—å‘é‡ï¼š

$$
\begin{bmatrix}
f(i - 1)\\ 
f(i - 2)\\ 
f(i - 3)
\end{bmatrix}
$$

å½“æˆ‘ä»¬æ•´ç†å‡ºä¾èµ–çš„åˆ—å‘é‡ä¹‹åï¼Œä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬æƒ³æ±‚çš„ $f(i)$ æ‰€åœ¨çš„åˆ—å‘é‡æ˜¯è¿™æ ·çš„ï¼š

$$
\begin{bmatrix}
f(i)\\ 
f(i - 1)\\ 
f(i - 2)
\end{bmatrix}
$$

åˆ©ç”¨é¢˜ç›®ç»™å®šçš„ä¾èµ–å…³ç³»ï¼Œå¯¹ç›®æ ‡çŸ©é˜µå…ƒç´ è¿›è¡Œå±•å¼€ï¼š

$$
\begin{bmatrix}
f(i)\\ 
f(i - 1)\\ 
f(i - 2)
\end{bmatrix} = \begin{bmatrix}
f(i - 1) * 1 + f(i - 2) * 1 + f(i - 3) * 1\\ 
f(i - 1) * 1 + f(i - 2) * 0 + f(i - 3) * 0\\ 
f(i - 1) * 0 + f(i - 2) * 1 + f(i - 3) * 0
\end{bmatrix}
$$

é‚£ä¹ˆæ ¹æ®çŸ©é˜µä¹˜æ³•ï¼Œå³æœ‰ï¼š

$$
\begin{bmatrix}
f(i)\\ 
f(i - 1)\\ 
f(i - 2)
\end{bmatrix} = \begin{bmatrix}
1 &1 &1 \\ 
1 &0 &0 \\ 
0 &1 &0 
\end{bmatrix} * \begin{bmatrix}
f(i - 1)\\ 
f(i - 2)\\ 
f(i - 3)
\end{bmatrix} 
$$

æˆ‘ä»¬ä»¤

$$
Mat = \begin{bmatrix}
1 &1 &1 \\ 
1 &0 &0 \\ 
0 &1 &0 
\end{bmatrix}
$$

ç„¶åå‘ç°ï¼Œåˆ©ç”¨ $Mat$ æˆ‘ä»¬ä¹Ÿèƒ½å®ç°æ•°åˆ—é€’æ¨ï¼ˆå…¬å¼å¤ªéš¾æ•²äº†ï¼Œéšä¾¿åˆ—ä¸¤é¡¹å§ï¼‰ï¼š

$$
Mat * \begin{bmatrix}
f(i - 1)\\ 
f(i - 2)\\ 
f(i - 3)
\end{bmatrix} = \begin{bmatrix}
f(i)\\ 
f(i - 1)\\ 
f(i - 2)
\end{bmatrix} 
$$

$$
Mat * \begin{bmatrix}
f(i )\\ 
f(i - 1)\\ 
f(i - 2)
\end{bmatrix} = \begin{bmatrix}
f(i + 1)\\ 
f(i)\\ 
f(i - 1)
\end{bmatrix} 
$$

å†æ ¹æ®çŸ©é˜µè¿ç®—çš„ç»“åˆå¾‹ï¼Œæœ€ç»ˆæœ‰ï¼š

$$
\begin{bmatrix}
f(n)\\ 
f(n - 1)\\ 
f(n - 2)
\end{bmatrix} = Mat^{n - 2} * \begin{bmatrix}
f(2)\\ 
f(1)\\ 
f(0)
\end{bmatrix}
$$

ä»è€Œå°†é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£ $Mat^{n - 2}$ ï¼Œè¿™æ—¶å€™å¯ä»¥å¥—ç”¨ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€è§£å†³æ–¹æ¡ˆã€‚

ä»£ç ï¼š
```Java []
class Solution {
    int N = 3;
    int[][] mul(int[][] a, int[][] b) {
        int[][] c = new int[N][N];
        for (int i = 0; i < N; i++) {
            for (int j = 0; j < N; j++) {
                c[i][j] = a[i][0] * b[0][j] + a[i][1] * b[1][j] + a[i][2] * b[2][j];
            }
        }
        return c;
    }
    public int tribonacci(int n) {
        if (n == 0) return 0;
        if (n == 1 || n == 2) return 1;
        int[][] ans = new int[][]{
            {1,0,0},
            {0,1,0},
            {0,0,1}
        };
        int[][] mat = new int[][]{
            {1,1,1},
            {1,0,0},
            {0,1,0}
        };
        int k = n - 2;
        while (k != 0) {
            if ((k & 1) != 0) ans = mul(ans, mat);
            mat = mul(mat, mat);
            k >>= 1;
        }
        return ans[0][0] + ans[0][1];
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

---

## æ‰“è¡¨

å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ•°æ®èŒƒå›´å†…çš„æ‰€æœ‰ç­”æ¡ˆè¿›è¡Œæ‰“è¡¨é¢„å¤„ç†ï¼Œç„¶ååœ¨è¯¢é—®æ—¶ç›´æ¥æŸ¥è¡¨è¿”å›ã€‚

ä½†å¯¹è¿™ç§é¢˜ç›®è¿›è¡Œæ‰“è¡¨å¸¦æ¥çš„æ”¶ç›Šæ²¡æœ‰å¹³å¸¸æ‰“è¡¨é¢˜çš„å¤§ï¼Œå› ä¸ºæ‰“è¡¨å†…å®¹ä¸æ˜¯ä½œä¸ºç®—æ³•å¿…é¡»çš„ä¸€ä¸ªç¯èŠ‚ï¼Œè€Œç›´æ¥æ˜¯ä½œä¸ºè¯¥è¯¢é—®çš„ç­”æ¡ˆï¼Œä½†æµ‹è¯•æ ·ä¾‹æ˜¯ä¸ä¼šç›¸åŒçš„ï¼Œå³ä¸ä¼šæœ‰ä¸¤ä¸ªæµ‹è¯•æ•°æ®éƒ½æ˜¯ $n = 37$ã€‚

è¿™æ—¶å€™æ‰“è¡¨èŠ‚çœçš„è®¡ç®—é‡æ˜¯ä¸åŒæµ‹è¯•æ•°æ®ä¹‹é—´çš„ç›¸åŒå‰ç¼€è®¡ç®—é‡ï¼Œä¾‹å¦‚ $n = 36$ å’Œ $n = 37$ï¼Œå…¶ $35$ ä¹‹å‰çš„è®¡ç®—é‡åªä¼šè¢«è®¡ç®—ä¸€æ¬¡ã€‚

å› æ­¤ç›´æ¥ä¸ºã€Œè§£æ³•äºŒã€çš„ `cache` æ·»åŠ  `static` ä¿®é¥°å…¶å®æ˜¯æ›´å¥½çš„æ–¹å¼ï¼šä»£ç æ›´çŸ­ï¼ŒåŒæ—¶ä¹Ÿèƒ½èµ·åˆ°åŒæ ·çš„èŠ‚çœè¿ç®—é‡çš„æ•ˆæœã€‚

> è€ƒè™‘åˆ°å¯èƒ½ä¼šæœ‰ä¸ç†Ÿ Java çš„åŒå­¦ï¼Œ`static` ä¿®é¥°çš„ä½œç”¨æ˜¯ã€Œåœ¨ `Solution` è¢«å®ä¾‹åŒ–å‰ï¼Œ`cache` å·²ç»è¢«è®¡ç®—å¥½ï¼Œå¹¶ä¸”åªä¼šè¢«è®¡ç®—ä¸€æ¬¡ã€ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    static int[] cache = new int[40];
    static {
        cache[0] = 0;
        cache[1] = 1;
        cache[2] = 1;
        for (int i = 3; i < cache.length; i++) {
            cache[i] = cache[i - 1] + cache[i - 2] + cache[i - 3];
        }
    }
    public int tribonacci(int n) {
        return cache[n];
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šå°†æ‰“è¡¨é€»è¾‘äº¤ç»™ $OJ$ï¼Œå¤æ‚åº¦ä¸º $O(C)$ï¼Œ$C$ å›ºå®šä¸º $40$ã€‚å°†æ‰“è¡¨é€»è¾‘æ”¾åˆ°æœ¬åœ°è¿›è¡Œï¼Œå¤æ‚åº¦ä¸º $O(1)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) å’Œ åŠ å…¥æˆ‘ä»¬çš„[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~