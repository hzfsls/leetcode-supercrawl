## [676.å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸ ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/implement-magic-dictionary/solutions/100000/by-ac_oier-a01l)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)
## Trie + DFS

ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä»¤ `dictionary` ä¸º `ss`ï¼Œä»¤ `searchWord` ä¸º `s`ã€‚

æ•´ä½“é¢˜æ„ï¼šç»™å®šå­—ç¬¦ä¸² `s`ï¼Œé—®èƒ½å¦å­˜åœ¨æ›¿æ¢æ‰ `s` ä¸­çš„æŸä¸ªå­—ç¬¦ï¼Œä½¿å¾—æ–°å­—ç¬¦ä¸²å‡ºç°åœ¨ `ss` æ•°ç»„ä¸­ã€‚

è€ƒè™‘å¦‚ä½•ä½¿ç”¨ã€Œå­—å…¸æ ‘/`Trie`ã€æ±‚è§£è¯¥é—®é¢˜ï¼š
*  `buildDict` æ“ä½œï¼šæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„ $ss[i]$ å­˜å…¥å­—å…¸æ ‘ä¸­ï¼Œæ–¹ä¾¿åç»­æ£€ç´¢ï¼›

* `search` æ“ä½œï¼šè®¾è®¡é€’å½’å‡½æ•° `boolean query(String s, int idx, int p, int limit)`ï¼Œå…¶ä¸­ `s` ä¸ºå¾…æ£€ç´¢çš„å­—ç¬¦ä¸²ï¼Œ`idx` ä¸ºå½“å‰å¤„ç†åˆ°å­—ç¬¦ä¸² `s` çš„å“ªä¸€ä½ï¼Œ`p` ä¸ºå½“å‰æœç´¢åˆ°å­—å…¸æ ‘çš„ç´¢å¼•ç¼–å·ï¼ˆèµ·å§‹æœ‰ $p = 0$ï¼‰ï¼Œ`limit` ä¸ºå½“å‰å‰©ä½™çš„æ›¿æ¢å­—ç¬¦æ¬¡æ•°ï¼Œæ ¹æ®é¢˜æ„ï¼Œ`limit` å›ºå®šä¸º $1$ï¼Œå«ä¹‰ä¸ºå¿…é¡»æ›¿æ¢æ‰ `s` çš„ä¸€ä¸ªå­—ç¬¦ã€‚
    å¯¹äº $s[idx]$ è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ–°å­—ç¬¦ä¸²åœ¨å½“å‰ä½ç½®æ˜¯ä½•ç§å­—ç¬¦ï¼ˆ$C = 26$ ä¸ªé€‰æ‹©ï¼‰ï¼Œè‹¥å½“å‰æšä¸¾åˆ°çš„å­—ç¬¦ä¸ $s[idx]$ ä¸€è‡´ï¼Œåˆ™ä¸æ¶ˆè€—æ›¿æ¢æ¬¡æ•°ã€‚
    çˆ†æœè¿‡ç¨‹ä¸­æ›¿æ¢æ¬¡æ•°ä¸ºè´Ÿæ•°ç›´æ¥å‰ªæï¼Œå½“çˆ†æœåˆ°ç»“å°¾ä½ç½®ï¼Œå†æ£€æŸ¥å½“å‰çš„å­—å…¸æ ‘ç´¢å¼• $p$ æ˜¯å¦ä¸ºå•è¯ç»“å°¾èŠ‚ç‚¹ï¼ˆå¯¹åº”æŸ¥è¯¢æ•°ç»„ `ss` ä¸­æ˜¯å¦å­˜åœ¨è¯¥å­—ç¬¦ä¸²ï¼‰ï¼Œä»¥åŠå‰©ä½™çš„æ›¿æ¢æ¬¡æ•° `limit` æ˜¯å¦ä¸º $0$ã€‚

> **ä¸äº†è§£ã€ŒTrie / å­—å…¸æ ‘ã€çš„åŒå­¦å¯ä»¥çœ‹å‰ç½® ğŸ§€ï¼š[å­—å…¸æ ‘å…¥é—¨](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247488490&idx=1&sn=db2998cb0e5f08684ee1b6009b974089)ã€‚é‡Œé¢é€šè¿‡å›¾ä¾‹å±•ç¤ºäº†å­—å…¸æ ‘åŸºæœ¬å½¢æ€ï¼Œä»¥åŠæä¾›äº†ã€Œæ•°ç»„å®ç°ã€å’Œã€ŒTrieNode å®ç°ã€ä¸¤ç§æ–¹å¼ï¼Œè¿˜æœ‰ã€Œæ•°ç»„å¤§å°ä¼°ç®—æ–¹å¼ã€å’Œã€ŒTrie åº”ç”¨é¢ã€ä»‹ç»**

ä»£ç ï¼š
```Java []
class MagicDictionary {
    int N = 100 * 100, M = 26, idx = 0;
    int[][] tr = new int[N][M];
    boolean[] isEnd = new boolean[N * M];
    void add(String s) {
        int p = 0;
        for (int i = 0; i < s.length(); i++) {
            int u = s.charAt(i) - 'a';
            if (tr[p][u] == 0) tr[p][u] = ++idx;
            p = tr[p][u];
        }
        isEnd[p] = true;
    }
    boolean query(String s, int idx, int p, int limit) {
        if (limit < 0) return false;
        if (idx == s.length()) return isEnd[p] && limit == 0;
        int u = s.charAt(idx) - 'a';
        for (int i = 0; i < 26; i++) {
            if (tr[p][i] == 0) continue;
            if (query(s, idx + 1, tr[p][i], i == u ? limit : limit - 1)) return true;
        }
        return false;
    }
    public void buildDict(String[] ss) {
        for (String s : ss) add(s);
    }
    public boolean search(String s) {
        return query(s, 0, 0, 1);
    }
}
```
```TypeScript []
class MagicDictionary {
    N: number = 100 * 100; M: number = 26; idx: number = 0;
    tr: number[][] = new Array<Array<number>>(this.N)
    isEnd: boolean[] = new Array<boolean>(this.N * this.M).fill(false)
    add(s: string): void {
        let p = 0
        for (let i = 0; i < s.length; i++) {
            const u = s.charCodeAt(i) - 'a'.charCodeAt(0)
            if (this.tr[p] == undefined) this.tr[p] = new Array<number>(this.M).fill(0)
            if (this.tr[p][u] == 0) this.tr[p][u] = ++this.idx
            p = this.tr[p][u]
        }
        this.isEnd[p] = true
    }
    query(s: string, idx: number, p: number, limit: number): boolean {
        if (limit < 0) return false
        if (idx == s.length) return this.isEnd[p] && limit == 0
        const u = s.charCodeAt(idx) - 'a'.charCodeAt(0)
        for (let i = 0; i < 26; i++) {
            if (this.tr[p] == undefined || this.tr[p][i] == 0) continue
            if (this.query(s, idx + 1, this.tr[p][i], i == u ? limit : limit - 1)) return true
        }
        return false
    }
    buildDict(ss: string[]): void {
        for (const s of ss) this.add(s)
    }
    search(s: string): boolean {
        return this.query(s, 0, 0, 1)
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š`buildDict` æ“ä½œéœ€è¦å°†æ‰€æœ‰å­—ç¬¦å­˜å…¥ `Trie`ï¼Œå¤æ‚åº¦ä¸º $\sum_{i = 0}^{n - 1} len(ss[i]])$ï¼›`search` æ“ä½œåœ¨ä¸è€ƒè™‘ `limit` ä»¥åŠå­—å…¸æ ‘ä¸­æœ€å¤šåªæœ‰ $100$ å…·ä½“æ–¹æ¡ˆæ‰€å¸¦æ¥çš„å‰ªææ•ˆæœçš„è¯ï¼Œæœ€åæƒ…å†µä¸‹è¦æœç´¢æ‰€æœ‰ $C^L$ ä¸ªæ–¹æ¡ˆï¼Œå…¶ä¸­ $C = 26$ ä¸ºå­—ç¬¦é›†å¤§å°ï¼Œ$L = 100$ ä¸ºæœç´¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦
* ç©ºé—´å¤æ‚åº¦ï¼š$O(N \times L \times C)$ï¼Œå…¶ä¸­ $N = 100$ ä¸ºå­˜å…¥ `Trie` çš„æœ€å¤§æ–¹æ¡ˆæ•°ï¼Œ$L = 100$ ä¸ºå­˜å…¥å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œ$C = 26$ ä¸ºå­—ç¬¦é›†å¤§å°

---

## æ¨¡æ‹Ÿ

å½“ç„¶ï¼Œåˆ©ç”¨æ•°æ®èŒƒå›´åªæœ‰ $100$ï¼Œç›´æ¥ä½¿ç”¨æ¨¡æ‹Ÿä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

ä»£ç ï¼š
```Java []
class MagicDictionary {
    String[] ss;
    public void buildDict(String[] _ss) {
        ss = _ss;
    }
    public boolean search(String str) {
        for (String s : ss) {
            int cnt = 0;
            for (int i = 0; s.length() == str.length() && i < s.length() && cnt <= 1; i++) {
                if (s.charAt(i) != str.charAt(i)) cnt++;
            }
            if (cnt == 1) return true;
        }
        return false;
    }
}
```
```TypeScript []
class MagicDictionary {
    ss: string[]
    buildDict(_ss: string[]): void {
        this.ss = _ss
    }
    search(s: string): boolean {
        for (const str of this.ss) {
            let cnt = 0
            for (let i = 0; str.length == s.length && i < s.length && cnt <= 1; i++) {
                if (s.charAt(i) != str.charAt(i)) cnt++
            }
            if (cnt == 1) return true
        }
        return false
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š`buildDict` æ“ä½œå¤æ‚åº¦ä¸º $O(1)$ï¼›`search` æ“ä½œå¤æ‚åº¦ä¸º $O(n \times L)$ï¼Œå…¶ä¸­ $n$ ä¸ºæ•°ç»„ `ss` çš„é•¿åº¦ï¼Œ$L$ ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²çš„é•¿åº¦
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## åŠ é¤

1. å‰ç½®ç»ƒä¹ é¢˜ [å¯ç”¨ Trie è¿›é˜¶çš„æ¨¡æ‹Ÿé¢˜](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247492214&idx=1&sn=40fa070fe3b014873297f7ff740ba60f)

2. å¦å¤–ä¸€é“ [ç»“åˆ DFS çš„ Trie è¿ç”¨é¢˜](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247492188&idx=1&sn=a1436d1ffe2b8200a36c3196ca1c7ed1)

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) å’Œ åŠ å…¥æˆ‘ä»¬çš„[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~
