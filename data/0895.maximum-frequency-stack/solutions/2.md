## [895.æœ€å¤§é¢‘ç‡æ ˆ ä¸­æ–‡çƒ­é—¨é¢˜è§£2](https://leetcode.cn/problems/maximum-frequency-stack/solutions/100000/by-ac_oier-tquk)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)

## å“ˆå¸Œè¡¨

è¿™æ˜¯ä¸€é“å¾ˆçº¯çš„å“ˆå¸Œè¡¨é¢˜å„¿ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å®¹æ˜“æƒ³åˆ°å»ºç«‹ **ç¬¬ä¸€ä¸ªå“ˆå¸Œè¡¨ `cnts` ç”¨äºè®°å½•æŸä¸ªæ•°å€¼çš„å‡ºç°æ¬¡æ•°ï¼Œ`cnts[val] = c` å«ä¹‰ä¸ºæ•°å€¼ `val` å½“å‰åœ¨æ ˆä¸­çš„å‡ºç°æ¬¡æ•°ä¸º `c`ã€‚æˆ‘ä»¬ç§°è¯¥å“ˆå¸Œè¡¨ä¸ºã€Œè®¡æ•°å“ˆå¸Œè¡¨ã€**ã€‚

å†ç»“åˆæ¯æ¬¡ `pop` éœ€è¦è¿”å›ã€Œé¢‘ç‡æœ€å¤§çš„å…ƒç´ ï¼Œè‹¥æœ‰å¤šä¸ªåˆ™è¿”å›æœ€è€ƒè™‘æ ˆé¡¶çš„ä¸€ä¸ªã€çš„è¦æ±‚ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ **å»ºç«‹ç¬¬äºŒä¸ªå“ˆå¸Œ `map`ï¼Œè¯¥å“ˆå¸Œè¡¨ä»¥ã€Œå‡ºç°æ¬¡æ•° `c`ã€ä¸ºé”®ï¼Œä»¥ã€Œå‡ºç°æ¬¡æ•°å‡ä¸º `c` çš„å…ƒç´ åºåˆ—ã€ä¸ºå€¼ï¼Œ`map[c] = A = [...]` å«ä¹‰ä¸ºå‡ºç°æ¬¡æ•°ä¸º `c` çš„åºåˆ—ä¸º `A`ï¼Œå¹¶ä¸”åºåˆ— `A` ä¸­çš„ç»“å°¾å…ƒç´ ä¸ºå‡ºç°æ¬¡æ•°ä¸º `c` çš„æ‰€æœ‰å…ƒç´ ä¸­æœ€é è¿‘æ ˆé¡¶çš„å…ƒç´ ã€‚æˆ‘ä»¬ç§°è¯¥å“ˆå¸Œè¡¨ä¸ºã€Œåˆ†æ¡¶å“ˆå¸Œè¡¨ã€**ã€‚

æœ€åå†é¢å¤–ä½¿ç”¨ä¸€ä¸ªå˜é‡ `max` è®°å½•å½“å‰æœ€å¤§å‡ºç°é¢‘æ•°ï¼Œä¸éš¾å‘ç°ï¼Œ`max` å¿…ç„¶æ˜¯ä»¥æ­¥é•¿ $\pm 1$ è¿›è¡Œå˜åŒ–ï¼ˆå½“å‡ºç°æ¬¡æ•°ä¸º `max` çš„å…ƒç´ è¢« `pop` æ‰äº†ä¸€ä¸ªåï¼Œå¿…ç„¶å‰©ä¸‹ `max - 1` ä¸ªï¼‰ï¼Œå› æ­¤å½“æˆ‘ä»¬åœ¨æŸæ¬¡ `pop` æ“ä½œåå‘ç°å‡ºç°æ¬¡æ•°ä¸º `max` çš„é›†åˆä¸ºç©ºæ—¶ï¼Œå¯¹ `max` è¿›è¡Œè‡ªå‡æ“ä½œå³å¯ã€‚

å°†é¢˜ç›®ç»™çš„æ ·ä¾‹ä½œä¸º ğŸŒ° ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹ `cnts`ã€`map` å’Œ `max` ä¸‰è€…å¦‚ä½•å˜åŒ–ï¼Œä»¥åŠ `pop` çš„æ›´æ–°é€»è¾‘ï¼š

![image.png](https://pic.leetcode.cn/1669771856-XhpLSw-image.png)

ä»£ç ï¼š
```Java []
class FreqStack {
    Map<Integer, List<Integer>> map = new HashMap<>();
    Map<Integer, Integer> cnts = new HashMap<>();
    int max;
    public void push(int val) {
        cnts.put(val, cnts.getOrDefault(val, 0) + 1);
        int c = cnts.get(val);
        List<Integer> list = map.getOrDefault(c, new ArrayList<>());
        list.add(val);
        map.put(c, list);
        max = Math.max(max, c);
    }
    public int pop() {
        List<Integer> list = map.get(max);
        int ans = list.remove(list.size() - 1);
        cnts.put(ans, cnts.get(ans) - 1);
        if (list.size() == 0) max--;
        return ans;
    }
}
```
```TypeScript []
class FreqStack {
    map: Map<number, Array<number>> = new Map<number, Array<number>>()
    cnst: Map<number, number> = new Map<number, number>()
    max: number = 0
    push(val: number): void {
        if (!this.cnst.has(val)) this.cnst.set(val, 0)
        this.cnst.set(val, this.cnst.get(val) + 1)
        const c = this.cnst.get(val)
        if (!this.map.has(c)) this.map.set(c, new Array<number>())
        this.map.get(c).push(val)
        this.max = Math.max(this.max, c)
    }
    pop(): number {
        const ans = this.map.get(this.max).pop()
        if (this.map.get(this.max).length == 0) this.max--
        this.cnst.set(ans, this.cnst.get(ans) - 1)
        return ans
    }
}
```
```Python []
class FreqStack:
    def __init__(self):
        self.cnts = defaultdict(int)
        self.map = defaultdict(list)
        self.mv = 0

    def push(self, val: int) -> None:
        self.cnts[val] += 1
        c = self.cnts[val]
        self.map[c].append(val)
        self.mv = max(self.mv, c)

    def pop(self) -> int:
        ans = self.map[self.mv].pop()
        self.cnts[ans] -= 1
        self.mv -= 0 if self.map[self.mv] else 1
        return ans
```
* æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰æ“ä½œå‡ä¸º $O(1)$
* ç©ºé—´å¤æ‚åº¦ï¼šæ‰€æœ‰å…¥æ ˆçš„èŠ‚ç‚¹æœ€å¤šä¼šè¢«å­˜å‚¨ä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨è®¡æ•°å“ˆå¸Œè¡¨ä¸­ï¼Œä¸€æ¬¡åœ¨åˆ†æ¡¶å“ˆå¸Œè¡¨ä¸­ï¼Œå¤æ‚åº¦ä¸º $O(n)$

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://acoier.com/oimg/gzh-qrcode.webp)ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~