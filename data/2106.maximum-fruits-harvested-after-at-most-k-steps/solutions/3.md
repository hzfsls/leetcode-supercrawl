## [2106.æ‘˜æ°´æœ ä¸­æ–‡çƒ­é—¨é¢˜è§£3](https://leetcode.cn/problems/maximum-fruits-harvested-after-at-most-k-steps/solutions/100000/python3javacgotypescript-yi-ti-yi-jie-sh-59o2)

ä½œè€…ï¼š[lcbin](https://leetcode.cn/u/lcbin)


**æ–¹æ³•ä¸€ï¼šåŒæŒ‡é’ˆ**

æˆ‘ä»¬ä¸å¦¨å‡è®¾ç§»åŠ¨çš„ä½ç½®åŒºé—´ä¸º $[l,r]$ï¼Œå¼€å§‹ä½ç½®ä¸º $startPos$ï¼Œæ¥çœ‹çœ‹å¦‚ä½•ç®—å‡ºç§»åŠ¨çš„æœ€å°æ­¥æ•°ã€‚æ ¹æ® $startPos$ æ‰€å¤„çš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š

1. å¦‚æœ $startPos \leq l$ï¼Œé‚£ä¹ˆå°±æ˜¯ä» $startPos$ å‘å³ç§»åŠ¨åˆ° $r$ã€‚ç§»åŠ¨çš„æœ€å°æ­¥æ•°ä¸º $r - startPos$ï¼›
2. å¦‚æœ $startPos \geq r$ï¼Œé‚£ä¹ˆå°±æ˜¯ä» $startPos$ å‘å·¦ç§»åŠ¨åˆ° $l$ã€‚ç§»åŠ¨çš„æœ€å°æ­¥æ•°ä¸º $startPos - l$ï¼›
3. å¦‚æœ $l \lt startPos \lt r$ï¼Œé‚£ä¹ˆå¯ä»¥ä» $startPos$ å‘å·¦ç§»åŠ¨åˆ° $l$ï¼Œå†å‘å³ç§»åŠ¨åˆ° $r$ï¼›ä¹Ÿå¯ä»¥ä» $startPos$ å‘å³ç§»åŠ¨åˆ° $r$ï¼Œå†å‘å·¦ç§»åŠ¨åˆ° $l$ã€‚ç§»åŠ¨çš„æœ€å°æ­¥æ•°ä¸º $r - l + \min(\lvert startPos - l \rvert, \lvert r - startPos \rvert)$ã€‚

ä»¥ä¸Šä¸‰ç§æƒ…å†µå¯ä»¥ç»Ÿä¸€ç”¨å¼å­ $r - l + \min(\lvert startPos - l \rvert, \lvert r - startPos \rvert)$ è¡¨ç¤ºã€‚

å‡è®¾æˆ‘ä»¬å›ºå®šåŒºé—´å³ç«¯ç‚¹ $r$ï¼Œå‘å³ç§»åŠ¨å·¦ç«¯ç‚¹ $l$ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœ€å°ç§»åŠ¨æ­¥æ•°æ˜¯æ€ä¹ˆå˜åŒ–çš„ã€‚

1. å¦‚æœ $startPos \leq l$ï¼Œéšç€ $l$ çš„å¢å¤§ï¼Œæœ€å°æ­¥æ•°ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚
2. å¦‚æœ $startPos \gt l$ï¼Œéšç€ $l$ çš„å¢å¤§ï¼Œæœ€å°æ­¥æ•°ä¼šå‡å°ã€‚

å› æ­¤ï¼Œéšç€ $l$ çš„å¢å¤§ï¼Œæœ€å°ç§»åŠ¨æ­¥æ•°ä¸€å®šæ˜¯éä¸¥æ ¼å•è°ƒé€’å‡çš„ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆçš„æ–¹æ³•ï¼Œæ‰¾å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æœ€å¤§åŒºé—´ï¼Œç„¶åå–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„åŒºé—´ä¸­æ°´æœæ€»æ•°æœ€å¤§çš„ä¸€ä¸ªä½œä¸ºç­”æ¡ˆã€‚

å…·ä½“åœ°ï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªæŒ‡é’ˆ $i$ å’Œ $j$ åˆ†åˆ«æŒ‡å‘åŒºé—´çš„å·¦å³ä¸‹æ ‡ï¼Œåˆå§‹æ—¶ $i = j = 0$ã€‚å¦å¤–ç”¨ä¸€ä¸ªå˜é‡ $s$ è®°å½•åŒºé—´å†…çš„æ°´æœæ€»æ•°ï¼Œåˆå§‹æ—¶ $s = 0$ã€‚

æ¯æ¬¡æˆ‘ä»¬å°† $j$ åŠ å…¥åŒºé—´ä¸­ï¼Œç„¶åæ›´æ–° $s = s + fruits[j][1]$ã€‚å¦‚æœæ­¤æ—¶åŒºé—´å†…çš„æœ€å°æ­¥æ•° $fruits[j][0] - fruits[i][0] + \min(\lvert startPos - fruits[i][0] \rvert, \lvert startPos - fruits[j][0] \rvert)$ å¤§äº $k$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°† $i$ å¾ªç¯å‘å³ç§»åŠ¨ï¼Œç›´åˆ° $i \gt j$ æˆ–è€…åŒºé—´å†…çš„æœ€å°æ­¥æ•°å°äºç­‰äº $k$ã€‚æ­¤æ—¶æˆ‘ä»¬æ›´æ–°ç­”æ¡ˆ $ans = \max(ans, s)$ã€‚ç»§ç»­ç§»åŠ¨ $j$ï¼Œç›´åˆ° $j$ åˆ°è¾¾æ•°ç»„æœ«å°¾ã€‚

æœ€åè¿”å›ç­”æ¡ˆå³å¯ã€‚




```python [sol1-Python3]
class Solution:
    def maxTotalFruits(self, fruits: List[List[int]], startPos: int, k: int) -> int:
        ans = i = s = 0
        for j, (pj, fj) in enumerate(fruits):
            s += fj
            while i <= j and pj - fruits[i][0] + min(abs(startPos - fruits[i][0]), abs(startPos - fruits[j][0])) > k:
                s -= fruits[i][1]
                i += 1
            ans = max(ans, s)
        return ans
```


```java [sol1-Java]
class Solution {
    public int maxTotalFruits(int[][] fruits, int startPos, int k) {
        int ans = 0, s = 0;
        for (int i = 0, j = 0; j < fruits.length; ++j) {
            int pj = fruits[j][0], fj = fruits[j][1];
            s += fj;
            while (i <= j && pj - fruits[i][0] + Math.min(Math.abs(startPos - fruits[i][0]), Math.abs(startPos - pj)) > k) {
                s -= fruits[i++][1];
            }
            ans = Math.max(ans, s);
        }
        return ans;
    }
}
```



```cpp [sol1-C++]
class Solution {
public:
    int maxTotalFruits(vector<vector<int>>& fruits, int startPos, int k) {
        int ans = 0, s = 0;
        for (int i = 0, j = 0; j < fruits.size(); ++j) {
            int pj = fruits[j][0], fj = fruits[j][1];
            s += fj;
            while (i <= j && pj - fruits[i][0] + min(abs(startPos - fruits[i][0]), abs(startPos - pj)) > k) {
                s -= fruits[i++][1];
            }
            ans = max(ans, s);
        }
        return ans;
    }
};
```


```go [sol1-Go]
func maxTotalFruits(fruits [][]int, startPos int, k int) (ans int) {
	var s, i int
	for j, f := range fruits {
		s += f[1]
		for i <= j && f[0]-fruits[i][0]+min(abs(startPos-fruits[i][0]), abs(startPos-f[0])) > k {
			s -= fruits[i][1]
			i += 1
		}
		ans = max(ans, s)
	}
	return
}

func max(a, b int) int {
	if a > b {
		return a
	}
	return b
}

func min(a, b int) int {
	if a < b {
		return a
	}
	return b
}

func abs(x int) int {
	if x < 0 {
		return -x
	}
	return x
}
```



```ts [sol1-TypeScript]
function maxTotalFruits(fruits: number[][], startPos: number, k: number): number {
    let ans = 0;
    let s = 0;
    for (let i = 0, j = 0; j < fruits.length; ++j) {
        const [pj, fj] = fruits[j];
        s += fj;
        while (i <= j && pj - fruits[i][0] + Math.min(Math.abs(startPos - fruits[i][0]), Math.abs(startPos - pj)) > k) {
            s -= fruits[i++][1];
        }
        ans = Math.max(ans, s);
    }
    return ans;
}
```

æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚ç©ºé—´å¤æ‚åº¦ $O(1)$ã€‚


---

æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµï¼Œæ¬¢è¿è¯„è®ºåŒºæä¾›å…¶å®ƒè§£é¢˜æ€è·¯ï¼ˆä»£ç ï¼‰ï¼Œä¹Ÿå¯ä»¥ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ä½œè€…å“ˆğŸ˜„~