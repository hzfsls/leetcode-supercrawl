## [460.LFU ç¼“å­˜ ä¸­æ–‡çƒ­é—¨é¢˜è§£2](https://leetcode.cn/problems/lfu-cache/solutions/100000/chao-xiang-xi-tu-jie-dong-tu-yan-shi-460-lfuhuan-c)

ä½œè€…ï¼š[wang_ni_ma](https://leetcode.cn/u/wang_ni_ma)
## LFUå®ç°è¯¦è§£
ç¼“å­˜çš„å¤§å°éƒ½æ˜¯æœ‰é™çš„ï¼Œå½“ç¼“å­˜æ»¡æ—¶æœ‰æ–°å…ƒç´ éœ€è¦æ·»åŠ ï¼Œå°±éœ€è¦ä¸€ç§æ–¹å¼ä»ç¼“å­˜ä¸­åˆ é™¤ä¸€äº›å…ƒç´ ï¼Œåˆ é™¤çš„ç­–ç•¥å°±æ˜¯ç¼“å­˜çš„æ·˜æ±°ç®—æ³•ã€‚ 
LFUæœ‰ä¸ªå…„å¼ŸLRUï¼Œä»–ä»¬ä¸¤éƒ½æ˜¯å¸¸ç”¨çš„ç¼“å­˜æ·˜æ±°ç®—æ³•ã€‚   
  
**LRU(Least Recently Used)** æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ï¼Œå®ƒæ˜¯æ ¹æ®**æ—¶é—´**ç»´åº¦æ¥é€‰æ‹©å°†è¦æ·˜æ±°çš„å…ƒç´ ï¼Œå³åˆ é™¤æ‰æœ€é•¿æ—¶é—´æ²¡è¢«è®¿é—®çš„å…ƒç´ ã€‚   
**LFU(Least Frequently Used)** æœ€è¿‘æœ€ä¸å¸¸ç”¨ç®—æ³•ï¼Œå®ƒæ˜¯æ ¹æ®**é¢‘ç‡**ç»´åº¦æ¥é€‰æ‹©å°†è¦æ·˜æ±°çš„å…ƒç´ ï¼Œå³åˆ é™¤è®¿é—®é¢‘ç‡æœ€ä½çš„å…ƒç´ ã€‚å¦‚æœä¸¤ä¸ªå…ƒç´ çš„è®¿é—®é¢‘ç‡ç›¸åŒï¼Œåˆ™æ·˜æ±°æœ€ä¹…æ²¡è¢«è®¿é—®çš„å…ƒç´ ã€‚  
ä¹Ÿå°±æ˜¯è¯´LFUæ·˜æ±°çš„æ—¶å€™ä¼šé€‰æ‹©ä¸¤ä¸ªç»´åº¦ï¼Œå…ˆæ¯”è¾ƒé¢‘ç‡ï¼Œé€‰æ‹©è®¿é—®é¢‘ç‡æœ€å°çš„å…ƒç´ ï¼›å¦‚æœé¢‘ç‡ç›¸åŒï¼Œåˆ™æŒ‰æ—¶é—´ç»´åº¦æ·˜æ±°æ‰æœ€ä¹…è¿œçš„é‚£ä¸ªå…ƒç´ ã€‚   
    
     
LRUçš„å®ç°æ˜¯**ä¸€ä¸ªå“ˆå¸Œè¡¨**åŠ ä¸Š**ä¸€ä¸ªåŒé“¾è¡¨**   
è€ŒLFUåˆ™è¦å¤æ‚å¤šäº†ï¼Œéœ€è¦ç”¨**ä¸¤ä¸ªå“ˆå¸Œè¡¨**å†åŠ ä¸Š**Nä¸ªåŒé“¾è¡¨**æ‰èƒ½å®ç°   
æˆ‘ä»¬å…ˆçœ‹çœ‹LFUçš„ä¸¤ä¸ªå“ˆå¸Œè¡¨é‡Œé¢éƒ½å­˜äº†ä»€ä¹ˆ   
   
ç¬¬ä¸€ä¸ªå“ˆå¸Œè¡¨æ˜¯key-valueçš„å“ˆå¸Œè¡¨(ä»¥ä¸‹ç®€ç§°kvå“ˆå¸Œè¡¨)   
![1.jpg](https://pic.leetcode-cn.com/c91b3444d84a5b175414b6cc66dc9d6ce357dfec636b917871fd48125bc5a0e1-1.jpg)
è¿™é‡Œçš„keyå°±æ˜¯è¾“å…¥çš„keyï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚å…³é”®æ˜¯valueï¼Œå®ƒçš„valueä¸æ˜¯ä¸€ä¸ªç®€å•çš„valueï¼Œè€Œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ã€‚   
èŠ‚ç‚¹å¯¹è±¡NodeåŒ…å«äº†keyï¼Œvalueï¼Œä»¥åŠé¢‘ç‡ï¼Œè¿™ä¸ªNodeåˆä¼šå‡ºç°åœ¨ç¬¬äºŒä¸ªå“ˆå¸Œè¡¨çš„valueä¸­ã€‚   
è‡³äºä¸ºä»€ä¹ˆNodeä¸­åˆé‡å¤åŒ…å«äº†keyï¼Œå› ä¸ºæŸäº›æƒ…å†µä¸‹æˆ‘ä»¬ä¸æ˜¯é€šè¿‡k-vå“ˆå¸Œè¡¨æ‹¿åˆ°Nodeçš„ï¼Œè€Œæ˜¯é€šè¿‡å…¶ä»–æ–¹å¼è·å¾—äº†Nodeï¼Œä¹‹åéœ€è¦ç”¨Nodeä¸­çš„keyå»k-vå“ˆå¸Œè¡¨ä¸­åšä¸€äº›æ“ä½œï¼Œæ‰€ä»¥Nodeä¸­åŒ…å«äº†ä¸€äº›å†—ä½™ä¿¡æ¯ã€‚   
      
   
ç¬¬äºŒå¼ å“ˆå¸Œè¡¨ï¼Œé¢‘ç‡å“ˆå¸Œè¡¨ï¼Œè¿™ä¸ªå°±è¦å¤æ‚å¤šäº†   
![2.jpg](https://pic.leetcode-cn.com/6295cf4a8078096ba9b049e17a6bf8b6be3079edbc8111363a3b3727cf37173e-2.jpg)
è¿™å¼ å“ˆå¸Œè¡¨ä¸­çš„keyæ˜¯é¢‘ç‡ï¼Œä¹Ÿå°±æ˜¯å…ƒç´ è¢«è®¿é—®çš„é¢‘ç‡(è¢«è®¿é—®äº†1æ¬¡ï¼Œè¢«è®¿é—®äº†ä¸¤æ¬¡ç­‰ç­‰)ï¼Œå®ƒçš„valueæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨   
åˆšæ‰è¯´çš„Nodeå¯¹è±¡ï¼Œç°åœ¨åˆå‡ºç°äº†ï¼Œè¿™é‡Œçš„Nodeå…¶å®æ˜¯åŒå‘é“¾è¡¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚   
ç¬¬ä¸€å¼ å›¾ä¸­æˆ‘ä»¬ä»‹ç»äº†Nodeä¸­åŒ…å«äº†ä¸€ä¸ªå†—ä½™çš„keyï¼Œå…¶å®å®ƒè¿˜åŒ…å«äº†ä¸€ä¸ªå†—ä½™çš„é¢‘ç‡å€¼ï¼Œå› ä¸ºæŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡Nodeä¸­çš„é¢‘ç‡å€¼ï¼Œå»é¢‘ç‡å“ˆå¸Œè¡¨ä¸­åšæŸ¥æ‰¾ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦ä¸€ä¸ªå†—ä½™çš„é¢‘ç‡å€¼ã€‚   
   
ä¸‹é¢æˆ‘ä»¬å°†ä¸¤ä¸ªå“ˆå¸Œè¡¨æ•´åˆèµ·æ¥çœ‹çœ‹å®Œæ•´çš„ç»“æ„:   
![3.jpg](https://pic.leetcode-cn.com/bb3811c03de13fc8548a01c9ab094f5ed38d7ef9b5f5c6ef82340e222750ae92-3.jpg)
k-vå“ˆå¸Œè¡¨ä¸­key1æŒ‡å‘ä¸€ä¸ªNodeï¼Œè¿™ä¸ªNodeçš„é¢‘ç‡ä¸º1ï¼Œä½äºé¢‘ç‡å“ˆå¸Œè¡¨ä¸­key=1ä¸‹é¢çš„åŒé“¾è¡¨ä¸­(å¤„äºç¬¬ä¸€ä¸ªèŠ‚ç‚¹)ã€‚   

## å…·ä½“æ“ä½œ   
ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“æ“ä½œï¼Œgetæ“ä½œç›¸å¯¹ç®€å•ä¸€äº›ï¼Œæˆ‘ä»¬å°±å…ˆè¯´getæ“ä½œå§ã€‚   
**get**æ“ä½œçš„å…·ä½“é€»è¾‘å¤§è‡´æ˜¯è¿™æ ·ï¼š     
- å¦‚æœkeyä¸å­˜åœ¨åˆ™è¿”å›-1
- å¦‚æœkeyå­˜åœ¨ï¼Œåˆ™è¿”å›å¯¹åº”çš„valueï¼ŒåŒæ—¶:
   - å°†å…ƒç´ çš„è®¿é—®é¢‘ç‡+1
     - å°†å…ƒç´ ä»è®¿é—®é¢‘ç‡```i```çš„é“¾è¡¨ä¸­ç§»é™¤ï¼Œæ”¾åˆ°é¢‘ç‡```i+1```çš„é“¾è¡¨ä¸­ 
     - å¦‚æœé¢‘ç‡```i```çš„é“¾è¡¨ä¸ºç©ºï¼Œåˆ™ä»é¢‘ç‡å“ˆå¸Œè¡¨ä¸­ç§»é™¤è¿™ä¸ªé“¾è¡¨   
   
   
ç¬¬ä¸€ä¸ªå¾ˆç®€å•å°±ä¸ç”¨è¯´äº†ï¼Œæˆ‘ä»¬çœ‹ä¸‹ç¬¬äºŒç‚¹çš„æ‰§è¡Œè¿‡ç¨‹   
![4.gif](https://pic.leetcode-cn.com/00ec8b79c1ada23bb3910f81d688468cd0cc5179f85f9c266a5c76e827c3cdd6-4.gif)

å‡è®¾æŸä¸ªå…ƒç´ çš„è®¿é—®é¢‘ç‡æ˜¯3ï¼Œç°åœ¨åˆè¢«è®¿é—®äº†ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±éœ€è¦å°†è¿™ä¸ªå…ƒç´ ç§»åŠ¨åˆ°é¢‘ç‡4çš„é“¾è¡¨ä¸­ã€‚å¦‚æœè¿™ä¸ªå…ƒç´ è¢«ç§»é™¤åï¼Œé¢‘ç‡3çš„é‚£ä¸ªé“¾è¡¨å˜æˆç©ºäº†(åªå‰©ä¸‹å¤´ç»“ç‚¹å’Œå°¾èŠ‚ç‚¹)å°±éœ€è¦åˆ é™¤è¿™ä¸ªé“¾è¡¨ï¼ŒåŒæ—¶åˆ é™¤å¯¹åº”çš„é¢‘ç‡(ä¹Ÿå°±æ˜¯åˆ é™¤key=3)   
![5.gif](https://pic.leetcode-cn.com/d652bc2345cf6b0ad980c8d7dae2c905b926a23e85fcd1c7270751786a353019-5.gif)


putæ“ä½œå°±è¦å¤æ‚å¤šäº†ï¼Œå¤§è‡´åŒ…æ‹¬ä¸‹é¢å‡ ç§æƒ…å†µ   
- å¦‚æœkeyå·²ç»å­˜åœ¨ï¼Œä¿®æ”¹å¯¹åº”çš„valueï¼Œå¹¶å°†è®¿é—®é¢‘ç‡+1
  - å°†å…ƒç´ ä»è®¿é—®é¢‘ç‡```i```çš„é“¾è¡¨ä¸­ç§»é™¤ï¼Œæ”¾åˆ°é¢‘ç‡```i+1```çš„é“¾è¡¨ä¸­ 
  - å¦‚æœé¢‘ç‡```i```çš„é“¾è¡¨ä¸ºç©ºï¼Œåˆ™ä»é¢‘ç‡å“ˆå¸Œè¡¨ä¸­ç§»é™¤è¿™ä¸ªé“¾è¡¨ 
- å¦‚æœkeyä¸å­˜åœ¨
  - ç¼“å­˜è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œåˆ™å…ˆåˆ é™¤è®¿é—®é¢‘ç‡æœ€ä½çš„å…ƒç´ ï¼Œå†æ’å…¥æ–°å…ƒç´ 
    - æ–°å…ƒç´ çš„è®¿é—®é¢‘ç‡ä¸º1ï¼Œå¦‚æœé¢‘ç‡å“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨å¯¹åº”çš„é“¾è¡¨éœ€è¦åˆ›å»º
  - ç¼“å­˜æ²¡æœ‰è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œåˆ™æ’å…¥æ–°å…ƒç´ 
    - æ–°å…ƒç´ çš„è®¿é—®é¢‘ç‡ä¸º1ï¼Œå¦‚æœé¢‘ç‡å“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨å¯¹åº”çš„é“¾è¡¨éœ€è¦åˆ›å»º

æˆ‘ä»¬åœ¨ä»£ç å®ç°ä¸­è¿˜éœ€è¦ç»´æŠ¤ä¸€ä¸ª```minFreq```çš„å˜é‡ï¼Œç”¨æ¥è®°å½•LFUç¼“å­˜ä¸­é¢‘ç‡æœ€å°çš„å…ƒç´ ï¼Œåœ¨ç¼“å­˜æ»¡çš„æ—¶å€™ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°æœ€å°é¢‘ç¹çš„é“¾è¡¨ï¼Œä»¥è¾¾åˆ° **O(1)** æ—¶é—´å¤æ‚åº¦åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚
å…·ä½“åšæ³•æ˜¯:
- æ›´æ–°/æŸ¥æ‰¾çš„æ—¶å€™ï¼Œå°†å…ƒç´ é¢‘ç‡+1ï¼Œä¹‹åå¦‚æœ```minFreq```ä¸åœ¨é¢‘ç‡å“ˆå¸Œè¡¨ä¸­äº†ï¼Œè¯´æ˜é¢‘ç‡å“ˆå¸Œè¡¨ä¸­å·²ç»æ²¡æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆminFreqéœ€è¦+1ï¼Œå¦åˆ™```minFreq```ä¸å˜ã€‚
- æ’å…¥çš„æ—¶å€™ï¼Œè¿™ä¸ªç®€å•ï¼Œå› ä¸ºæ–°å…ƒç´ çš„é¢‘ç‡éƒ½æ˜¯1ï¼Œæ‰€ä»¥åªéœ€è¦å°†minFreqæ”¹ä¸º1å³å¯ã€‚

æˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹ç¼“å­˜è¶…è¿‡æœ€å¤§å®¹é‡æ—¶æ˜¯æ€ä¹ˆå¤„ç†çš„      
![6.gif](https://pic.leetcode-cn.com/f9cbf292271ab715f5dab1f08bb0bab834fae7d24d26cc675ee0cc4fdb2f18c7-6.gif)





## ä»£ç éƒ¨åˆ†
ä»£ç éƒ¨åˆ†æ¯”è¾ƒé•¿ï¼Œæˆ‘å¯¹ä»£ç åŠ äº†å¾ˆå¤šæ³¨é‡Šï¼Œä¹Ÿåšäº†ä¸€äº›ç®€å•çš„å°è£…ã€‚
è¿™é‡Œè‡ªå®šä¹‰äº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå¢åŠ äº†ä¸€äº›è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œå°±å½“æ˜¯å¤ä¹ ä¸‹åŒé“¾è¡¨å§ã€‚


```java []
import java.util.HashMap;
import java.util.Map;

/**
 *    è‡ªå®šä¹‰çš„LFUç¼“å­˜ç±» 
 */
public class LFUCache {
    /**
     *    åŒé“¾è¡¨ä¸­çš„é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡
    */
    protected static class Node{
        //å¯¹åº”è¾“å…¥çš„key
        private final int key;
		
        //å¯¹åº”è¾“å…¥çš„value
        private int value;
		
        //è¢«è®¿é—®çš„é¢‘ç‡
        private int freq;
		
        //æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
        protected Node pre;
		
        //æŒ‡å‘åä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
        protected Node next;
		
        public Node(int key, int value, int freq) {
            this.key = key;
            this.value = value;
            this.freq = freq;
        }
		
        public Node(int key, int value, int freq, Node pre, Node next) {
            this.key = key;
            this.value = value;
            this.freq = freq;
            this.pre = null;
            this.next = null;
        }
		
        public void updateValue(int value) {
            this.value = value;
        }
		
        public void incrFreq() {
            ++this.freq;
        }
		
        public int getKey() {
            return this.key;
        }
		
        public int getValue() {
            return this.value;
        }
		
        public int getFreq() {
            return this.freq;
        }
		
        public static final Node createEmptyNode() {
            return new Node(-1,-1,-1,null,null);
        }
    }

    /**
     *  è‡ªå®šä¹‰çš„åŒå‘é“¾è¡¨ç±»
    */
    protected static class LinkedList {
        //åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹
        private final Node head;
		
        //åŒå‘é“¾è¡¨çš„å°¾èŠ‚ç‚¹
        private final Node tail;
        public LinkedList() {
            this.head = Node.createEmptyNode();
            this.tail = Node.createEmptyNode();
            this.head.next = this.tail;
            this.tail.pre = this.head;
        }
		
        /**
         * å°†æŒ‡å®šçš„èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®
         * @param node å°†è¦æ’å…¥çš„èŠ‚ç‚¹
        */
        public void insertFirst(Node node) {
            if(node==null) {
                throw new IllegalArgumentException();
            }
            node.next = this.head.next;
            this.head.next.pre = node;
            node.pre = this.head;
            this.head.next = node;
        }
		
        /**
         * ä»é“¾è¡¨ä¸­åˆ é™¤æŒ‡å®šçš„èŠ‚ç‚¹
         * @param node å°†è¦åˆ é™¤çš„èŠ‚ç‚¹
        */
        public void deleteNode(Node node) {
            if(node==null) {
                throw new IllegalArgumentException();
            }
            node.pre.next = node.next;
            node.next.pre = node.pre;
            node.pre = null;
            node.next = null;
        }
		
        /**
         * ä»é“¾è¡¨ä¸­è·å–æœ€åä¸€ä¸ªèŠ‚ç‚¹
         * @return åŒå‘é“¾è¡¨ä¸­çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯ç©ºé“¾è¡¨åˆ™è¿”å›None
        */
        public Node getLastNode() {
            if(this.head.next==this.tail) {
                return Node.createEmptyNode();
            }
            return this.tail.pre;
        }
		
        /**
         * åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©ºï¼Œé™¤äº†headå’Œtailæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹å³ä¸ºç©ºé“¾è¡¨
         * @return é“¾è¡¨ä¸ç©ºè¿”å›Trueï¼Œå¦åˆ™è¿”å›False
        */
        public boolean isEmpty() {
            return this.head.next==this.tail;
        }
    }	
	
    //key->Node è¿™ç§ç»“æ„çš„å“ˆå¸Œè¡¨
    private final Map<Integer,Node> keyMap = new HashMap<Integer,Node>();
	
    //freq->LinkedList è¿™ç§ç»“æ„çš„å“ˆå¸Œè¡¨
    private final Map<Integer,LinkedList> freqMap = new HashMap<Integer,LinkedList>();
	
    //ç¼“å­˜çš„æœ€å¤§å®¹é‡
    private final int capacity;
	
    //è®°å½•ç¼“å­˜ä¸­æœ€ä½é¢‘ç‡
    private int minFreq = 0;
	
    public LFUCache(int capacity) {
//		if(capacity<=0) {
//			throw new IllegalArgumentException();
//		}
        this.capacity = capacity;
    }
    
    /**
     * è·å–ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœkeyä¸å­˜åœ¨åˆ™è¿”å›-1ï¼Œå¦åˆ™è¿”å›å¯¹åº”çš„valueï¼ŒåŒæ—¶æ›´æ–°è¢«è®¿é—®å…ƒç´ çš„é¢‘ç‡
     * @param key è¦æŸ¥æ‰¾çš„å…³é”®å­—
     * @return å¦‚æœæ²¡æ‰¾åˆ°åˆ™è¿”å›-1ï¼Œå¦åˆ™è¿”å›å¯¹åº”çš„value
     */
    public int get(int key) {
        if(!this.keyMap.containsKey(key)) {
            return -1;
        }
        Node node = this.keyMap.get(key);
        this.increment(node);
        return node.getValue();
    }
    
    /**
     * æ’å…¥æŒ‡å®šçš„keyå’Œvalueï¼Œå¦‚æœkeyå­˜åœ¨åˆ™æ›´æ–°valueï¼ŒåŒæ—¶æ›´æ–°é¢‘ç‡ï¼Œ
     * å¦‚æœkeyä¸å­˜å¹¶ä¸”ç¼“å­˜æ»¡äº†ï¼Œåˆ™åˆ é™¤é¢‘ç‡æœ€ä½çš„å…ƒç´ ï¼Œå¹¶æ’å…¥æ–°å…ƒç´ ã€‚å¦åˆ™ï¼Œç›´æ¥æ’å…¥æ–°å…ƒç´ 
     * @param key è¦æ’å…¥çš„å…³é”®å­—
     * @param value è¦æ’å…¥çš„å€¼
     */
    public void put(int key, int value) {
        if(this.keyMap.containsKey(key)) {
            Node node = this.keyMap.get(key);
            node.updateValue(value);
            this.increment(node);
        }
        else {
            if(this.capacity==0) {
                return;
            }
            if(this.keyMap.size()==this.capacity) {
                this.remoteMinFreqNode();
            }
            Node node = new Node(key,value,1);
            this.increment(node,true);
            this.keyMap.put(key, node);
        }
    }
    

    /**
     * æ›´æ–°èŠ‚ç‚¹çš„è®¿é—®é¢‘ç‡
     * @param node è¦æ›´æ–°çš„èŠ‚ç‚¹
     */
    private void increment(Node node) {
        increment(node,false);
    }
    
    /**
     * æ›´æ–°èŠ‚ç‚¹çš„è®¿é—®é¢‘ç‡
     * @param node è¦æ›´æ–°çš„èŠ‚ç‚¹
     * @param isNewNode æ˜¯å¦æ˜¯æ–°èŠ‚ç‚¹ï¼Œæ–°æ’å…¥çš„èŠ‚ç‚¹å’Œéæ–°æ’å…¥èŠ‚ç‚¹æ›´æ–°é€»è¾‘ä¸åŒ
     */
    private void increment(Node node,boolean isNewNode) {
        if(isNewNode) {
            this.minFreq = 1;
            this.insertToLinkedList(node);
        }
        else {
            this.deleteNode(node);
            node.incrFreq();
            this.insertToLinkedList(node);
            if(!this.freqMap.containsKey(this.minFreq)) {
                ++this.minFreq;
            }
        }
    }
    
    /**
     * æ ¹æ®èŠ‚ç‚¹çš„é¢‘ç‡ï¼Œæ’å…¥åˆ°å¯¹åº”çš„LinkedListä¸­ï¼Œå¦‚æœLinkedListä¸å­˜åœ¨åˆ™åˆ›å»º
     * @param node å°†è¦æ’å…¥åˆ°LinkedListçš„èŠ‚ç‚¹
     */
    private void insertToLinkedList(Node node) {
        if(!this.freqMap.containsKey(node.getFreq())) {
            this.freqMap.put(node.getFreq(), new LinkedList());
        }
        LinkedList linkedList = this.freqMap.get(node.getFreq());
        linkedList.insertFirst(node);
    }
    
    /**
     * åˆ é™¤æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œå¦‚æœèŠ‚ç‚¹åˆ é™¤åï¼Œå¯¹åº”çš„åŒé“¾è¡¨ä¸ºç©ºï¼Œåˆ™ä»__freqMapä¸­åˆ é™¤è¿™ä¸ªé“¾è¡¨
     * @param node å°†è¦åˆ é™¤çš„èŠ‚ç‚¹
     */
    private void deleteNode(Node node) {
        LinkedList linkedList = this.freqMap.get(node.getFreq());
        linkedList.deleteNode(node);
        if(linkedList.isEmpty()) {
            this.freqMap.remove(node.getFreq());
        }
    }
    
    /**
     * åˆ é™¤é¢‘ç‡æœ€ä½çš„å…ƒç´ ï¼Œä»freqMapå’ŒkeyMapä¸­éƒ½è¦åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼Œ
     * å¦‚æœèŠ‚ç‚¹åˆ é™¤åå¯¹åº”çš„é“¾è¡¨ä¸ºç©ºï¼Œåˆ™è¦ä»__freqMapä¸­åˆ é™¤è¿™ä¸ªé“¾è¡¨
     */
    private void remoteMinFreqNode() {
        LinkedList linkedList = this.freqMap.get(this.minFreq);
        Node node = linkedList.getLastNode();
        linkedList.deleteNode(node);
        this.keyMap.remove(node.getKey());
        if(linkedList.isEmpty()) {
            this.freqMap.remove(node.getFreq());
        }
    }
}


```
```python []
class Node(object):
    """
    åŒé“¾è¡¨ä¸­çš„é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡
    """
    def __init__(self,key=None,value=None,freq=0):
        """
        Args:
            key:å¯¹åº”è¾“å…¥çš„key
            value:å¯¹åº”è¾“å…¥çš„value
            freq:è¢«è®¿é—®çš„é¢‘ç‡
            pre:æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
            next:æŒ‡å‘åä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
        """
        self.key = key
        self.value = value
        self.freq = freq
        self.pre = None
        self.next = None
        
class LinkedList(object):
    """
    è‡ªå®šä¹‰çš„åŒå‘é“¾è¡¨
    """
    def __init__(self):
        """
        Args:
            __head:åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹
            __tail:åŒå‘é“¾è¡¨çš„å°¾èŠ‚ç‚¹
        """
        self.__head = Node()
        self.__tail = Node()
        self.__head.next = self.__tail
        self.__tail.pre = self.__head
        
    def insertFirst(self,node):
        """
        å°†æŒ‡å®šçš„èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½® 
        Args:
            node:å°†è¦æ’å…¥çš„èŠ‚ç‚¹    
        """
        node.next = self.__head.next
        self.__head.next.pre = node
        self.__head.next = node
        node.pre = self.__head
        
    def delete(self,node):
        """
        ä»é“¾è¡¨ä¸­åˆ é™¤æŒ‡å®šçš„èŠ‚ç‚¹ 
        Args:
            node:å°†è¦åˆ é™¤çš„èŠ‚ç‚¹ 
        """
        if self.__head.next==self.__tail:
            return
        node.pre.next = node.next
        node.next.pre = node.pre
        node.next = None
        node.pre = None
        
    def getLast(self):
        """
        ä»é“¾è¡¨ä¸­è·å–æœ€åä¸€ä¸ªèŠ‚ç‚¹
        Returns:
            åŒå‘é“¾è¡¨ä¸­çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯ç©ºé“¾è¡¨åˆ™è¿”å›None
        """        
        if self.__head.next==self.__tail:
            return None
        return self.__tail.pre
        
    def isEmpty(self):
        """
        åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©ºï¼Œé™¤äº†headå’Œtailæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹å³ä¸ºç©ºé“¾è¡¨
        Returns:
            é“¾è¡¨ä¸ç©ºè¿”å›Trueï¼Œå¦åˆ™è¿”å›False
        """  
        return self.__head.next==self.__tail

class LFUCache(object):
    """
    è‡ªå®šä¹‰çš„LFUç¼“å­˜
    """
    def __init__(self, capacity):
        """
        Args:
            __capacity:ç¼“å­˜çš„æœ€å¤§å®¹é‡
            __keyMap: key->Node è¿™ç§ç»“æ„çš„å­—å…¸
            __freqMap:freq->LinkedList è¿™ç§ç»“æ„çš„å­—å…¸
            __minFreq:è®°å½•ç¼“å­˜ä¸­æœ€ä½é¢‘ç‡
        """
        self.__capacity = capacity
        self.__keyMap = dict()
        self.__freqMap = dict()
        self.__minFreq = 0
        

    def get(self, key):
        """
        è·å–ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœkeyä¸å­˜åœ¨åˆ™è¿”å›-1ï¼Œå¦åˆ™è¿”å›å¯¹åº”çš„value
        åŒæ—¶æ›´æ–°è¢«è®¿é—®å…ƒç´ çš„é¢‘ç‡
        Args:
            key:è¦æŸ¥æ‰¾çš„å…³é”®å­—
        Returns:
            å¦‚æœæ²¡æ‰¾åˆ°åˆ™è¿”å›-1ï¼Œå¦åˆ™è¿”å›å¯¹åº”çš„value
        """
        if key not in self.__keyMap:
            return -1
        node = self.__keyMap[key]
        self.__increment(node)
        return node.value

    def put(self, key, value):
        """
        æ’å…¥æŒ‡å®šçš„keyå’Œvalueï¼Œå¦‚æœkeyå­˜åœ¨åˆ™æ›´æ–°valueï¼ŒåŒæ—¶æ›´æ–°é¢‘ç‡
        å¦‚æœkeyä¸å­˜å¹¶ä¸”ç¼“å­˜æ»¡äº†ï¼Œåˆ™åˆ é™¤é¢‘ç‡æœ€ä½çš„å…ƒç´ ï¼Œå¹¶æ’å…¥æ–°å…ƒç´ 
        å¦åˆ™ï¼Œç›´æ¥æ’å…¥æ–°å…ƒç´ 
        Args:
            key:è¦æ’å…¥çš„å…³é”®å­—
            value:è¦æ’å…¥çš„å€¼
        """
        if key in self.__keyMap:
            node = self.__keyMap[key]
            node.value = value
            self.__increment(node)
        else:
            if self.__capacity==0:
                return
            if len(self.__keyMap)==self.__capacity:
                self.__removeMinFreqElement()
            node = Node(key,value,1)
            self.__increment(node,True)
            self.__keyMap[key] = node
        
    def __increment(self,node,is_new_node=False):
        """
        æ›´æ–°èŠ‚ç‚¹çš„è®¿é—®é¢‘ç‡
        Args:
            node:è¦æ›´æ–°çš„èŠ‚ç‚¹
            is_new_node:æ˜¯å¦æ˜¯æ–°èŠ‚ç‚¹ï¼Œæ–°æ’å…¥çš„èŠ‚ç‚¹å’Œéæ–°æ’å…¥èŠ‚ç‚¹æ›´æ–°é€»è¾‘ä¸åŒ
        """
        if is_new_node:
            self.__minFreq = 1
            self.__setDefaultLinkedList(node)
        else:
            self.__deleteNode(node)
            node.freq += 1
            self.__setDefaultLinkedList(node)
            if self.__minFreq not in self.__freqMap:
                self.__minFreq += 1
    
    def __setDefaultLinkedList(self,node):
        """
        æ ¹æ®èŠ‚ç‚¹çš„é¢‘ç‡ï¼Œæ’å…¥åˆ°å¯¹åº”çš„LinkedListä¸­ï¼Œå¦‚æœLinkedListä¸å­˜åœ¨åˆ™åˆ›å»º
        Args:
            node:å°†è¦æ’å…¥åˆ°LinkedListçš„èŠ‚ç‚¹
        """
        if node.freq not in self.__freqMap:
            self.__freqMap[node.freq] = LinkedList()
        linkedList = self.__freqMap[node.freq]
        linkedList.insertFirst(node)
        
    def __deleteNode(self,node):
        """
        åˆ é™¤æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œå¦‚æœèŠ‚ç‚¹åˆ é™¤åï¼Œå¯¹åº”çš„åŒé“¾è¡¨ä¸ºç©ºï¼Œåˆ™ä»__freqMapä¸­åˆ é™¤è¿™ä¸ªé“¾è¡¨
        Args:
            node:å°†è¦åˆ é™¤çš„èŠ‚ç‚¹
        """
        if node.freq not in self.__freqMap:
            return
        linkedList = self.__freqMap[node.freq]
        freq = node.freq
        linkedList.delete(node)
        if linkedList.isEmpty():
            del self.__freqMap[freq]
        
    def __removeMinFreqElement(self):
        """
        åˆ é™¤é¢‘ç‡æœ€ä½çš„å…ƒç´ ï¼Œä»__freqMapå’Œ__keyMapä¸­éƒ½è¦åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœèŠ‚ç‚¹åˆ é™¤åå¯¹åº”çš„é“¾è¡¨ä¸ºç©ºï¼Œåˆ™è¦ä»__freqMapä¸­åˆ é™¤è¿™ä¸ªé“¾è¡¨
        """
        linkedList = self.__freqMap[self.__minFreq]
        node = linkedList.getLast()
        linkedList.delete(node)
        del self.__keyMap[node.key]
        if linkedList.isEmpty():
            del self.__freqMap[node.freq]
        
```

**æ¬¢è¿å…³æ³¨ ğŸ‘‰ğŸ‘‰ğŸ‘‰  [ã€å…¬ä¼—å·ã€‘](https://share.weiyun.com/0KDRUnfK) ğŸ‘ˆğŸ‘ˆğŸ‘ˆ**   

**å¦‚æœèƒ½å†ç‚¹ä¸ªèµğŸ‘ğŸ‘ å°±æ›´æ„Ÿæ¿€å•¦ğŸ’“ğŸ’“** 