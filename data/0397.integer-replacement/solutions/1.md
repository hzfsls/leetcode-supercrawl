## [397.æ•´æ•°æ›¿æ¢ ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/integer-replacement/solutions/100000/gong-shui-san-xie-yi-ti-san-jie-dfsbfs-t-373h)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)
> ç¬”è®°æœ¬çªç„¶å……ä¸ä¸Šç”µäº†ï¼Œè‰°éš¾ç”¨ iPad å†™çš„é¢˜è§£  ğŸ˜­

## DFS

è¿ç”¨ `DFS` è¿›è¡Œæ±‚è§£ã€‚ä¸ºé˜²æ­¢é‡å¤å¤„ç†æŸäº›æ•°å€¼ï¼Œå¯ä»¥ä½¿ç”¨ã€Œå“ˆå¸Œè¡¨ã€è¿›è¡Œè®°å¿†åŒ–ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    Map<Long, Integer> map = new HashMap<>();
    public int integerReplacement(int n) {
        return dfs(n * 1L);
    }
    int dfs(long n) {
        if (n == 1) return 0;
        if (map.containsKey(n)) return map.get(n);
        int ans = n % 2 == 0 ? dfs(n / 2) : Math.min(dfs(n + 1), dfs(n - 1));
        map.put(n, ++ans);
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(\log{n})$

---

## BFS

åŒç†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `BFS` è¿›è¡Œæ±‚è§£ã€‚åŒæ ·ä½¿ç”¨ã€Œå“ˆå¸Œè¡¨ã€è®°å½•æ­¥æ•°ï¼Œé˜²æ­¢é‡å¤å¤„ç†ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    public int integerReplacement(int n) {
        if (n == 1) return 0;
        Map<Long, Integer> map = new HashMap<>();
        Deque<Long> d = new ArrayDeque<>();
        d.addLast(n * 1L);
        map.put(n * 1L, 0);
        while (!d.isEmpty()) {
            long t = d.pollFirst();
            int step = map.get(t);
            long[] ns = t % 2 == 0 ? new long[]{t / 2} : new long[]{t + 1, t - 1};
            for (long x : ns) {
                if (x == 1) return step + 1;
                if (!map.containsKey(x)) {
                    map.put(x, step + 1);
                    d.addLast(x);
                }
            }
        }
        return -1;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(\log{n})$

---

## è´ªå¿ƒï¼ˆä½è¿ç®—ï¼‰

ä¸Šè¿°ä¸¤ç§åšæ³•ï¼Œæˆ‘ä»¬ä¸å¯é¿å…åœ°åœ¨æ¯ä¸ªå›åˆæšä¸¾äº†æ‰€æœ‰æˆ‘ä»¬å¯ä»¥åšçš„å†³ç­–ï¼šä¸»è¦ä½“ç°åœ¨å¯¹ $x$ ä¸ºå¥‡æ•°æ—¶çš„å¤„ç†ï¼Œæˆ‘ä»¬æ€»æ˜¯å¤„ç† $x + 1$ å’Œ $x - 1$ ä¸¤ç§æƒ…å†µã€‚

æˆ‘ä»¬å¯ä»¥ä»äºŒè¿›åˆ¶çš„è§’åº¦è¿›è¡Œåˆ†æï¼š**ç»™å®šèµ·å§‹å€¼ $n$ï¼Œæ±‚è§£å°†å…¶å˜ä¸º $(000...0001)_2$ çš„æœ€å°æ­¥æ•°ã€‚**

* å¯¹äºå¶æ•°ï¼ˆäºŒè¿›åˆ¶æœ€ä½ä½ä¸º $0$ï¼‰è€Œè¨€ï¼Œæˆ‘ä»¬åªèƒ½è¿›è¡Œä¸€ç§æ“ä½œï¼Œå…¶ä½œç”¨æ˜¯å°†å½“å‰å€¼ $x$ å…¶è¿›è¡Œä¸€ä¸ªå•ä½çš„å³ç§»ï¼›
* å¯¹äºå¥‡æ•°ï¼ˆäºŒè¿›åˆ¶æœ€ä½ä½ä¸º $1$ï¼‰è€Œè¨€ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè¿›è¡Œ `+1` æˆ– `-1` æ“ä½œï¼Œåˆ†æä¸¤ç§æ“ä½œä¸º $x$ äº§ç”Ÿçš„å½±å“ï¼š
    * å¯¹äº `+1` æ“ä½œè€Œè¨€ï¼šæœ€ä½ä½å¿…ç„¶ä¸º $1$ï¼Œæ­¤æ—¶å¦‚æœæ¬¡ä½ä½ä¸º $0$ çš„è¯ï¼Œ `+1` ç›¸å½“äºå°†æœ€ä½ä½å’Œæ¬¡ä½ä½äº¤æ¢ï¼›å¦‚æœæ¬¡ä½ä½ä¸º $1$ çš„è¯ï¼Œ`+1` æ“ä½œå°†å°†ã€Œä»æœ€ä½ä½å¼€å§‹ï¼Œè¿ç»­ä¸€æ®µçš„ $1$ã€è¿›è¡Œæ¶ˆé™¤ï¼ˆç½®é›¶ï¼‰ï¼Œå¹¶åœ¨è¿ç»­ä¸€æ®µçš„é«˜ä¸€ä½æ·»åŠ ä¸€ä¸ª $1$ï¼›
    * å¯¹äº `-1` æ“ä½œè€Œè¨€ï¼šæœ€ä½ä½å¿…ç„¶ä¸º $1$ï¼Œå…¶ä½œç”¨æ˜¯å°†æœ€ä½ä½çš„ $1$ è¿›è¡Œæ¶ˆé™¤ã€‚

å› æ­¤ï¼Œå¯¹äº $x$ ä¸ºå¥‡æ•°æ‰€èƒ½æ‰§è¡Œçš„ä¸¤ç§æ“ä½œï¼Œ`+1` èƒ½å¤Ÿæ¶ˆé™¤è¿ç»­ä¸€æ®µçš„ $1$ï¼Œåªè¦æ¬¡ä½ä½ä¸º $1$ï¼ˆå­˜åœ¨è¿ç»­æ®µï¼‰ï¼Œåº”å½“ä¼˜å…ˆä½¿ç”¨ `+1` æ“ä½œï¼Œä½†éœ€è¦æ³¨æ„è¾¹ç•Œ $x = 3$ æ—¶çš„æƒ…å†µï¼ˆæ­¤æ—¶é€‰æ‹© `-1` æ“ä½œï¼‰ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    public int integerReplacement(int _n) {
        long n = _n;
        int ans = 0;
        while (n != 1) {
            if (n % 2 == 0) {
                n >>= 1;
            } else {
                if (n != 3 && ((n >> 1) & 1) == 1) n++;
                else n--;
            }
            ans++;
        }
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png)ï¼ˆå…¬ä¸»å·åå°å›å¤ã€Œé€ä¹¦ã€å³å¯å‚ä¸é•¿æœŸçœ‹é¢˜è§£å­¦ç®—æ³•é€å®ä½“ä¹¦æ´»åŠ¨ï¼‰æˆ– åŠ å…¥[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~ 