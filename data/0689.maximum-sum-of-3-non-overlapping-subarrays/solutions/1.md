## [689.ä¸‰ä¸ªæ— é‡å å­æ•°ç»„çš„æœ€å¤§å’Œ ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/maximum-sum-of-3-non-overlapping-subarrays/solutions/100000/gong-shui-san-xie-jie-he-qian-zhui-he-de-ancx)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)

## å‰ç¼€å’Œ + åºåˆ— DP

è‹¥ä¸è€ƒè™‘è¾“å‡ºæ–¹æ¡ˆï¼Œä»…æ˜¯æ±‚ã€Œä¸‰ä¸ªæ— é‡å å­æ•°ç»„çš„æœ€å¤§å’Œã€çš„æœ€å¤§å€¼ã€‚

åªéœ€è¦ä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£å³å¯ï¼š**å®šä¹‰ $f[i][j]$ ä¸ºè€ƒè™‘å‰ $i$ ä¸ªæ•°ï¼Œå‡‘æˆæ— é‡å å­æ•°ç»„æ•°é‡ä¸º $j$ ä¸ªæ—¶çš„æœ€å¤§å€¼ã€‚**

æœ€ç»ˆç­”æ¡ˆä¸º $f[n - 1][3]$ã€‚

ä¸å¤±ä¸€èˆ¬æ€§çš„è€ƒè™‘ $f[i][j]$ è¯¥å¦‚ä½•è®¡ç®—ï¼ˆä»¥æœ€ä¼˜æ–¹æ¡ˆæ˜¯å¦åŒ…å« $nums[i]$ è¿›è¡Œè®¨è®ºï¼‰ï¼š

*   æœ€ä¼˜æ–¹æ¡ˆä¸­åŒ…å« $num[i]$ï¼šç”±äºè¿™ $j$ ä¸ªæ— é‡å ï¼Œå› æ­¤å‰é¢çš„ $j - 1$ ä¸ªå­æ•°ç»„ä¸èƒ½è¦†ç›– $[i - k + 1, i]$ã€‚å³åªèƒ½åœ¨ $[0, i - k]$ ä¸­é€‰ $j - 1$ ä¸ªå­æ•°ç»„ã€‚æ­¤æ—¶æœ‰ï¼š

$$
f[i][j] = f[i - k][j - 1] + \sum_{idx = i - k + 1}^{i} nums[idx]
$$

> å…¶ä¸­æ±‚è§£ $\sum_{idx = i - k + 1}^{i} nums[idx]$ éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ã€Œå‰ç¼€å’Œã€ä¼˜åŒ–

*   æœ€ä¼˜æ–¹æ¡ˆä¸åŒ…å« $num[i]$ï¼šå½“æ˜ç¡®äº† $nums[i]$ å¯¹æœ€ä¼˜æ–¹æ¡ˆæ— è´¡çŒ®ï¼Œæ­¤æ—¶é—®é¢˜ç­‰ä»·äºè€ƒè™‘å‰ $i - 1$ ä¸ªæ•°ï¼Œå‡‘æˆ $j$ ä¸ªä¸é‡å å­æ•°ç»„çš„æœ€å¤§å€¼ã€‚æ­¤æ—¶æœ‰ï¼š

$$
f[i][j] = f[i - 1][j]
$$

æœ€ç»ˆ $f[i][j]$ ä¸ºä¸Šè¿°ä¸¤ç§æ–¹æ¡ˆä¸­çš„æœ€å¤§å€¼ã€‚

ç„¶åè€ƒè™‘ã€Œå¦‚ä½•å›æº¯å‡ºå­—å…¸åºæœ€å°çš„å…·ä½“æ–¹æ¡ˆã€ï¼Œå¸¸è§„çš„å›æº¯å…·ä½“æ–¹æ¡ˆçš„åšæ³•æ˜¯ï¼Œä»æœ€ç»ˆç­”æ¡ˆ $f[n - 1][3]$ å¼€å§‹å¾€å›è¿½æº¯ã€‚

åˆ©ç”¨ $f[n - 1][3]$ ä»…ç”±ä¸¤ä¸ªå¯èƒ½çš„èŠ‚ç‚¹ï¼ˆ$f[n - 2][3]$ å’Œ $f[n - 1 - k][2]$ï¼‰è½¬ç§»è€Œæ¥ï¼Œé€šè¿‡åˆ¤æ–­ $f[n - 1][3]$ ç­‰äº $f[n - 2][3]$ è¿˜æ˜¯ $f[n - 1 - k][2] + \sum_{idx = n - k }^{n - 1} nums[idx]$ æ¥å†³å®šå›æº¯ç‚¹ä¸ºä½•å€¼ã€‚

ä½†è¯¥åšæ³•åªèƒ½ç¡®ä¿å›æº¯å‡ºå­—å…¸åºæœ€å¤§çš„æ–¹æ¡ˆæ˜¯æ­£ç¡®ï¼ˆå½“ä¸¤ä¸ªå¯èƒ½çš„å‰é©±èŠ‚ç‚¹éƒ½èƒ½è½¬ç§»åˆ° $f[i][j]$ æ—¶ä¼˜å…ˆé‡‡çº³é åçš„ä½ç½®ï¼‰ï¼Œè€Œæˆ‘ä»¬éœ€è¦å›æº¯å‡ºå­—å…¸åºæœ€å°çš„æ–¹æ¡ˆã€‚

åœ¨ä¸Šè¿°è§£æ³•çš„åŸºç¡€ä¸Šï¼Œæœ‰ä¸¤ç§ã€Œæ±‚è§£å­—å…¸åºæœ€å°å…·ä½“æ–¹æ¡ˆã€çš„åšæ³•ï¼š

1.  å°†æ­£åº DP è°ƒæ•´ä¸ºååº DPã€‚ä¿®æ”¹çŠ¶æ€å®šä¹‰ä¸º $f[i][j]$ ä¸ºè€ƒè™‘ $[i, n - 1]$ ä¸­è¿›è¡Œé€‰æ‹©ï¼Œå‡‘å‡ºæ— é‡å å­æ•°ç»„æ•°é‡ä¸º $j$ ä¸ªæ—¶çš„æœ€å¤§å€¼ï¼ˆæœ€ç»ˆç­”æ¡ˆä¸º $f[0][3]$ï¼‰ã€‚è½¬ç§»è¿‡ç¨‹åˆ†æåŒç†ï¼Œç„¶åä»ä¸‹æ ‡ $idx = 0$ å¼€å§‹è¿›è¡Œå›æº¯ï¼Œä¼˜å…ˆé‡‡çº³ $idx$ å°çš„æ–¹æ¡ˆå³å¯ï¼›

2.  ä»ç„¶é‡‡å–æ­£åº DP çš„åšæ³•ï¼Œä½†å¯¹åŸæ•°ç»„è¿›è¡Œç¿»è½¬ï¼Œä»è€Œå°†å›æº¯ã€Œå­—å…¸åºæœ€å¤§ã€è½¬æ¢ä¸ºã€Œå­—å…¸åºæœ€å°ã€å…·ä½“æ–¹æ¡ˆã€‚

> ä¸€äº›ç»†èŠ‚ï¼šä¸ºäº†é¿å…å¯¹è¾¹ç•Œçš„å¤„ç†ï¼Œæˆ‘ä»¬ä»¤åŠ¨è§„æ•°ç»„ $f$ å’Œå‰ç¼€å’Œæ•°ç»„ $sun$ çš„ä¸‹æ ‡ä» $1$ å¼€å§‹ã€‚

**ä¸éš¾å‘ç°ï¼Œä¸Šè¿°åˆ†æå®¹æ˜“æ¨å¹¿åˆ°æ±‚ $m$ ä¸ªæ— é‡å å­æ•°ç»„æœ€å¤§å’Œã€‚**

ä»£ç ï¼ˆ$P1$ ä¸ºååº DP åšæ³•ï¼Œ$P2$ ä¸ºç¿»è½¬æ•°ç»„åšæ³•ï¼‰ï¼š

```Java []
class Solution {
    public int[] maxSumOfThreeSubarrays(int[] nums, int k) {
        int n = nums.length;
        long[] sum = new long[n + 1];
        for (int i = 1; i <= n; i++) sum[i] = sum[i - 1] + nums[i - 1];
        long[][] f = new long[n + 10][4];
        for (int i = n - k + 1; i >= 1; i--) {
            for (int j = 1; j < 4; j++) {
                f[i][j] = Math.max(f[i + 1][j], f[i + k][j - 1] + sum[i + k - 1] - sum[i - 1]);
            }
        }
        int[] ans = new int[3];
        int i = 1, j = 3, idx = 0;
        while (j > 0) {
            if (f[i + 1][j] > f[i + k][j - 1] + sum[i + k - 1] - sum[i - 1]) {
                i++;
            } else {
                ans[idx++] = i - 1;
                i += k; j--;
            }
        }
        return ans;
    }
}
```
```Java []
class Solution {
    public int[] maxSumOfThreeSubarrays(int[] nums, int k) {
        int n = nums.length;
        reverse(nums);
        long[] sum = new long[n + 1];
        for (int i = 1; i <= n; i++) sum[i] = sum[i - 1] + nums[i - 1];
        long[][] f = new long[n + 10][4];
        for (int i = k; i <= n; i++) {
            for (int j = 1; j < 4; j++) {
                f[i][j] = Math.max(f[i - 1][j], f[i - k][j - 1] + sum[i] - sum[i - k]);
            }
        }
        int[] ans = new int[3];
        int i = n, j = 3, idx = 0;
        while (j > 0) {
            if (f[i - 1][j] > f[i - k][j - 1] + sum[i] - sum[i - k]) {
                i--;
            } else {
                ans[idx++] = n - i;
                i -= k; j--;
            }
        }
        return ans;
    }
    void reverse(int[] nums) {
        int n = nums.length;
        int l = 0, r = n - 1;
        while (l < r) {
            int c = nums[l];
            nums[l++] = nums[r];
            nums[r--] = c;
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## å…¶ä»–ã€Œåºåˆ— DPã€å†…å®¹

è€ƒè™‘åŠ ç»ƒå¦‚ä¸‹ã€Œåºåˆ— DPã€å†…å®¹ ğŸ­ğŸ­ğŸ­

| é¢˜ç›®                                                         | é¢˜è§£                                                         | éš¾åº¦ | æ¨èæŒ‡æ•° |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ---- | -------- |
| [354. ä¿„ç½—æ–¯å¥—å¨ƒä¿¡å°é—®é¢˜](https://leetcode-cn.com/problems/russian-doll-envelopes/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/russian-doll-envelopes/solution/zui-chang-shang-sheng-zi-xu-lie-bian-xin-6s8d/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©    |
| [368. æœ€å¤§æ•´é™¤å­é›†](https://leetcode-cn.com/problems/largest-divisible-subset/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/largest-divisible-subset/solution/gong-shui-san-xie-noxiang-xin-ke-xue-xi-0a3jc/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [446. ç­‰å·®æ•°åˆ—åˆ’åˆ† II - å­åºåˆ—](https://leetcode-cn.com/problems/arithmetic-slices-ii-subsequence/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/arithmetic-slices-ii-subsequence/solution/gong-shui-san-xie-xiang-jie-ru-he-fen-xi-ykvk/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©    |
| [583. ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ](https://leetcode-cn.com/problems/delete-operation-for-two-strings/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/delete-operation-for-two-strings/solution/gong-shui-san-xie-cong-liang-chong-xu-li-wqv7/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [629. Kä¸ªé€†åºå¯¹æ•°ç»„](https://leetcode-cn.com/problems/k-inverse-pairs-array/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/k-inverse-pairs-array/solution/gong-shui-san-xie-yi-dao-xu-lie-dp-zhuan-tm01/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©    |
| [673. æœ€é•¿é€’å¢å­åºåˆ—çš„ä¸ªæ•°](https://leetcode-cn.com/problems/number-of-longest-increasing-subsequence/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/number-of-longest-increasing-subsequence/solution/gong-shui-san-xie-lis-de-fang-an-shu-wen-obuz/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [689. ä¸‰ä¸ªæ— é‡å å­æ•°ç»„çš„æœ€å¤§å’Œ](https://leetcode-cn.com/problems/maximum-sum-of-3-non-overlapping-subarrays/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/maximum-sum-of-3-non-overlapping-subarrays/solution/gong-shui-san-xie-jie-he-qian-zhui-he-de-ancx/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [740. åˆ é™¤å¹¶è·å¾—ç‚¹æ•°](https://leetcode-cn.com/problems/delete-and-earn/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/delete-and-earn/solution/gong-shui-san-xie-zhuan-huan-wei-xu-lie-6c9t0/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©    |
| [978. æœ€é•¿æ¹æµå­æ•°ç»„](https://leetcode-cn.com/problems/longest-turbulent-subarray/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/longest-turbulent-subarray/solution/xiang-jie-dong-tai-gui-hua-ru-he-cai-dp-3spgj/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©      |
| [1035. ä¸ç›¸äº¤çš„çº¿](https://leetcode-cn.com/problems/uncrossed-lines/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/uncrossed-lines/solution/gong-shui-san-xie-noxiang-xin-ke-xue-xi-bkaas/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [1143. æœ€é•¿å…¬å…±å­åºåˆ—](https://leetcode-cn.com/problems/longest-common-subsequence/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/longest-common-subsequence/solution/gong-shui-san-xie-zui-chang-gong-gong-zi-xq0h/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [1218. æœ€é•¿å®šå·®å­åºåˆ—](https://leetcode-cn.com/problems/longest-arithmetic-subsequence-of-given-difference/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/longest-arithmetic-subsequence-of-given-difference/solution/gong-shui-san-xie-jie-he-tan-xin-de-zhua-dj1k/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©    |
| [1473. ç²‰åˆ·æˆ¿å­ III](https://leetcode-cn.com/problems/paint-house-iii/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/paint-house-iii/solution/gong-shui-san-xie-san-wei-dong-tai-gui-h-ud7m/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [1713. å¾—åˆ°å­åºåˆ—çš„æœ€å°‘æ“ä½œæ¬¡æ•°](https://leetcode-cn.com/problems/minimum-operations-to-make-a-subsequence/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/minimum-operations-to-make-a-subsequence/solution/gong-shui-san-xie-noxiang-xin-ke-xue-xi-oj7yu/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©    |

**æ³¨ï¼šä»¥ä¸Šç›®å½•æ•´ç†æ¥è‡ª [wiki](https://github.com/SharingSource/LogicStack-LeetCode/wiki/åºåˆ—-DP)ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½å¼•ç”¨è¯·ä¿ç•™å‡ºå¤„ã€‚**


---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) å’Œ åŠ å…¥æˆ‘ä»¬çš„[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~ 