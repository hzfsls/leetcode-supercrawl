## [688.éª‘å£«åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡ ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/knight-probability-in-chessboard/solutions/100000/gong-shui-san-xie-jian-dan-qu-jian-dp-yu-st8l)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)

## çº¿æ€§ DP

**å®šä¹‰ $f[i][j][p]$ ä¸ºä»ä½ç½® $(i, j)$ å‡ºå‘ï¼Œä½¿ç”¨æ­¥æ•°ä¸è¶…è¿‡ $p$ æ­¥ï¼Œæœ€åä»åœ¨æ£‹ç›˜å†…çš„æ¦‚ç‡ã€‚**

ä¸å¤±ä¸€èˆ¬æ€§è€ƒè™‘ $f[i][j][p]$ è¯¥å¦‚ä½•è½¬ç§»ï¼Œæ ¹æ®é¢˜æ„ï¼Œç§»åŠ¨è§„åˆ™ä¸ºã€Œå…«è¿é€šã€ï¼Œå¯¹ä¸‹ä¸€æ­¥çš„è½ç‚¹ $(nx, ny)$ è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºå³å¯ï¼š

* ç”±äºè®¡ç®—çš„æ˜¯ä»åœ¨æ£‹ç›˜å†…çš„æ¦‚ç‡ï¼Œå› æ­¤å¯¹äº $(nx, ny)$ åœ¨æ£‹ç›˜å¤–çš„æƒ…å†µï¼Œæ— é¡»è€ƒè™‘ï¼›
* è‹¥ä¸‹ä¸€æ­¥çš„è½ç‚¹ $(nx, ny)$ åœ¨æ£‹ç›˜å†…ï¼Œå…¶å‰©ä½™å¯ç”¨æ­¥æ•°ä¸º $p - 1$ï¼Œåˆ™æœ€åä»åœ¨æ£‹ç›˜çš„æ¦‚ç‡ä¸º $f[nx][ny][p - 1]$ï¼Œåˆ™è½ç‚¹ $(nx, ny)$ å¯¹ $f[i][j][p]$ çš„è´¡çŒ®ä¸º $f[nx][ny][p - 1] \times \frac{1}{8}$ï¼Œå…¶ä¸­ $\frac{1}{8}$ ä¸ºäº‹ä»¶ã€Œ**ä» $(i, j)$ èµ°åˆ° $(nx, ny)$**ã€çš„æ¦‚ç‡ï¼ˆå…«è¿é€šç§»åŠ¨ç­‰æ¦‚ç‡å‘ç”Ÿï¼‰ï¼Œè¯¥äº‹ä»¶ä¸ã€Œ**åˆ°è¾¾ $(nx, ny)$ åè¿›è¡Œåç»­ç§»åŠ¨å¹¶ç•™åœ¨æ£‹ç›˜**ã€ä¸ºç›¸äº’ç‹¬ç«‹äº‹ä»¶ã€‚

æœ€ç»ˆçš„ $f[i][j][p]$ ä¸ºã€Œå…«è¿é€šã€è½ç‚¹çš„æ¦‚ç‡ä¹‹å’Œï¼Œå³æœ‰ï¼š

$$
f[i][j][p] = \sum {f[nx][ny][p - 1] \times \frac{1}{8}}
$$

ä»£ç ï¼š
```Java []
class Solution {
    int[][] dirs = new int[][]{{-1,-2},{-1,2},{1,-2},{1,2},{-2,1},{-2,-1},{2,1},{2,-1}};
    public double knightProbability(int n, int k, int row, int column) {
        double[][][] f = new double[n][n][k + 1];
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < n; j++) {
                f[i][j][0] = 1;
            }
        }
        for (int p = 1; p <= k; p++) {
            for (int i = 0; i < n; i++) {
                for (int j = 0; j < n; j++) {
                    for (int[] d : dirs) {
                        int nx = i + d[0], ny = j + d[1];
                        if (nx < 0 || nx >= n || ny < 0 || ny >= n) continue;
                        f[i][j][p] += f[nx][ny][p - 1] / 8;
                    }
                }
            }
        }
        return f[row][column][k];
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šä»¤æŸä¸ªä½ç½®å¯è”é€šçš„æ ¼å­æ•°é‡ $C = 8$ï¼Œå¤æ‚åº¦ä¸º $O(n^2 * k * C)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2 * k)$

---

## å…¶ä»–ã€Œçº¿æ€§ DPã€ç›¸å…³å†…å®¹ 

é¢˜å¤ªç®€å•ï¼Ÿè€ƒè™‘åŠ ç»ƒå¦‚ä¸‹ã€Œçº¿æ€§ DPã€å†…å®¹ ğŸ­ğŸ­ğŸ­

| é¢˜ç›®                                                                                | é¢˜è§£                                                                                                                                                                                       | éš¾åº¦ | æ¨èæŒ‡æ•° |
| ----------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---- | -------- |
| [10. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… ](https://leetcode-cn.com/problems/regular-expression-matching) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/regular-expression-matching/solution/shua-chuan-lc-dong-tai-gui-hua-jie-fa-by-zn9w/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [44. é€šé…ç¬¦åŒ¹é…](https://leetcode-cn.com/problems/wildcard-matching/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/wildcard-matching/solution/gong-shui-san-xie-xiang-jie-dong-tai-gui-ifyx/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [45. è·³è·ƒæ¸¸æˆ II](https://leetcode-cn.com/problems/jump-game-ii/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/jump-game-ii/solution/xiang-jie-dp-tan-xin-shuang-zhi-zhen-jie-roh4/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |
| [91. è§£ç æ–¹æ³•](https://leetcode-cn.com/problems/decode-ways/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/decode-ways/solution/gong-shui-san-xie-gen-ju-shu-ju-fan-wei-ug3dd/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤© |
| [115. ä¸åŒçš„å­åºåˆ—](https://leetcode-cn.com/problems/distinct-subsequences/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/distinct-subsequences/solution/xiang-jie-zi-fu-chuan-pi-pei-wen-ti-de-t-wdtk/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [119. æ¨è¾‰ä¸‰è§’ II](https://leetcode-cn.com/problems/pascals-triangle-ii/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/pascals-triangle-ii/solution/dong-tai-gui-hua-luo-ti-chang-jian-de-ko-n2xj/) | ç®€å• | ğŸ¤©ğŸ¤©ğŸ¤© |
| [213. æ‰“å®¶åŠ«èˆ II](https://leetcode-cn.com/problems/house-robber-ii/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/house-robber-ii/solution/gong-shui-san-xie-ru-he-jiang-xin-xian-z-zf0w/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤© |
| [338. æ¯”ç‰¹ä½è®¡æ•°](https://leetcode-cn.com/problems/counting-bits/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/counting-bits/solution/po-su-jie-fa-dong-tai-gui-hua-jie-fa-by-vvail/) | ç®€å• | ğŸ¤©ğŸ¤©ğŸ¤© |
| [403. é’è›™è¿‡æ²³](https://leetcode-cn.com/problems/frog-jump/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/frog-jump/solution/gong-shui-san-xie-yi-ti-duo-jie-jiang-di-74fw/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤© |
| [576. å‡ºç•Œçš„è·¯å¾„æ•°](https://leetcode-cn.com/problems/out-of-boundary-paths/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/out-of-boundary-paths/solution/gong-shui-san-xie-yi-ti-shuang-jie-ji-yi-asrz/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [639. è§£ç æ–¹æ³• II](https://leetcode-cn.com/problems/decode-ways-ii/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/decode-ways-ii/solution/gong-shui-san-xie-fen-qing-kuang-tao-lun-902h/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [650. åªæœ‰ä¸¤ä¸ªé”®çš„é”®ç›˜](https://leetcode-cn.com/problems/2-keys-keyboard/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/2-keys-keyboard/solution/gong-shui-san-xie-yi-ti-san-jie-dong-tai-f035/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [678. æœ‰æ•ˆçš„æ‹¬å·å­—ç¬¦ä¸²](https://leetcode-cn.com/problems/valid-parenthesis-string/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/valid-parenthesis-string/solution/gong-shui-san-xie-yi-ti-shuang-jie-dong-801rq/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [688. éª‘å£«åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡](https://leetcode-cn.com/problems/knight-probability-in-chessboard/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/knight-probability-in-chessboard/solution/gong-shui-san-xie-jian-dan-qu-jian-dp-yu-st8l/) | ä¸­ç­‰ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [1137. ç¬¬ N ä¸ªæ³°æ³¢é‚£å¥‘æ•°](https://leetcode-cn.com/problems/n-th-tribonacci-number/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/n-th-tribonacci-number/solution/gong-shui-san-xie-yi-ti-si-jie-die-dai-d-m1ie/) | ç®€å• | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [1220. ç»Ÿè®¡å…ƒéŸ³å­—æ¯åºåˆ—çš„æ•°ç›®](https://leetcode-cn.com/problems/count-vowels-permutation/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/count-vowels-permutation/solution/gong-shui-san-xie-yi-ti-shuang-jie-xian-n8f4o/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [1751. æœ€å¤šå¯ä»¥å‚åŠ çš„ä¼šè®®æ•°ç›® II](https://leetcode-cn.com/problems/maximum-number-of-events-that-can-be-attended-ii/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/maximum-number-of-events-that-can-be-attended-ii/solution/po-su-dp-er-fen-dp-jie-fa-by-ac_oier-88du/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤© |
| [1787. ä½¿æ‰€æœ‰åŒºé—´çš„å¼‚æˆ–ç»“æœä¸ºé›¶](https://leetcode-cn.com/problems/make-the-xor-of-all-segments-equal-to-zero/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/make-the-xor-of-all-segments-equal-to-zero/solution/gong-shui-san-xie-chou-xiang-cheng-er-we-ww79/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [å‰‘æŒ‡ Offer 10- I. æ–æ³¢é‚£å¥‘æ•°åˆ—](https://leetcode-cn.com/problems/fei-bo-na-qi-shu-lie-lcof/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/fei-bo-na-qi-shu-lie-lcof/solution/gong-shui-san-xie-yi-ti-si-jie-dong-tai-9zip0/) | ç®€å• | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [å‰‘æŒ‡ Offer 42. è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ](https://leetcode-cn.com/problems/lian-xu-zi-shu-zu-de-zui-da-he-lcof/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/lian-xu-zi-shu-zu-de-zui-da-he-lcof/solution/gong-shui-san-xie-jian-dan-xian-xing-dp-mqk5v/) | ç®€å• | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |
| [LCP 07. ä¼ é€’ä¿¡æ¯](https://leetcode-cn.com/problems/chuan-di-xin-xi/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/chuan-di-xin-xi/solution/gong-shui-san-xie-tu-lun-sou-suo-yu-dong-cyxo/) | ç®€å• | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤© |

**æ³¨ï¼šä»¥ä¸Šç›®å½•æ•´ç†æ¥è‡ª [wiki](https://github.com/SharingSource/LogicStack-LeetCode/wiki/çº¿æ€§-DP)ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½å¼•ç”¨è¯·ä¿ç•™å‡ºå¤„ã€‚**

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) å’Œ åŠ å…¥æˆ‘ä»¬çš„[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~