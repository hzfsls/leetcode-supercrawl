## [1473.ç²‰åˆ·æˆ¿å­ III ä¸­æ–‡çƒ­é—¨é¢˜è§£1](https://leetcode.cn/problems/paint-house-iii/solutions/100000/gong-shui-san-xie-san-wei-dong-tai-gui-h-ud7m)

ä½œè€…ï¼š[AC_OIer](https://leetcode.cn/u/AC_OIer)

## åŠ¨æ€è§„åˆ’

**å®šä¹‰ $f[i][j][k]$ ä¸ºè€ƒè™‘å‰ $i$ é—´æˆ¿å­ï¼Œä¸”ç¬¬ $i$ é—´æˆ¿å­çš„é¢œè‰²ç¼–å·ä¸º $j$ï¼Œå‰ $i$ é—´æˆ¿å­å½¢æˆçš„åˆ†åŒºæ•°é‡ä¸º $k$ çš„æ‰€æœ‰æ–¹æ¡ˆä¸­çš„ã€Œæœ€å°ä¸Šè‰²æˆæœ¬ã€ã€‚**

æˆ‘ä»¬ä¸å¤±ä¸€èˆ¬æ€§çš„è€ƒè™‘ $f[i][j][k]$ è¯¥å¦‚ä½•è½¬ç§»ï¼Œç”±äºæŸäº›æˆ¿å­æœ¬èº«å°±å·²ç»ä¸Šè‰²ï¼Œä¸Šè‰²çš„æˆ¿å­æ˜¯ä¸å…è®¸è¢«ç²‰åˆ·çš„ã€‚

æˆ‘ä»¬å¯ä»¥æ ¹æ®ç¬¬ $i$ é—´æˆ¿å­æ˜¯å¦å·²ç»è¢«ä¸Šè‰²ï¼Œè¿›è¡Œåˆ†æƒ…å†µè®¨è®ºï¼š

* ç¬¬ $i$ é—´æˆ¿å­å·²ç»è¢«ä¸Šè‰²ï¼Œå³ $houses[i] != 0$ï¼Œæ­¤æ—¶åªæœ‰æ»¡è¶³ $j == houses[i]$ çš„çŠ¶æ€æ‰æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå…¶ä½™çŠ¶æ€å‡ä¸º `INF`ã€‚
    åŒæ—¶æ ¹æ®ã€Œç¬¬ $i$ é—´æˆ¿å­çš„é¢œè‰² $j$ã€ä¸ã€Œç¬¬ $i - 1$ é—´æˆ¿å­çš„é¢œè‰² $p$ã€æ˜¯å¦ç›¸åŒï¼Œä¼šå†³å®šç¬¬ $i$ é—´æˆ¿å­æ˜¯å¦å½¢æˆä¸€ä¸ªæ–°çš„åˆ†åŒºã€‚è¿™åŒæ ·éœ€è¦è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºã€‚
    æ•´ç†åçš„è½¬ç§»æ–¹ç¨‹ä¸ºï¼š

$$ f[i][j][k]=\begin{cases}
min(f[i - 1][j][k], f[i - 1][p][k - 1]) &j == houses[i], p != j\\
INF & j != houses[i]
\end{cases}$$


* ç¬¬ $i$ é—´æˆ¿å­å°šæœªè¢«ä¸Šè‰²ï¼Œå³ $houses[i] == 0$ï¼Œæ­¤æ—¶æˆ¿å­å¯ä»¥è¢«ç²‰åˆ·æˆä»»æ„é¢œè‰²ã€‚ä¸ä¼šæœ‰æ— æ•ˆçŠ¶æ€çš„æƒ…å†µã€‚
  åŒæ ·ï¼Œæ ¹æ®ã€Œç¬¬ $i$ é—´æˆ¿å­çš„é¢œè‰² $j$ã€ä¸ã€Œç¬¬ $i - 1$ é—´æˆ¿å­çš„é¢œè‰² $p$ã€æ˜¯å¦ç›¸åŒï¼Œä¼šå†³å®šç¬¬ $i$ é—´æˆ¿å­æ˜¯å¦å½¢æˆä¸€ä¸ªæ–°çš„åˆ†åŒºã€‚
    è½¬ç§»æ–¹ç¨‹ä¸ºï¼š

$$ f[i][j][k] = min(f[i - 1][j][k], f[i - 1][p][k - 1]) + cost[i][j - 1], p != j $$

ä¸€äº›ç¼–ç ç»†èŠ‚ï¼š

* ä¸‹æ ‡è½¬æ¢ï¼šè¿™æ˜¯ä¸ªäººä¹ æƒ¯ï¼Œæ— è®ºåšä»€ä¹ˆé¢˜ï¼Œæˆ‘éƒ½å–œæ¬¢å°†ä¸‹æ ‡è½¬æ¢ä¸ºä» $1$ å¼€å§‹ï¼Œç›®çš„æ˜¯ä¸ºäº†ã€ŒèŠ‚çœè´Ÿå€¼ä¸‹æ ‡çš„åˆ†æƒ…å†µè®¨è®ºã€ã€ã€Œå°†æ— æ•ˆçŠ¶æ€é™åˆ¶åœ¨ $0$ ä¸‹æ ‡å†…ã€æˆ–è€…ã€Œå……å½“å“¨å…µã€ç­‰ç­‰ã€‚
* å°† `0x3f3f3f3f` ä½œä¸º `INF`ï¼šå› ä¸ºç›®æ ‡æ˜¯æ±‚æœ€å°å€¼ï¼Œæˆ‘ä»¬åº”å½“ä½¿ç”¨ä¸€ä¸ªè¾ƒå¤§å€¼å……å½“æ­£æ— ç©·ï¼Œæ¥å…³è”æ— æ•ˆçŠ¶æ€ã€‚åŒæ—¶ä¸ºäº†ç¡®ä¿ä¸ä¼šå‡ºç°ã€Œåœ¨æ­£æ— ç©·åŸºç¡€ä¸Šç´¯åŠ å¯¼è‡´ä¸¢å¤±æ­£æ— ç©·å«ä¹‰ã€çš„æ­§ä¹‰æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰ã€Œç´¯åŠ ç©ºé—´ã€çš„å€¼ä½œä¸ºã€Œæ­£æ— ç©·ã€ï¼ˆè¿™ä¸ªé—®é¢˜åˆšå¥½æœ€è¿‘åœ¨ [è¿™é‡Œ](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247486435&idx=1&sn=2464b01e9c0fb8d81fcea6dd4ed0ec92&chksm=fd9ca0fccaeb29ea9947456290099143c5bc9bdea0ccfb2408f5fd63f5e0fc13fcd8060d4251&token=515378286&lang=zh_CN#rd) ä¸“é—¨è®²è¿‡ï¼‰ã€‚

**ä»£ç ï¼ˆæ„Ÿè°¢ [@ğŸ­å¯ä¹å¯ä¹å—QAQ](/u/littletime_cc/) å’Œ [@ã€â€–â€” Ë‡ â€”â€–ã€](/u/kiedatamashi/) ä¸¤ä½åŒå­¦æä¾›çš„å…¶ä»–è¯­è¨€ç‰ˆæœ¬ï¼‰ï¼š**
```Java []
class Solution {
    int INF = 0x3f3f3f3f;
    public int minCost(int[] hs, int[][] cost, int m, int n, int t) {
        int[][][] f = new int[m + 1][n + 1][t + 1];

        // ä¸å­˜åœ¨åˆ†åŒºæ•°é‡ä¸º 0 çš„çŠ¶æ€
        for (int i = 0; i <= m; i++) {
            for (int j = 0; j <= n; j++) {
                f[i][j][0] = INF;
            }
        }

        for (int i = 1; i <= m; i++) {
            int color = hs[i - 1];
            for (int j = 1; j <= n; j++) {
                for (int k = 1; k <= t; k++) {
                    // å½¢æˆåˆ†åŒºæ•°é‡å¤§äºæˆ¿å­æ•°é‡ï¼ŒçŠ¶æ€æ— æ•ˆ
                    if (k > i) {
                        f[i][j][k] = INF;
                        continue;
                    }

                    // ç¬¬ i é—´æˆ¿é—´å·²ç»ä¸Šè‰²
                    if (color != 0) {
                        if (j == color) { // åªæœ‰ä¸ã€Œæœ¬æ¥çš„é¢œè‰²ã€ç›¸åŒçš„çŠ¶æ€æ‰å…è®¸è¢«è½¬ç§»
                            int tmp = INF;
                            // å…ˆä»æ‰€æœ‰ã€Œç¬¬ i é—´æˆ¿å½¢æˆæ–°åˆ†åŒºã€æ–¹æ¡ˆä¸­é€‰æœ€ä¼˜ï¼ˆå³ä¸ä¸Šä¸€æˆ¿é—´é¢œè‰²ä¸åŒï¼‰
                            for (int p = 1; p <= n; p++) {
                                if (p != j) {
                                    tmp = Math.min(tmp, f[i - 1][p][k - 1]);
                                }
                            }
                            // å†ç»“åˆã€Œç¬¬ i é—´æˆ¿ä¸å½¢æˆæ–°åˆ†åŒºã€æ–¹æ¡ˆä¸­é€‰æœ€ä¼˜ï¼ˆå³ä¸ä¸Šä¸€æˆ¿é—´é¢œè‰²ç›¸åŒï¼‰
                            f[i][j][k] = Math.min(f[i - 1][j][k], tmp);
                        
                        } else { // å…¶ä½™çŠ¶æ€æ— æ•ˆ  
                            f[i][j][k] = INF;
                        }

                    // ç¬¬ i é—´æˆ¿é—´å°šæœªä¸Šè‰²
                    } else {
                        int u = cost[i - 1][j - 1]; 
                        int tmp = INF;
                        // å…ˆä»æ‰€æœ‰ã€Œç¬¬ i é—´æˆ¿å½¢æˆæ–°åˆ†åŒºã€æ–¹æ¡ˆä¸­é€‰æœ€ä¼˜ï¼ˆå³ä¸ä¸Šä¸€æˆ¿é—´é¢œè‰²ä¸åŒï¼‰
                        for (int p = 1; p <= n; p++) {
                            if (p != j) {
                                tmp = Math.min(tmp, f[i - 1][p][k - 1]);
                            }
                        }
                        // å†ç»“åˆã€Œç¬¬ i é—´æˆ¿ä¸å½¢æˆæ–°åˆ†åŒºã€æ–¹æ¡ˆä¸­é€‰æœ€ä¼˜ï¼ˆå³ä¸ä¸Šä¸€æˆ¿é—´é¢œè‰²ç›¸åŒï¼‰
                        // å¹¶å°†ã€Œä¸Šè‰²æˆæœ¬ã€æ·»åŠ è¿›å»
                        f[i][j][k] = Math.min(tmp, f[i - 1][j][k]) + u;
                    }
                }
            }
        }

        // ä»ã€Œè€ƒè™‘æ‰€æœ‰æˆ¿é—´ï¼Œå¹¶ä¸”å½¢æˆåˆ†åŒºæ•°é‡ä¸º tã€çš„æ‰€æœ‰æ–¹æ¡ˆä¸­æ‰¾ç­”æ¡ˆ
        int ans = INF;
        for (int i = 1; i <= n; i++) {
            ans = Math.min(ans, f[m][i][t]);
        }
        return ans == INF ? -1 : ans;
    }
}
```
```C++ []
const int INF = 0x3f3f3f3f;  //INF + INF ä¸ä¼šçˆ†int
int f[105][25][105];

class Solution {
public:
    int minCost(vector<int>& houses, vector<vector<int>>& cost, int m, int n, int target) {
        //æ— æ•ˆçš„çŠ¶æ€
        for(int i = 0; i <= m; i++){
            for(int j = 0; j <= n; j++){
                f[i][j][0] = INF;
            }
        }

        for(int i = 1; i <= m; i++){
            int color = houses[i - 1];
            for(int j = 1; j <= n;j++){
                for(int k = 1; k <= target; k++){
                    if(k > i) {
                        f[i][j][k] = INF;
                        continue;
                    }
                    //ç¬¬iä¸ªæˆ¿é—´å·²ç»ä¸Šè‰²
                    if(color != 0){
                        if(j == color){
                            int cur = INF;
                            //ä¸ä¸Šä¸€ä¸ªæˆ¿é—´é¢œè‰²ä¸åŒ
                            for(int p = 1; p <= n; p++){
                                if(p != j){ //é¢œè‰²ä¸åŒ
                                    cur = min(cur,f[i - 1][p][k - 1]);
                                }
                            }
                            //ä¸ä¸Šä¸€ä¸ªæˆ¿é—´é¢œè‰²ç›¸åŒ
                            f[i][j][k] = min(cur,f[i - 1][j][k]);
                        }
                        else f[i][j][k] = INF; //å…¶ä»–ä¸ºæ— æ•ˆçŠ¶æ€
                    }    
                    else{ //ç¬¬iä¸ªæˆ¿é—´æœªä¸Šè‰²
                        int u = cost[i - 1][j - 1];
                        //è€ƒè™‘ç¬¬iä¸ªæˆ¿é—´æ˜¯å¦å½¢æˆæ–°çš„åˆ†åŒº
                        //ä¸ä¸Šä¸€ä¸ªæˆ¿é—´é¢œè‰²ä¸åŒï¼Œå½¢æˆæ–°åˆ†åŒº
                        int cur = INF;
                        for(int p = 1; p <= n; p++){
                            if(p != j) cur = min(cur,f[i - 1][p][k - 1] + u);
                        }
                        //ä¸ä¸Šä¸€ä¸ªæˆ¿é—´é¢œè‰²ç›¸åŒï¼Œä¸å½¢æˆæ–°çš„åˆ†åŒº
                        f[i][j][k] = min(cur,f[i - 1][j][k] + u);
                    }   
                }
            }
        }
        
        int ans = INF;
        for(int i = 1; i <= n; i++){
            ans = min(ans,f[m][i][target]);
        }
        return ans == INF ? -1 : ans;
    }
};
```
```Python3 []
class Solution:
    def minCost(self, houses: List[int], cost: List[List[int]], m: int, n: int, target: int) -> int:
        INF = float("inf")
        f = [[[0]*(target+1) for _ in range(n+1)] for _ in range(m+1)]
        for i in range(m+1):
            for j in range(n+1):
                f[i][j][0] = INF
        for i in range(1,m+1):
            color = houses[i-1]
            for j in range(1,n+1):
                for k in range(1,target+1):
                    if k>i:
                        f[i][j][k] = INF
                        continue
                    if color!=0: #å·²ç»ä¸Šè‰²
                        if j==color:
                            tmp = INF
                            for p in range(1,n+1):
                                if p!=j:
                                    tmp = min(tmp,f[i-1][p][k-1]) # æœ‰æ–°åˆ†åŒºé‡Œçš„æœ€å°
                            f[i][j][k] = min(f[i-1][j][k],tmp) # æ²¡æœ‰æ–°åˆ†åŒº or æœ‰æ–°åˆ†åŒº
                        else:
                            f[i][j][k] = INF
                    # æˆ¿é—´æ²¡ä¸Šè‰²
                    else:
                        u = cost[i-1][j-1]
                        tmp = INF
                        # å½¢æˆæ–°åˆ†åŒºçš„æœ€ä¼˜æƒ…å†µ
                        for p in range(1,n+1):
                            if p!=j:
                                tmp = min(tmp,f[i-1][p][k-1])
                        # ç®—ä¸Šæ²¡æœ‰æ–°åˆ†åŒº
                        f[i][j][k] = min(f[i-1][j][k],tmp)+u
        res = INF
        for i in range(1,n+1):
            res = min(res,f[m][i][target])
        return -1 if res == INF else res
```
* æ—¶é—´å¤æ‚åº¦ï¼šå…±æœ‰ $m * n * t$ ä¸ªçŠ¶æ€éœ€è¦è¢«è½¬ç§»ï¼Œæ¯æ¬¡è½¬ç§»éœ€è¦æšä¸¾ã€Œæ‰€ä¾èµ–çš„çŠ¶æ€ã€çš„é¢œè‰²ï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(m * n^2 * t)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m * n * t)$

***

## çŠ¶æ€å®šä¹‰çš„ç”±æ¥

å¯¹äºæœ‰ä¸€å®š DP åˆ·é¢˜é‡çš„åŒå­¦æ¥è¯´ï¼Œä¸Šè¿°çš„ã€ŒçŠ¶æ€å®šä¹‰ã€åº”è¯¥å¾ˆå¥½ç†è§£ã€‚

**æ ¹æ®ç»éªŒï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“ç¡®å®šã€Œæˆ¿é—´ç¼–å·ç»´åº¦ $i$ã€å’Œã€Œåˆ†åŒºæ•°é‡ç»´åº¦ $k$ã€éœ€è¦çº³å…¥è€ƒè™‘ï¼ŒåŒæ—¶ä¸ºäº†åœ¨è½¬ç§»è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ¸…æ¥šçŸ¥é“ä»å“ªäº›çŠ¶æ€è½¬ç§»è¿‡æ¥éœ€è¦å¢åŠ ã€Œåˆ†åŒºæ•°é‡ã€ï¼Œå“ªäº›çŠ¶æ€è½¬ç§»è¿‡æ¥ä¸éœ€è¦å¢åŠ ï¼Œå› æ­¤éœ€è¦å¤šå¼•å…¥ã€Œæœ€åä¸€é—´æˆ¿é—´é¢œè‰² $j$ã€ç»´åº¦ã€‚**

è‡³äºå¯¹ DP ä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œå¯ä»¥ä»å†™ã€Œçˆ†æœã€å¼€å§‹å…¥æ‰‹ã€‚

**è¿™é‡Œçš„â€œå†™â€ä¸ä¸€å®šçœŸçš„è¦åŠ¨æ‰‹å»å®ç°ä¸€ä¸ªå®Œæ•´çš„ã€Œçˆ†æœã€æ–¹æ¡ˆï¼Œåªéœ€è¦åˆç†è®¾è®¡å‡ºæ¥ `DFS` å‡½æ•°ç­¾åå³å¯ã€‚**

ä½†ä¸ºäº†æ›´å¥½ç†è§£ï¼Œæˆ‘å†™äº†ä¸€ä¸ªå®Œæ•´ç‰ˆçš„ä¾›ä½ å‚è€ƒã€‚

ä»£ç ï¼š
```Java []
class Solution {
    int INF = 0x3f3f3f3f;
    int ans = INF;
    int[] hs;
    int[][] cost;
    int m, n, t;
    public int minCost(int[] _hs, int[][] _cost, int _m, int _n, int _t) {
        m = _m; n = _n; t = _t;
        hs = _hs;
        cost = _cost;
        dfs(0, -1, 0, 0);
        return ans == INF ? -1 : ans;
    }
    // u : å½“å‰å¤„ç†åˆ°çš„æˆ¿é—´ç¼–å·
    // last : å½“å‰å¤„ç†çš„æˆ¿é—´é¢œè‰²
    // cnt : å½“å‰å½¢æˆçš„åˆ†åŒºæ•°é‡
    // sum : å½“å‰çš„ä¸Šè‰²æˆæœ¬
    void dfs(int u, int last, int cnt, int sum) {
        if (sum >= ans || cnt > t) return;
        if (u == m) {
            if (cnt == t) {
                ans = Math.min(ans, sum);
            }
            return;
        }
        int color = hs[u];
        if (color == 0) {
            for (int i = 1; i <= n; i++) {
                int nCnt = u - 1 < 0 ? 1 : last == i ? cnt : cnt + 1; 
                dfs(u + 1, i, nCnt, sum + cost[u][i - 1]);
            }
        } else {
            int nCnt = u - 1 < 0 ? 1 : last == color ? cnt : cnt + 1; 
            dfs(u + 1, color, nCnt, sum);
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š`n` ä¸ºé¢œè‰²æ•°é‡ï¼Œ`m` ä¸ºæˆ¿é—´æ•°é‡ã€‚ä¸è€ƒè™‘å‰ªææ•ˆæœï¼Œæ¯ä¸ªæˆ¿é—´éƒ½å¯ä»¥ç²‰åˆ· `n` ç§é¢œè‰²ï¼Œå¤æ‚åº¦ä¸ºæŒ‡æ•°çº§åˆ«çš„ $O(n^m)$
* ç©ºé—´å¤æ‚åº¦ï¼šå¿½ç•¥é€’å½’å¸¦æ¥çš„é¢å¤–ç©ºé—´å¼€é”€ã€‚å¤æ‚åº¦ä¸º $O(1)$

å¯ä»¥å‘ç°ï¼Œ`DFS` çš„å¯å˜å‚æ•°æœ‰å››ä¸ªï¼Œå…¶ä¸­ `sum` æ˜¯ç”¨äºæ›´æ–°æœ€ç»ˆç­”æ¡ˆ `ans` çš„ï¼Œå…¶åº”è¯¥ä½œä¸ºåŠ¨è§„å€¼ï¼Œå…¶ä½™ä¸‰ä¸ªå‚æ•°ï¼Œä½œä¸ºåŠ¨è§„æ•°ç»„çš„ä¸‰ä¸ªç»´åº¦ã€‚

è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šåŠ¨æ€è§„åˆ’çš„ã€ŒçŠ¶æ€å®šä¹‰ã€ï¼Œå…³äºå¦‚ä½•åˆ©ç”¨è¿™ç§ã€ŒæŠ€å·§ã€æ¥å¾—åˆ°ä¸€ä¸ªå¯é çš„ã€ŒçŠ¶æ€å®šä¹‰ã€æœ€æ—©åœ¨ [è¿™é‡Œ](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247485319&idx=1&sn=95a3dc9c97ca57185de792ca70924afe&chksm=fd9cac98caeb258ebea466f59378670a90af1cb3015ae70922e1d04ac711a5b8d8d853ac5e7d&token=515378286&lang=zh_CN#rd) è®²è¿‡ã€‚

***

## è®°å¿†åŒ–æœç´¢

çœ‹åˆ°è¯„è®ºåŒºæœ‰åŒå­¦è´´äº†ã€Œè®°å¿†åŒ–æœç´¢ã€çš„ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå°±ä½œä¸ºè¡¥å……å¢åŠ åˆ°é¢˜è§£å§ ~ 

æ³¨æ„è®°å¿†åŒ–å®¹å™¨åº”å½“ä¸æˆ‘ä»¬çš„ã€ŒåŠ¨è§„æ•°ç»„ã€ç»“æ„ä¿å­˜ä¸€è‡´ã€‚

**ä»£ç ï¼ˆæ„Ÿè°¢ [@ğŸ­å¯ä¹å¯ä¹å—QAQ](/u/littletime_cc/) å’Œ [@Benhao](/u/qubenhao/) åŒå­¦æä¾›çš„å…¶ä»–è¯­è¨€ç‰ˆæœ¬ï¼‰ï¼š**
```Java []
class Solution {
    int INF = 0x3f3f3f3f;
    int m, n, t;
    int[] hs;
    int[][] cost;
    boolean[][][] vis;
    int[][][] cache;
    public int minCost(int[] _hs, int[][] _cost, int _m, int _n, int _t) {
        m = _m; n = _n; t = _t;
        hs = _hs;
        cost = _cost;
        vis = new boolean[m + 1][n + 1][t + 1];
        cache = new int[m + 1][n + 1][t + 1];
        int ans = dfs(0, 0, 0, 0);
        return ans == INF ? -1 : ans;
    }
    int dfs(int u, int last, int cnt, int sum){
        if(cnt > t) return INF;
        if(vis[u][last][cnt]) return cache[u][last][cnt];
        if (u == m) return cnt == t ? 0 : INF;
        int ans = INF;
        int color = hs[u];
        if(color == 0){
            for(int i = 1; i <= n; i++){
                int nCnt = u == 0 ? 1 : last == i ? cnt : cnt + 1;
                int cur = dfs(u + 1, i, nCnt, sum + cost[u][i - 1]);
                ans = Math.min(ans, cur + cost[u][i - 1]);
            }
        } else{
            int nCnt = u == 0 ? 1 : last == color ? cnt : cnt + 1;
            int cur = dfs(u + 1, color, nCnt, sum);
            ans = Math.min(ans, cur);
        }
        vis[u][last][cnt] = true;
        cache[u][last][cnt] = ans;
        return ans;
    }
}
```
```C++ []
int f[105][25][105];
const int INF = 0x3f3f3f3f;

class Solution {
public:
    int minCost(vector<int>& houses, vector<vector<int>>& cost, int m, int n, int target) {
        memset(f,-1,sizeof f); 
        /*
        u: å½“å‰å¤„ç†åˆ°çš„æˆ¿é—´ç¼–å·
        pre: å½“å‰å¤„ç†çš„æˆ¿é—´é¢œè‰²
        cnt: å½“å‰åˆ†åŒºçš„æ•°é‡
        cur: å½“å‰çš„ä¸Šè‰²æˆæœ¬
        */
        //è®°å¿†åŒ–æœç´¢
        function<int(int,int,int,int)> dfs = [&](int u,int pre,int cnt,int cur){
            if(cnt > target) return INF;
            if(u >= m) return cnt == target ? 0 : INF;
            if(f[u][pre][cnt] != -1) return f[u][pre][cnt];
            int color = houses[u];
            int ans = INF;
            if(color == 0){
                for(int i = 1; i <= n; i++){
                    int new_cnt = u == 0 ? 1 : pre == i ? cnt : cnt + 1;
                    int cur = dfs(u + 1,i,new_cnt,cur + cost[u][i - 1]);
                    if(cur == INF) continue;
                    ans = min(ans,cur + cost[u][i - 1]);
                }
            }
            else{
                int new_cnt = u == 0 ? 1 : pre == color ? cnt : cnt + 1;
                int cur = dfs(u + 1,color,new_cnt,cur);
                ans = min(ans,cur);
            }
            return f[u][pre][cnt] = ans;
        };

        int ans = dfs(0,0,0,0);
        return ans == INF ? -1 : ans;
    }
};
```
```Python3 []
class Solution:
    def minCost(self, houses: List[int], cost: List[List[int]], m: int, n: int, target: int) -> int:
        @lru_cache(None)
        def dfs(idx, color, t):
            if t < 0 or t > m - idx:
                return float("inf")
            if idx == m:
                return 0
            curr = float("inf")
            if houses[idx]:
                if houses[idx] != color:
                    curr = min(curr, dfs(idx + 1, houses[idx], t - 1))
                else:
                    curr = min(curr, dfs(idx + 1, houses[idx], t))
            else:
                for i in range(1, n + 1):
                    if i != color:
                        curr = min(curr, dfs(idx + 1, i, t - 1) + cost[idx][i - 1])
                    else:
                        curr = min(curr, dfs(idx + 1, i, t) + cost[idx][i - 1])
            return curr

        res = dfs(0, 0, target)
        if res == float("inf"):
            return -1
        return res
```
* æ—¶é—´å¤æ‚åº¦ï¼šå…±æœ‰ $m * n * t$ ä¸ªçŠ¶æ€éœ€è¦è¢«è½¬ç§»ï¼Œæ¯æ¬¡è½¬ç§»éœ€è¦æšä¸¾ã€Œæ‰€ä¾èµ–çš„çŠ¶æ€ã€çš„é¢œè‰²ï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(m * n^2 * t)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m * n * t)$

***

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) å’Œ åŠ å…¥æˆ‘ä»¬çš„[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ 
