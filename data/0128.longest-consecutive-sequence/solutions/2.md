## [128.æœ€é•¿è¿ç»­åºåˆ— ä¸­æ–‡çƒ­é—¨é¢˜è§£2](https://leetcode.cn/problems/longest-consecutive-sequence/solutions/100000/xiao-bai-lang-ha-xi-ji-he-ha-xi-biao-don-j5a2)

ä½œè€…ï¼š[yimeixiaobai](https://leetcode.cn/u/yimeixiaobai)
### æ ‡é¢˜æŒ‡å¼•
æœ¬æ–‡ä¸€å…±ä¼šä»‹ç»å››ç§æ€è·¯ï¼Œå¯æŒ‰éœ€é£Ÿç”¨ã€‚

- æ–¹æ³•1 å“ˆå¸Œé›†åˆï¼ˆæœ€æ™®éä¹Ÿæœ€ç®€å•çš„æ€è·¯ï¼Œå¿…é¡»æŒæ¡ï¼‰
- æ–¹æ³•2 å“ˆå¸Œè¡¨ï¼ˆæ€è·¯1çš„è¿›é˜¶ï¼‰
- æ–¹æ³•3 åŠ¨æ€è§„åˆ’ï¼ˆæå…¶å·§å¦™ï¼Œæ¨èæŒæ¡ï¼‰
- æ–¹æ³•4 å¹¶æŸ¥é›†ï¼ˆå»ºè®®æŒæ¡ï¼‰

> æ­¤é¢˜ä¸ºå¤§å‚é¢è¯•é«˜é¢‘æ‰‹æ’•é¢˜ï¼Œå¸Œæœ›å¤§å®¶èƒ½é‡è§†è¿™é“é¢˜ã€‚

### é¢˜ç›®åˆ†æ

çœ‹åˆ°æœ¬é¢˜æ‰¾æœ€é•¿è¿ç»­åºåˆ—ï¼Œæ¯ä¸ªäººéƒ½ä¼šæƒ³åˆ°ä¸¤ç§æœ€æœ´ç´ çš„è§£æ³•ä¹‹ä¸€ï¼š
1. å…ˆæ’åºï¼Œä»å‰å¾€åæ‰¾æœ€é•¿è¿ç»­ä¸Šå‡åºåˆ—å³å¯ã€‚è¯¥æ€è·¯ç®€å•æœ‰æ•ˆï¼Œä½†æ˜¯å¤æ‚åº¦å·²ç»è‡³å°‘æœ‰$O(nlogn)$ã€‚å®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåœ¨æ­¤ä¸è®¨è®ºè¯¥è§£æ³•ã€‚
2. éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ numï¼Œç„¶åä»¥numä¸ºèµ·ç‚¹ï¼Œæ¯æ¬¡+1å‘åéå†num+1,num+2,num+3...ï¼Œåˆ¤æ–­è¿™äº›å…ƒç´ æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­ã€‚å‡è®¾æ‰¾åˆ°çš„æœ€å¤§çš„è¿ç»­å­˜åœ¨çš„å…ƒç´ ä¸ºnum+xï¼Œé‚£ä¹ˆè¿™ä¸ªè¿ç»­åºåˆ—çš„é•¿åº¦å³ä¸ºx+1ã€‚æœ€åå°†æ¯ä¸ªnumæ‰€å¼€å§‹åºåˆ—é•¿åº¦å–ä¸ªæœ€å¤§å€¼å³å¯ã€‚
è¿™ä¸ªæ€è·¯å¾ˆé€šä¿—æ˜“æ‡‚ï¼Œå®ç°æˆä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

> è¯¥ä»£ç ä¸æ˜¯é‡ç‚¹ï¼Œçœ‹ä¸çœ‹æ— æ‰€è°“ã€‚

```java
class Solution {
    public int longestConsecutive(int[] nums) {
        int n = nums.length;
        int ans = 0;
        // éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ num
        for (int i = 0; i < n; i++) {
            // ä»¥numä¸ºèµ·ç‚¹ï¼Œæ¯æ¬¡+1å‘åéå†num+1,num+2,num+3...
            int cur = nums[i] + 1;
            while (true) {
                // æ ‡è¯†æ˜¯å¦åœ¨æ•°ç»„ä¸­æ‰¾åˆ°äº†cur
                boolean flag = false;
                // åœ¨æ•°ç»„ä¸­æ‰¾cur
                for (int j = 0; j < n; j++) {
                    if (nums[j] == cur) {
                        flag = true;
                        break;
                    }
                }
                if (!flag) {
                    break;
                }
                cur += 1;
            }
            ans = Math.max(ans, cur - nums[i]);
        }
        return ans;
    }
}
```

### è§£é¢˜æ€è·¯1ï¼šå“ˆå¸Œé›†åˆ

ä¸Šé¢çš„ä»£ç ä¸ç”¨æƒ³ï¼Œæ˜¯è‚¯å®šè¶…æ—¶çš„ã€‚å®ƒçš„æœ€åæ—¶é—´å¤æ‚åº¦å·²ç»è¾¾åˆ°äº†$O(n^3)$ï¼Œæˆ‘ä»¬éœ€è¦ä¼˜åŒ–ä»£ç ã€‚ä¼˜åŒ–çš„ç‚¹ä¸»è¦æœ‰ä¸¤ä¸ªï¼š
ï¼ˆ1ï¼‰åˆ¤æ–­num+1ï¼Œnum+2ï¼Œnum+3...æ˜¯å¦åœ¨æ•°ç»„ä¸­ã€‚ä¸Šé¢çš„ä»£ç æ˜¯ç”¨ç›´æ¥éå†çš„æ–¹å¼å»æŸ¥æ‰¾çš„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ä¸ºå“ˆå¸Œè¡¨æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(1)$ã€‚
ï¼ˆ2ï¼‰éå†æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ numã€‚é€ä¸€éå†æ¯ä¸ªå…ƒç´ ä¼šäº§ç”Ÿå¾ˆå¤šå†—ä½™å·¥ä½œï¼Œå®é™…ä¸Šæˆ‘ä»¬æ— éœ€ä¸€æ¬¡é’ˆå¯¹æ¯ä¸ªå…ƒç´ numå»åˆ¤æ–­num+1ï¼Œnum+2ï¼Œnum+3...æ˜¯å¦åœ¨æ•°ç»„ä¸­ã€‚å¦‚æœnum-1å·²ç»åœ¨æ•°ç»„ä¸­çš„è¯ï¼Œé‚£ä¹ˆnum-1è‚¯å®šä¼šè¿›è¡Œç›¸åº”çš„+1éå†ï¼Œç„¶åéå†åˆ°numï¼Œè€Œä¸”ä»num-1å¼€å§‹çš„+1éå†å¿…å®šæ¯”ä»numå¼€å§‹çš„+1éå†å¾—åˆ°çš„åºåˆ—é•¿åº¦æ›´é•¿ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¾¿å¯å°†åœ¨ä¸€ä¸ªè¿ç»­åºåˆ—ä¸­çš„å…ƒç´ è¿›è¡Œåˆ å‡ï¼Œè®©å…¶åªåœ¨æœ€å°çš„å…ƒç´ æ‰å¼€å§‹+1éå†ã€‚æ¯”å¦‚ï¼Œç°æœ‰å…ƒç´ [1,2,4,3,5]ï¼Œå½“2,3,4,5å‘ç°å‡æœ‰æ¯”è‡ªå·±å°1çš„å…ƒç´ å­˜åœ¨ï¼Œé‚£ä¹ˆå®ƒä»¬å°±ä¸ä¼šå¼€å§‹+1éå†ï¼Œè€Œ1æ˜¯è¿ç»­åºåˆ—ä¸­æœ€å°çš„å…ƒç´ ï¼Œæ²¡æœ‰æ¯”è‡ªå·±å°1çš„å…ƒç´ å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šå¼€å§‹+1éå†ã€‚é€šè¿‡ä¸Šè¿°æ–¹å¼ä¾¿å¯å°†æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–è‡³O(n)ã€‚

### ä»£ç 1

```java
class Solution {
    public int longestConsecutive(int[] nums) {
        // å»ºç«‹ä¸€ä¸ªå­˜å‚¨æ‰€æœ‰æ•°çš„å“ˆå¸Œè¡¨ï¼ŒåŒæ—¶èµ·åˆ°å»é‡åŠŸèƒ½
        Set<Integer> set = new HashSet<>();
        for (int num : nums) {
            set.add(num);
        }

        int ans = 0;
        // éå†å»é‡åçš„æ‰€æœ‰æ•°å­—
        for (int num : set) {
            int cur = num;
            // åªæœ‰å½“num-1ä¸å­˜åœ¨æ—¶ï¼Œæ‰å¼€å§‹å‘åéå†num+1ï¼Œnum+2ï¼Œnum+3......
            if (!set.contains(cur - 1)) {
                while (set.contains(cur + 1)) {
                    cur++;
                }
            }
            // [num, cur]ä¹‹é—´æ˜¯è¿ç»­çš„ï¼Œæ•°å­—æœ‰cur - num + 1ä¸ª
            ans = Math.max(ans, cur - num + 1);
        }
        return ans;
    }
}
```

> æ³¨æ„ï¼šä¸Šè¿°ä»£ç è™½ç„¶æœ‰ä¸¤å±‚å¾ªç¯for+whileï¼Œä½†æ˜¯ç”±äº`if (!set.contains(cur - 1))`åˆ¤æ–­çš„å­˜åœ¨ï¼Œæ¯ä¸ªå…ƒç´ åªä¼šè¢«éå†ä¸€æ¬¡ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¹Ÿä¸ºO(n)ã€‚


ä¸Šé¢æ˜¯ä¸€ç§æœ´ç´ æ€è·¯çš„ä¼˜åŒ–æ–¹æ³•ï¼Œä¸‹é¢å†ä»‹ç»ä¸‰ç§ç®—æ³•ï¼Œåˆ†åˆ«ä¸ºï¼š
1. ä½¿ç”¨å“ˆå¸Œè¡¨è®°å½•å½“å‰numèƒ½åˆ°è¾¾çš„è¿ç»­æœ€å³è¾¹ç•Œï¼›
2. ä½¿ç”¨å“ˆå¸Œè¡¨è®°å½•å½“å‰å€¼æ‰€åœ¨çš„è¿ç»­æœ€å¤§åŒºé—´ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰
3. å¹¶æŸ¥é›†


### è§£é¢˜æ€è·¯2ï¼šå“ˆå¸Œè¡¨è®°å½•å³è¾¹ç•Œ

è¿™ç§æ–¹æ³•å…¶å®ä¹Ÿæ˜¯æ€è·¯1çš„å˜ç§ï¼Œç”¨äºå‡å°‘éå†æ¬¡æ•°ã€‚åšæ³•æ˜¯å»ºç«‹ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œè®°å½•æ¯ä¸ªå…ƒç´ numèƒ½å¤Ÿè¿ç»­åˆ°è¾¾çš„å³è¾¹ç•Œï¼Œè¿™æ ·åœ¨å†…å±‚å¾ªç¯éå†åˆ°ä¸€ä¸ªæ–°å…ƒç´ æ—¶ï¼Œæ— éœ€ç»è¿‡å¤šæ¬¡+1ã€Œéå†+åˆ¤æ–­ã€æ‰èƒ½åˆ°è¾¾å³è¾¹ç•Œï¼Œç›´æ¥å–å€¼å³å¯ã€‚

### ä»£ç 2

```java
class Solution {
    public int longestConsecutive(int[] nums) {
        // keyè¡¨ç¤ºnumï¼Œvalueè¡¨ç¤ºnumæœ€è¿œåˆ°è¾¾çš„è¿ç»­å³è¾¹ç•Œ
        Map<Integer, Integer> map = new HashMap<>();
        // åˆå§‹åŒ–æ¯ä¸ªnumçš„å³è¾¹ç•Œä¸ºè‡ªå·±
        for (int num : nums) {
            map.put(num, num);
        }

        int ans = 0;
        for (int num : nums) {
            if (!map.containsKey(num - 1)) {
                int right = map.get(num);
                // éå†å¾—åˆ°æœ€è¿œçš„å³è¾¹ç•Œ
                while (map.containsKey(right + 1)) {
                    right = map.get(right + 1);
                }
                // æ›´æ–°å³è¾¹ç•Œ
                map.put(num, right);
                // æ›´æ–°ç­”æ¡ˆ
                ans = Math.max(ans, right - num + 1);
            }
            
        }
        return ans;
    }
}
```
> ä¹‹å‰æœ¬æ€è·¯ç»™å‡ºçš„ä»£ç å‡ºç°äº†æŸäº›é—®é¢˜ï¼Œç°å·²ä¿®æ­£ã€‚æ„Ÿè°¢è¯„è®ºåŒºå¤§ä½¬[@yan-shan](/u/yan-shan/)æŒ‡å‡ºé”™è¯¯ã€‚

### è§£é¢˜æ€è·¯3ï¼šå“ˆå¸Œè¡¨è®°å½•è¿ç»­åŒºé—´é•¿åº¦ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰

è¿™æ˜¯ä¸€ç§éå¸¸å·§å¦™çš„åšæ³•ï¼Œä¸æ€è·¯2ç›¸åŒçš„ä¸€ç‚¹æ˜¯ä¹Ÿåˆ©ç”¨äº†Mapå‡å°éå†æ¬¡æ•°ã€‚ä½†å¾ˆé‡è¦çš„ä¸€ç‚¹ä¸åŒæ˜¯å…¶valueè¡¨ç¤ºçš„æ˜¯numæ‰€åœ¨çš„è¿ç»­åŒºé—´é•¿åº¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“Mapçš„keyä¸º5ï¼Œvalueä¸º3æ—¶ï¼Œè¿™å°±è¡¨æ˜å½“å‰æœ‰ä¸€ä¸ªåŒ…å«5ä¸”é•¿åº¦ä¸º3çš„è¿ç»­åŒºé—´ï¼Œå½“ç„¶æœ‰å¤šç§å¯èƒ½ï¼Œå¯ä»¥æ˜¯[3,5],[4,6],[5,7]ã€‚

å…·ä½“åšæ³•æ˜¯ï¼š
1. éå†numsæ•°ç»„ä¸­çš„æ‰€æœ‰æ•°å­—num
2. å½“numæ˜¯ç¬¬ä¸€æ¬¡å‡ºç°æ—¶ï¼š
ï¼ˆ1ï¼‰åˆ†åˆ«è·å–åˆ°å·¦ç›¸é‚»æ•°å­—num-1çš„è¿ç»­åŒºé—´é•¿åº¦leftå’Œå³ç›¸é‚»æ•°å­—num+1çš„è¿ç»­åŒºé—´é•¿åº¦rightï¼›
ï¼ˆ2ï¼‰è®¡ç®—å¾—åˆ°å½“å‰çš„åŒºé—´é•¿åº¦ä¸º$curLen=left+right+1$ï¼›
ï¼ˆ3ï¼‰æ›´æ–°æœ€é•¿åŒºé—´é•¿åº¦ansä»¥åŠå·¦å³è¾¹ç•Œçš„åŒºé—´é•¿åº¦ã€‚

å¦‚æœä¸ç†è§£è¿™æ ·åšçš„åŸå› ï¼Œå¯ä»¥å…ˆçœ‹ä¸€éä»£ç ï¼Œå†çœ‹æˆ‘çš„åç»­è§£é‡Šã€‚

### ä»£ç 3

```java
class Solution {
    public int longestConsecutive(int[] nums) {
        // keyè¡¨ç¤ºnumï¼Œvalueè¡¨ç¤ºnumæ‰€åœ¨è¿ç»­åŒºé—´çš„é•¿åº¦
        Map<Integer, Integer> map = new HashMap<>();
        int ans = 0;
        for (int num : nums) {
            // å½“mapä¸­ä¸åŒ…å«numï¼Œä¹Ÿå°±æ˜¯numç¬¬ä¸€æ¬¡å‡ºç°
            if (!map.containsKey(num)) {
                // leftä¸ºnum-1æ‰€åœ¨è¿ç»­åŒºé—´çš„é•¿åº¦ï¼Œæ›´è¿›ä¸€æ­¥ç†è§£ä¸ºï¼šå·¦è¿ç»­åŒºé—´çš„é•¿åº¦
                int left = map.getOrDefault(num - 1, 0);
                // rightä¸ºnum+1æ‰€åœ¨è¿ç»­åŒºé—´çš„é•¿åº¦ï¼Œæ›´è¿›ä¸€æ­¥ç†è§£ä¸ºï¼šå³è¿ç»­åŒºé—´çš„é•¿åº¦
                int right = map.getOrDefault(num + 1, 0);
                // å½“å‰è¿ç»­åŒºé—´çš„æ€»é•¿åº¦
                int curLen = left + right + 1;
                ans = Math.max(ans, curLen);
                // å°†numåŠ å…¥mapä¸­ï¼Œè¡¨ç¤ºå·²ç»éå†è¿‡è¯¥å€¼ã€‚å…¶å¯¹åº”çš„valueå¯ä»¥ä¸ºä»»æ„å€¼ã€‚
                map.put(num, -1);
                // æ›´æ–°å½“å‰è¿ç»­åŒºé—´å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œå¯¹åº”çš„åŒºé—´é•¿åº¦
                map.put(num - left, curLen);
                map.put(num + right, curLen);
            }
        }
        return ans;
    }
}
```

**ç»§ç»­åˆ†æï¼š**

åœ¨ä»£ç ä¸­çš„leftå’Œrightèƒ½å¤Ÿåˆ†åˆ«ä»£è¡¨num-1çš„å·¦è¿ç»­åŒºé—´çš„é•¿åº¦å’Œnum+1çš„å³è¿ç»­åŒºé—´é•¿åº¦ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆmapä¸­çš„valueèƒ½å¤Ÿæ—¶è€Œè¡¨ç¤ºå·¦åŒºé—´çš„é•¿åº¦ï¼Œæ—¶è€Œè¡¨ç¤ºå³åŒºé—´çš„é•¿åº¦å‘¢ï¼Ÿ

å…³é”®åœ¨äºåˆ¤æ–­æ¡ä»¶ä¸Šï¼š`if (!map.containsKey(num))`ï¼Œè¿™è¡Œä»£ç è¡¨ç¤ºnumä¹‹å‰å¹¶æœªå‡ºç°è¿‡ã€‚é‚£ä¹ˆå¯¹äºkey=num-1æ¥è¯´ï¼Œå®ƒçš„valueè¡¨ç¤ºçš„åŒºé—´å°±åªèƒ½æ˜¯[num-value,num-1]ï¼Œnum-1åªèƒ½æ˜¯è¯¥åŒºé—´çš„å·¦è¾¹ç•Œå€¼ï¼Œè€Œå…¶å®ƒå¯èƒ½çš„è¿ç»­åŒºé—´éƒ½ä¼šåŒ…å«numï¼Œä¸ç¬¦åˆä¸Šè¿°æ¡ä»¶ï¼›åŒç†ï¼Œå¯¹äºkey=num+1æ¥è¯´ï¼Œå®ƒçš„valueè¡¨ç¤ºçš„åŒºé—´å°±åªèƒ½æ˜¯[num+1,num+value]ï¼Œnum+1åªèƒ½æ˜¯è¯¥åŒºé—´çš„å³è¾¹ç•Œå€¼ã€‚

å½“numå·²ç»å‡ºç°äº†ï¼Œè¿™ä¸¤ä¸ªåŒºé—´å°±å¯ä»¥è¢«è”é€šè¡¨ç¤ºä¸º[num-value1,num+value2]ï¼Œå½“å‰è¿ç»­åŒºé—´çš„å·¦å³è¾¹ç•Œä¼šå‘ç”Ÿå˜åŒ–ï¼Œå˜ä¸ºnum-value1å’Œnum+value2ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ›´æ–°è¿™ä¸¤ä¸ªè¾¹ç•Œç‚¹å¯¹åº”çš„åŒºé—´é•¿åº¦ã€‚

æ‰€ä»¥è¯´è¿™ç§æ–¹æ³•æ˜¯å¾ˆå·§å¦™çš„ï¼ä¹Ÿéå¸¸å€¼å¾—æˆ‘ä»¬å­¦ä¹ ã€‚

æœ¬æ–¹æ³•å€Ÿé‰´äº[ã€åŠ¨æ€è§„åˆ’ã€‘Python é¢˜è§£](https://leetcode-cn.com/problems/longest-consecutive-sequence/solution/dong-tai-gui-hua-python-ti-jie-by-jalan/)åŠå…¶è¯„è®ºåŒºã€‚

### è§£é¢˜æ€è·¯4ï¼šå¹¶æŸ¥é›†

å¹¶æŸ¥é›†çš„æ€è·¯å®é™…ä¸Šä¸æ€è·¯2æœ‰ç‚¹åƒï¼Œä¹Ÿæ˜¯æ¥è®°å½•å³è¾¹ç•Œçš„ï¼Œæ‰€æœ‰åœ¨ä¸€ä¸ªè¿ç»­åŒºé—´å†…çš„å…ƒç´ éƒ½ä¼šåœ¨ä¸€ä¸ªè¿é€šåˆ†é‡ä¸­ï¼Œä¸”è¿™äº›å…ƒç´ çš„æ ¹ç»“ç‚¹éƒ½ä¸ºæœ€è¿œçš„å³è¾¹ç•Œå…ƒç´ ã€‚
å…·ä½“æ€è·¯æ˜¯ï¼š
1. éå†æ‰€æœ‰å…ƒç´ numï¼Œå¦‚æœnum+1å­˜åœ¨ï¼Œå°†numåŠ å…¥åˆ°num+1æ‰€åœ¨çš„è¿é€šåˆ†é‡ä¸­ï¼›
2. é‡æ–°éå†ä¸€éæ‰€æœ‰å…ƒç´ numï¼Œé€šè¿‡findå‡½æ•°æ‰¾åˆ°numæ‰€åœ¨åˆ†é‡çš„æ ¹ç»“ç‚¹ï¼Œä¹Ÿå°±æ˜¯æœ€è¿œå³è¾¹ç•Œï¼Œä»è€Œæ±‚å¾—è¿ç»­åŒºé—´çš„é•¿åº¦ã€‚

### ä»£ç 4

```java
class UnionFind {
    // è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
    private Map<Integer, Integer> parent;

    public UnionFind(int[] nums) {
        parent = new HashMap<>();
        // åˆå§‹åŒ–çˆ¶èŠ‚ç‚¹ä¸ºè‡ªèº«
        for (int num : nums) {
            parent.put(num, num);
        }
    }

    // å¯»æ‰¾xçš„çˆ¶èŠ‚ç‚¹ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯xçš„æœ€è¿œè¿ç»­å³è¾¹ç•Œï¼Œè¿™ç‚¹ç±»ä¼¼äºæ–¹æ³•2
    public Integer find(int x) {
        // numsä¸åŒ…å«x
        if (!parent.containsKey(x)) {
            return null;
        }
        // éå†æ‰¾åˆ°xçš„çˆ¶èŠ‚ç‚¹
        while (x != parent.get(x)) {
            // è¿›è¡Œè·¯å¾„å‹ç¼©ï¼Œä¸å†™ä¸‹é¢è¿™è¡Œä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯æ—¶é—´ä¼šæ…¢äº›
            parent.put(x, parent.get(parent.get(x)));
            x = parent.get(x);
        }
        return x;
    }

    // åˆå¹¶ä¸¤ä¸ªè¿é€šåˆ†é‡ï¼Œåœ¨æœ¬é¢˜ä¸­åªç”¨æ¥å°†numå¹¶å…¥åˆ°num+1çš„è¿ç»­åŒºé—´ä¸­
    public void union(int x, int y) {
        int rootX = find(x);
        int rootY = find(y);
        if (rootX == rootY) {
            return;
        }
        parent.put(rootX, rootY);
    }
}

class Solution {
    public int longestConsecutive(int[] nums) {
        UnionFind uf = new UnionFind(nums);
        int ans = 0;
        
        for (int num : nums) {
            // å½“num+1å­˜åœ¨ï¼Œå°†numåˆå¹¶åˆ°num+1æ‰€åœ¨é›†åˆä¸­
            if (uf.find(num + 1) != null) {
                uf.union(num, num + 1);
            }
        }

        for (int num : nums) {
            // æ‰¾åˆ°numçš„æœ€è¿œè¿ç»­å³è¾¹ç•Œ
            int right = uf.find(num);
            ans = Math.max(ans, right - num + 1);
        }
        return ans;
    }
}
```

æœ€åå†é™„ä¸Šä¸€ç‰ˆå¹¶æŸ¥é›†çš„ä»£ç ï¼Œæ€è·¯ä¸ä¸Šé¢ç›¸åŒï¼Œä½†æ˜¯åŠ å…¥äº†ä¸€ä¸ªcountå“ˆå¸Œè¡¨ï¼Œç”¨äºè®°å½•æ¯ä¸ªè¿é€šåˆ†é‡çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œè¿™æ ·å¯åœ¨ä¸»å‡½æ•°ä¸€æ¬¡éå†ä¾¿å¯å¾—åˆ°ç­”æ¡ˆã€‚

### ä»£ç 5
```java
class UnionFind {
    // è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
    private Map<Integer, Integer> parent;
    // è®°å½•èŠ‚ç‚¹æ‰€åœ¨è¿é€šåˆ†é‡çš„èŠ‚ç‚¹ä¸ªæ•°
    private Map<Integer, Integer> count;

    public UnionFind(int[] nums) {
        parent = new HashMap<>();
        count = new HashMap<>();
        // åˆå§‹åŒ–çˆ¶èŠ‚ç‚¹ä¸ºè‡ªèº«
        for (int num : nums) {
            parent.put(num, num);
            count.put(num, 1);
        }
    }

    // å¯»æ‰¾xçš„çˆ¶èŠ‚ç‚¹ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯xçš„æœ€è¿œè¿ç»­å³è¾¹ç•Œ
    public Integer find(int x) {
        if (!parent.containsKey(x)) {
            return null;
        }
        // éå†æ‰¾åˆ°xçš„çˆ¶èŠ‚ç‚¹
        while (x != parent.get(x)) {
            // è¿›è¡Œè·¯å¾„å‹ç¼©
            parent.put(x, parent.get(parent.get(x)));
            x = parent.get(x);
        }
        return x;
    }

    // åˆå¹¶ä¸¤ä¸ªè¿é€šåˆ†é‡ï¼Œç”¨æ¥å°†numå¹¶å…¥åˆ°num+1çš„è¿ç»­åŒºé—´ä¸­
    // è¿”å›å€¼ä¸ºxæ‰€åœ¨è¿é€šåˆ†é‡çš„èŠ‚ç‚¹ä¸ªæ•°
    public int union(int x, int y) {
        int rootX = find(x);
        int rootY = find(y);
        if (rootX == rootY) {
            return count.get(rootX);
        }
        parent.put(rootX, rootY);
        // æ›´æ–°è¯¥æ ¹ç»“ç‚¹è¿é€šåˆ†é‡çš„èŠ‚ç‚¹ä¸ªæ•°
        count.put(rootY, count.get(rootX) + count.get(rootY));
        return count.get(rootY);
    }
}
class Solution {
    public int longestConsecutive(int[] nums) {
        // å»é™¤numsä¸ºç©ºçš„ç‰¹ä¾‹
        if (nums == null || nums.length == 0) {
            return 0;
        }
        UnionFind uf = new UnionFind(nums);
        int ans = 1;
        // ä¸€æ¬¡éå†å³å¯
        for (int num : nums) {
            if (uf.find(num + 1) != null) {
                // unionä¼šè¿”å›numæ‰€åœ¨è¿é€šåˆ†é‡çš„èŠ‚ç‚¹ä¸ªæ•°
                ans = Math.max(ans, uf.union(num, num + 1));
            }
        }
        
        return ans;
    }
}
```


è¿™å°±æ˜¯æˆ‘æ‰€æ•´ç†åˆ°çš„å››ç§è§£æ³•ï¼Œä¸ªäººæ¨èå¤§å®¶å¯ä»¥éƒ½äº†è§£ä¸€ä¸‹è¿™å››ç§è§£æ³•ï¼Œæ‹“å±•è‡ªå·±è§£é¢˜çš„æ€ç»´å¹¿åº¦ã€‚

å¦‚æœ¬æ–‡æœ‰é”™è¯¯ä¹‹å¤„æˆ–è€…æ‚¨æœ‰ä¸ç†è§£çš„åœ°æ–¹ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºï¼Œæˆ‘ä¼šåŠæ—¶å›å¤ï¼åŒæ—¶å¦‚æœæœ¬æ–‡å¯¹æ‚¨æœ‰å¸®åŠ©çš„è¯ï¼Œè¯·å¸®å¿™ç‚¹ä¸ªèµï¼Œéå¸¸æ„Ÿè°¢ğŸ™ï¼